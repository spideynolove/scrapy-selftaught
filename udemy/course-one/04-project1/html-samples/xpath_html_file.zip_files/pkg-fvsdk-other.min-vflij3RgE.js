var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&__createBinding(t,e,n);return __setModuleDefault(t,e),t};define("metaserver/static/js/file_transfers/async/browse_entry_point_onboarding_modal_async",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncShowBrowseEntryPointOnboardingModal=void 0;t.asyncShowBrowseEntryPointOnboardingModal=t=>{new Promise((t,n)=>{e(["metaserver/static/js/file_transfers/containers/browse_entry_point_onboarding_modal"],t,n)}).then(__importStar).then(({showBrowseEntryPointOnboardingModal:e})=>e(t))}})),define("metaserver/static/js/modules/clean/react/file_viewer/open_button/utils",["require","exports","tslib","react","dig-components/icons/src","dig-components/icons","metaserver/static/js/cloud_docs/open_with_utils","metaserver/static/js/file_store/utils","metaserver/static/js/modules/clean/open_with","metaserver/static/js/modules/clean/react/extensions/connect_flow","metaserver/static/js/modules/clean/react/extensions/utils","metaserver/static/js/modules/clean/react/file_viewer/constants","metaserver/static/js/modules/clean/react/file_viewer/open_button/types","metaserver/static/js/modules/clean/react/file_viewer/open_button/open_with_helpers","metaserver/static/js/modules/clean/react/file_viewer/unity/unity_utils","metaserver/static/js/modules/core/i18n","metaserver/static/js/flows/conversions/actions/unzip","metaserver/static/js/modules/core/browser_detection","metaserver/static/js/modules/clean/downloads","metaserver/static/js/modules/core/uri"],(function(e,t,n,s,i,o,a,r,l,c,u,d,p,m,_,f,h,g,v,E){"use strict";function S(e,t,n,s){let i;if(s.provider===a.OpenWithCloudDocProvider.GoogleDSS)i={type:p.OpenButtonAction.OPEN_WITH_CLOUD_DOC,userAction:d.UserAction.OpenWithCloudDocEditor};else{if(s.provider!==a.OpenWithCloudDocProvider.OfficeOnline)return null;i={type:p.OpenButtonAction.OPEN_WITH,userAction:d.UserAction.OpenInOfficeOnline}}return Object.assign({handler:()=>s.handler(e,t,n),spriteName:s.spriteName||null,iconUrl:s.iconUrl,text:s.text},i)}function y(e){const{file:t,user:n,isOpenWithDisabled:s}=e,i=[],o={gdd:!e.isCloudEditorDisabled,wopi:O({file:t,isOpenWithDisabled:s,user:n})},r=e.actionSource,l=a.getOpenWithCloudEditorInfo(t,n,o,r);for(const e of l){const s=S(t,n,r,e);s&&i.push(s)}return i}function A(e){const t=E.URI.parse(e.href);t.updateQuery({dl:"1"}),v.get({url:t.toString()})}function O({file:e,isOpenWithDisabled:t,user:n}){return!t&&m.OpenWithHelpers.canOpenWith(e,n)}function I(e,t){const n=(e?e.open_application_name:void 0)||f.intl.formatMessage({id:"Uyxn/h",defaultMessage:"Desktop"});return t?n:f.intl.formatMessage({id:"KtD8FA",defaultMessage:"Open in {app_name}"},{app_name:n})}function x(e){const t=(null!==e?e.file_browser_display_name:void 0)||f.intl.formatMessage({id:"Bbnzjx",defaultMessage:"File Browser"});return f.intl.formatMessage({id:"suwlZc",defaultMessage:"Show in {file_browser}"},{file_browser:t})}function b({file:e,isFolder:t,user:n}){return()=>{_.UnityHelpers.openFile(e.ns_id,e.ns_path,n.id,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowCoachmark=t.download=t.getOpenOptionsSharedFile=t.convertOpenWithCloudEditorInfo=t.getOpenOptions=void 0,s=n.__importDefault(s),l=n.__importDefault(l),v=n.__importStar(v),t.getOpenOptions=function(e){const{file:t}=e,l=n.__rest(e,["file"]);return r.isBrowseFile(t)?(function({file:e,isUnityDisabled:t,isOpenWithDisabled:n,isCloudEditorDisabled:r,unityInfo:l,extraOptions:m,user:v,sharingServiceInfo:E,refreshSharingServiceInfo:y,showOpenWithShare:T,onPresentInZoom:M,isCloudBasedDoc:w,actionSource:C,landingPagesEnabled:N,isInActionBar:P,previewActionHandler:j,openDesktopActionHandler:F,openInNewTabActionHandler:D,goToFolderActionHandler:U,isCurrentFolderEligibleForAutomation:L,isSubfolderEligibleForAutomation:B,hideZipAction:k,replayActionHandler:R}){const W=[];!k&&h.UnzipAction.selector([e])&&W.push({handler:()=>{h.UnzipAction.convert([e],v,{isCurrentFolderEligibleForAutomation:L,isSubfolderEligibleForAutomation:B,source:"browse"})},spriteName:null,iconElement:s.default.createElement(o.UIIcon,{src:i.ZipPictogram}),text:h.UnzipAction.actionText,type:p.OpenButtonAction.DECOMPRESS_FILE,userAction:d.UserAction.DecompressFile});R&&W.push({handler:R,spriteName:null,text:f.intl.formatMessage({id:"9saYUt",defaultMessage:"Replay"}),type:p.OpenButtonAction.OPEN_IN_REPLAY,userAction:d.UserAction.OpenInReplay});j&&W.push({handler:j,spriteName:null,text:f.intl.formatMessage({id:"wHolW4",defaultMessage:"Preview (Dropbox)"}),type:p.OpenButtonAction.PREVIEW_FILE,userAction:d.UserAction.PreviewFile});if(F){const e=g.mac?f.intl.formatMessage({id:"3KanyU",defaultMessage:"Finder"}):f.intl.formatMessage({id:"kJ3mnY",defaultMessage:"File Explorer"});W.push({handler:F,spriteName:null,text:e,type:p.OpenButtonAction.OPEN_IN_DESKTOP,userAction:d.UserAction.OpenInDesktop})}D&&W.push({handler:D,spriteName:null,text:f.intl.formatMessage({id:"HE6Ges",defaultMessage:"Open in new tab"}),type:p.OpenButtonAction.OPEN_IN_NEW_TAB,userAction:d.UserAction.OpenInNewTab});U&&W.push({handler:U,spriteName:null,text:f.intl.formatMessage({id:"mppZEu",defaultMessage:"Go to folder"}),type:p.OpenButtonAction.GO_TO_FOLDER,userAction:d.UserAction.GoToFolder});if(!l)return W;!w&&(function({isUnityDisabled:e,unityInfo:t}){return null!=t&&!e&&_.UnityHelpers.isUnityFileSupported(t)})({isUnityDisabled:t,unityInfo:l})&&W.push({handler:b({file:e,user:v,isFolder:!1}),spriteName:"ow_desktop",text:I(l,P),type:p.OpenButtonAction.UNITY_FILE,userAction:d.UserAction.OpenInUnity});const V=O({file:e,isOpenWithDisabled:n,user:v}),H={gdd:!r,wopi:V},q=a.getOpenWithCloudEditorInfo(e,v,H,C);for(const t of q){const n=S(e,v,C,t);n&&W.push(n)}!P&&(function({isUnityDisabled:e,unityInfo:t}){return null!=t&&!e&&_.UnityHelpers.isUnityFolderSupported(t)})({isUnityDisabled:t,unityInfo:l})&&W.push({handler:b({file:e,user:v,isFolder:!0}),spriteName:"ow_folder",text:x(l),type:p.OpenButtonAction.UNITY_FOLDER,userAction:d.UserAction.OpenInUnityFolder});m&&m.forEach(e=>{e&&W.push(e)});P||W.length||w||W.push({handler:()=>A(e),spriteName:null,text:f.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),type:p.OpenButtonAction.DOWNLOAD,userAction:d.UserAction.Download});let G=!1,z=!1;T&&E&&(G=u.isSlackAvailable(E),z=u.isZoomAvailable(E));G&&E&&y&&W.push({handler:()=>c.shareInSlackFlow(v,E,y,e,"open_with_button",void 0!==N?N:null),spriteName:null,text:f.intl.formatMessage({id:"Qws4v2",defaultMessage:"Slack"}),type:p.OpenButtonAction.SHARE_TO_SLACK,userAction:d.UserAction.ShareToSlack});z&&E&&M&&y&&W.push({handler:()=>c.presentInZoomFlow(v,E,y,M,"open_with_button",void 0!==N?N:null),spriteName:null,text:f.intl.formatMessage({id:"mzy+1c",defaultMessage:"Zoom"}),type:p.OpenButtonAction.PRESENT_IN_ZOOM,userAction:d.UserAction.PresentInZoom});return W})(Object.assign({file:t},l)):r.isSharedFile(t)?y(Object.assign({file:t},l)):[]},t.convertOpenWithCloudEditorInfo=S,t.getOpenOptionsSharedFile=y,t.download=A,t.shouldShowCoachmark=function(e,t){const n=e.map(e=>e.type).includes(p.OpenButtonAction.UNITY_FILE),s=t&&l.default.is_adobe_app(t.open_application_identifier),i=e.map(e=>e.type).includes(p.OpenButtonAction.OPEN_WITH);return n&&s||i}})),define("metaserver/static/js/app_actions/developers_site/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeveloperState=void 0,(function(e){e[e.UNVERIFIED=0]="UNVERIFIED",e[e.IN_DEVELOPMENT=1]="IN_DEVELOPMENT",e[e.ENABLED=2]="ENABLED",e[e.DISABLED=3]="DISABLED"})(t.DeveloperState||(t.DeveloperState={}))})),define("metaserver/static/js/app_actions/redirect",["require","exports","tslib","metaserver/static/js/deprecated_ajax/ajax_jquery","lodash","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/core/cookies","metaserver/static/js/modules/core/notify","metaserver/static/js/modules/core/uri","metaserver/static/js/api_v2/transport/fetch","metaserver/static/js/components/ui/modal","metaserver/static/js/modules/clean/react/extensions/auth_modal","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/modules/clean/react/extensions/cloud_docs_compat","metaserver/static/js/cloud_docs/event_logging","metaserver/static/js/cloud_docs/open_with_utils"],(function(e,t,n,s,i,o,a,r,l,c,u,d,p,m,_,f){"use strict";function h(e,t,s){return n.__awaiter(this,void 0,void 0,(function*(){const n=new c.FetchAsyncTransport,i=new l.URI({scheme:"https",authority:"www.dropbox.com",path:"/2/app_actions/"+t}),o={};o["X-Dropbox-Path-Root"]=e.root_ns_id.toString(),o["X-Dropbox-Uid"]=e.id.toString();const r=a.Cookies.read("__Host-js_csrf");if(!r)throw new Error("No CSRF cookie");return o["X-CSRF-Token"]=r,n.executeRpc(i,o,JSON.stringify(s),"application/json")}))}function g(e,t,s){return n.__awaiter(this,void 0,void 0,(function*(){const n=yield h(e,t,s),i={request_id:n.headers["x-dropbox-request-id"],redirect_url:n.result.redirect_url};return"link_state"in n.result&&(i.link_state=n.result.link_state),i}))}function v(e,t,s,i,o){return n.__awaiter(this,void 0,void 0,(function*(){yield y(e,t,s,i[0],()=>g(e,"redirect",{action_id:t,file_ids:i}),o)}))}function E(e,t){if(1!==e.length)throw new Error(`Expected single file: ${t}`);return e[0]}function S(e,t,s,i,o){return n.__awaiter(this,void 0,void 0,(function*(){return yield y(e,t,s,i,()=>g(e,"authorize",{action_id:t,file_id:i}),o)}))}function y(e,t,a,l,c,u){return n.__awaiter(this,void 0,void 0,(function*(){const d=`action_redirect_${Math.random().toString(16).substring(2)}`,p=window.open("",d,u);p&&(p.document.open("text/html","replace"),p.document.write(`<html><head><title>${i.escape(a)}</title></head></html>`),p.document.close());let m=!1;const _=new Promise(n=>{s.SilentBackgroundRequest({url:"/aa/loading",subject_user:e.id,data:{file_id:l,action_id:t},success:e=>{!m&&p?(p.document.open("text/html","replace"),p.document.write(e),p.document.close(),p.document.title=a,n()):n()},error:()=>{n()}})});const[,f]=yield Promise.all([_,(function(){return n.__awaiter(this,void 0,void 0,(function*(){try{return yield c()}catch(e){return void(m=!0)}}))})()]),h=f&&f.redirect_url||"/aa/error";if(p)p.location.replace(h);else{if(!window.open(h,"_blank",u)){const e=a;r.Notify.error(o.intl.formatMessage({id:"TFhSer",defaultMessage:"Failed to open {app_name}"},{app_name:e}))}}return f}))}Object.defineProperty(t,"__esModule",{value:!0}),t.showLoadingPageAndDoRedirect=t.authAction=t.redirectToActionOrShowAuth=t.redirectToAction=t.authorizeNoRedirect=t.fetchUrl=t.fetch=void 0,s=n.__importStar(s),i=n.__importStar(i),p=n.__importStar(p),t.fetch=h,t.fetchUrl=g,t.authorizeNoRedirect=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){try{const n=yield h(e,"authorize_no_redirect",{action_id:t});return n&&n.result&&n.result.link_state}catch(e){return null}}))},t.redirectToAction=v,t.redirectToActionOrShowAuth=function(e,t,s,i,o,a,r){return n.__awaiter(this,void 0,void 0,(function*(){if("redirect"===s.handler[".tag"]){const i=s.handler.window_params;let o=void 0;if("popup"===i[".tag"]){const{width:e,height:t}=i;o=`width=${e},height=${t}`}if("sfa_unlinked"===s.link_state[".tag"]&&!s.id.startsWith("fp_action_id:")){const i=E(t,"first party actions do not support multiple files yet."),r=p.filename(i.ns_path);d.showAuthModal(s.id,s.description,s.icon.url,i.file_id,r,()=>{u.Modal.close(),(function(e,t,s,i,o,a){n.__awaiter(this,void 0,void 0,(function*(){const n=yield S(e,t,s,i,o);a&&n&&n.link_state&&a(t,n.link_state)}))})(e,s.id,s.description,i.file_id,o,a)})}else{const n=t.map(e=>e.file_id);v(e,s.id,s.description,n,o)}}else if("cloud_editor"===s.handler[".tag"]){const n=E(t,"cloud docs actions do not support multiple files yet."),i=o?_.getActionSourceFromSurface(o.surface):void 0,a=m.cloudEditorNameToParams(s.handler.editor_name);f.openWithCloudEditor(f.fileToOpenWithParams(n),e.id,a,!1,i)}else{if("profile_service"!==s.handler[".tag"])throw new Error(`Unexpected handler "${s.handler[".tag"]}"`);if(r){const n=E(t,"profile service actions do not support multiple files yet.");r(e,n,s)}}}))},t.authAction=S,t.showLoadingPageAndDoRedirect=y})),define("metaserver/static/js/app_directory/client",["require","exports","tslib","metaserver/static/js/api_v2/user_client"],(function(e,t,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPageInfos=void 0,t.getPageInfos=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const n=(new s.UserApiV2Client).ns("app_directory").rpc("list_page_info",{app_identifiers:e},{subjectUserId:t});return(yield n).page_infos}))}})),define("metaserver/static/js/comments2/client_builder",["require","exports","tslib","metaserver/static/js/comments2/comments_bolt","metaserver/static/js/comments2/data/mentions_api","metaserver/static/js/flows/approval/approval_io_client"],(function(e,t,n,s,i,o){"use strict";function a(e){var t;return{channelId:{appId:e.app_id,uniqueId:e.unique_id},revisionInfo:{revision:parseInt(null!==(t=e.revision)&&void 0!==t?t:"",10),token:e.token}}}function r({channelId:e,revisionInfo:t}){return{app_id:e.appId,unique_id:e.uniqueId,revision:t.revision.toString(),token:t.token}}Object.defineProperty(t,"__esModule",{value:!0}),t.makeComments2Client=t.boltChannelClientToServer=t.boltChannelServerToClient=void 0,t.boltChannelServerToClient=a,t.boltChannelClientToServer=r,t.makeComments2Client=function(e){let t=void 0;if(e){let s=null;const o=()=>{const t=i.mentionsApi(e);return{search(e){return n.__awaiter(this,void 0,void 0,(function*(){if(0===e.length)return t.getMatchesWithStarterSuggestions();return(e=>new Promise(n=>{t.query(e,e=>{n(e)})}))(e)}))}}};t=()=>(s||(s=o()),s)}return{boltIOClient:(e=>{let t=e=>{};return{subscribe:n=>(n.forEach(n=>{e.subscribe(r(n),t,t)}),Promise.resolve()),unsubscribe:()=>Promise.resolve(e.unsubscribe()),onSignal:e=>{t=t=>{const n=t.map(e=>a(e));e({updatedChannels:n})}}}})(s.bolt),mentionsIOClient:t,approvalIOClient:e?o.approvalIOClient(e.id):void 0}}})),define("metaserver/static/js/comments2/comments_bolt",["require","exports","metaserver/static/js/bolt/bolt_nodeps"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bolt=void 0,t.bolt={client:null,subscribe({app_id:e,revision:s,token:i,unique_id:o},a,r){const l=new n.SignedChannelState(e,o,s,i);t.bolt.client?t.bolt.client.update_states([l]):(t.bolt.client=new n.BoltClient([l],a,r),t.bolt.client.start())},unsubscribe(){t.bolt.client&&(t.bolt.client.unsubscribe(),t.bolt.client=null)}}})),define("metaserver/static/js/modules/clean/react/extensions/auth_body_v2",["require","exports","tslib","react","react-intl","metaserver/static/js/components/ui/css","spectrum/button/index","metaserver/static/js/modules/core/i18n","metaserver/static/js/app_actions/telemetry_client","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/modules/clean/react/extensions/status_page"],(function(e,t,n,s,i,o,a,r,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsAuthBodyV2=void 0,s=n.__importDefault(s);class d extends s.default.Component{constructor(e){super(e),this.clickAuthorize=()=>{this.currentSession.event("auth_accept",{action_id:this.props.actionId}),this.props.doAuth()},this.learnMoreOnClick=()=>{this.currentSession.event("learn_more",{action_id:this.props.actionId}),this.props.onLearnMore&&this.props.onLearnMore()},this.telemetryClient=l.createTelemetryClient({component:"auth_v2"})}componentDidMount(){this.currentSession.event("auth_start",{action_id:this.props.actionId})}renderText(){const e=0!==this.props.fileId.length?i.defineMessage({id:"VDSuu6",defaultMessage:"<b>{app_name}</b> needs access to this file"}):i.defineMessage({id:"mZo8K4",defaultMessage:"<b>{app_name}</b> needs access to files you select"}),t=0!==this.props.fileId.length?i.defineMessage({id:"hE6l1Q",defaultMessage:"Changes to this file using {app_name} will save back to Dropbox. This app will have access to the username, email address, and country for your account."}):i.defineMessage({id:"HsAedA",defaultMessage:"Changes to selected files using {app_name} will save back to Dropbox. This app will have access to the username, email address, and country for your account."});return s.default.createElement("div",null,s.default.createElement("div",{className:"auth-text-header-v2"},r.intl.formatMessage(e,{app_name:this.props.appName,b:e=>s.default.createElement("b",null,e)})),s.default.createElement("div",{className:"auth-text-v2"},r.intl.formatMessage(t,{app_name:this.props.appName}),s.default.createElement("a",{className:"learn-more-link",href:"/help/security/third-party-apps",target:"_blank",rel:"noopener noreferrer",onClick:this.learnMoreOnClick},r.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}))))}renderButtons(){return s.default.createElement("div",null,s.default.createElement(a.Button,{variant:"primary",className:"auth-button-v2",onClick:this.clickAuthorize},r.intl.formatMessage({id:"LGeX5c",defaultMessage:"Allow"})))}renderAuthorization(){const{appName:e,iconUrl:t}=this.props;return s.default.createElement("div",{id:"auth",className:"auth-connect-frame-v2"},s.default.createElement("div",null,s.default.createElement("img",{className:"app-icon-v2",src:t,alt:e})),s.default.createElement("div",null,this.renderText()),s.default.createElement("div",{id:"buttons"},this.renderButtons()))}render(){const{fileName:e}=this.props;return this.currentSession=this.telemetryClient.session({ext:l.getPiiSafeExtension("."+c.file_extension(e))}),this.props.showLoadingUI?s.default.createElement(u.AppActionsLoadingPage,{fileName:e}):this.renderAuthorization()}}d.displayName="AuthBodyV2Component",t.ExtensionsAuthBodyV2=o.requireCssWithComponent(d,["/static/css/spectrum/index.web-vfliw9181.css","/static/css/foundation-vfljLCXoa.css","/static/css/app_actions/index-vflnjwhRA.css"])})),define("metaserver/static/js/modules/clean/react/extensions/auth_modal",["require","exports","tslib","react","metaserver/static/js/components/ui/modal","metaserver/static/js/modules/clean/react/extensions/auth_body_v2","metaserver/static/js/modules/clean/ux_analytics_modal_tracking"],(function(e,t,n,s,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showAuthModal=t.AuthModal=void 0,s=n.__importDefault(s);t.AuthModal=e=>s.default.createElement(i.Modal,{className:"extensions-auth-modal-v2",ariaLabel:"Access Modal",displayCloseButton:!0,clickOutToClose:!1,style:"clean",onDismiss:e.doCancel},s.default.createElement(a.UXAnalyticsModalTracking,{id:"EXTENSIONS_AUTH_MODAL_V2"}),s.default.createElement(o.ExtensionsAuthBodyV2,Object.assign({},e))),t.showAuthModal=function(e,n,o,a,r,l){i.Modal.showInstance(s.default.createElement(t.AuthModal,{actionId:e,appName:n,iconUrl:o,fileId:a,fileName:r,doAuth:l,doCancel:i.Modal.close}))}})),define("metaserver/static/js/modules/clean/react/extensions/cloud_docs_compat",["require","exports","metaserver/static/js/cloud_docs/constants"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWopiAction=t.cloudEditorNameToParams=void 0,t.cloudEditorNameToParams=function(e){return"gdoc"===e?n.GoogleFileTypes.GOOGLE_DSS_DOC:"gsheet"===e?n.GoogleFileTypes.GOOGLE_DSS_SHEET:"gslides"===e?n.GoogleFileTypes.GOOGLE_DSS_SLIDES:"word"===e?n.MicrosoftEditors.WORD:"excel"===e?n.MicrosoftEditors.EXCEL:"powerpoint"===e?n.MicrosoftEditors.POWERPOINT:"preview"},t.isWopiAction=function(e){return["fp_action_id:word_online","fp_action_id:excel_online","fp_action_id:powerpoint_online"].indexOf(e.id)>=0}})),define("metaserver/static/js/modules/clean/react/extensions/common",["require","exports"],(function(e,t){"use strict";function n(e,t,n){e&&e.event(t,n)}function s(e){return e.link_state[".tag"].indexOf("_linked")>=0}Object.defineProperty(t,"__esModule",{value:!0}),t.partitionActionsByLinkStatus=t.isPrelinked=t.isLinked=t.getAppActionExtras=t.getOpenOptionsWithLogging=t.handleShowByline=t.logEvent=void 0,t.logEvent=n,t.handleShowByline=function(e,t){return()=>{n(t,"show_byline",{extension_id:e})}},t.getOpenOptionsWithLogging=function(e,t){return e.map(e=>Object.assign(Object.assign({},e),{handler:()=>{e.handler(),n(t,"select_legacy_action",{type:e.type})}}))},t.getAppActionExtras=function(e){return{action_id:e.id,encoded_app_id:e.app_id,action_type:s(e)?"select_action":"select_connect"}},t.isLinked=s,t.isPrelinked=function(e){return"oauth_prelinked"===e.link_state[".tag"]},t.partitionActionsByLinkStatus=function(e){const t=[],n=[];return e.map(e=>{e.app_id&&(s(e)?t.push(e.app_id):n.push(e.app_id))}),{connected_apps:t,unconnected_apps:n}}})),define("metaserver/static/js/modules/clean/react/extensions/data/helpers",["require","exports","metaserver/static/js/app_actions/category","metaserver/static/js/modules/clean/react/file_viewer/open_button/types","metaserver/static/js/modules/clean/react/extensions/common"],(function(e,t,n,s,i){"use strict";function o(e,t){if(e.priority&&t.priority){const n=t.priority-e.priority;return 0!==n?n:e.description<t.description?-1:e.description>t.description?1:0}return e.priority?-1:t.priority?1:e.description<t.description?-1:e.description>t.description?1:0}Object.defineProperty(t,"__esModule",{value:!0}),t.constructAlphabetizeActions=t.partitionOptions=t.partitionActions=t.actionCompareFn=void 0,t.actionCompareFn=o,t.partitionActions=function(e,t=0){const s=[],a=[],r=[],l=[];return e.sort(o).forEach(e=>{e.category===n.Category.CLOUD_EDITORS?s.push(e):i.isLinked(e)||i.isPrelinked(e)?a.push(e):void 0!==e.priority&&e.priority>0&&r.length<t?r.push(e):l.push(e)}),{cloudEditors:s,installedActions:a,promotedActions:r,unpromotedActions:l}},t.partitionOptions=function(e){const t=[],n=[];let i,o,a,r,l,c;return e.forEach(e=>{const{type:u}=e;u===s.OpenButtonAction.UNITY_FILE||u===s.OpenButtonAction.UNITY_FOLDER?t.push(e):u===s.OpenButtonAction.OPEN_WITH||u===s.OpenButtonAction.OPEN_WITH_CLOUD_DOC?n.push(e):u===s.OpenButtonAction.DOWNLOAD?i=e:u===s.OpenButtonAction.PREVIEW_FILE?o=e:u===s.OpenButtonAction.OPEN_IN_REPLAY?a=e:u===s.OpenButtonAction.OPEN_IN_DESKTOP?r=e:u===s.OpenButtonAction.GO_TO_FOLDER?l=e:u===s.OpenButtonAction.OPEN_IN_NEW_TAB&&(c=e)}),{unityOptions:t,cloudEditorOptions:n,downloadOption:i,previewOption:o,openInReplayOption:a,openInDesktopOption:r,openInNewTabOption:c,goToFolderOption:l}},t.constructAlphabetizeActions=function(e){return(t,n)=>{const s=e[t.category].display_name,i=e[n.category].display_name;return s<i?-1:s>i?1:t.description<n.description?-1:t.description>n.description?1:0}}})),define("metaserver/static/js/modules/clean/react/extensions/education/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TooltipState=void 0,(function(e){e[e.NO_TOOLTIP=0]="NO_TOOLTIP",e[e.BIG_ONBOARDING_TOOLTIP=1]="BIG_ONBOARDING_TOOLTIP",e[e.SMALL_TOOLTIP=2]="SMALL_TOOLTIP"})(t.TooltipState||(t.TooltipState={}))})),define("metaserver/static/js/modules/clean/react/extensions/extensions_mini_directory_modal",["require","exports","tslib","react","metaserver/static/js/modules/core/i18n","spectrum/modal/index","metaserver/static/js/modules/clean/static_urls","dig-components/buttons","metaserver/static/js/modules/clean/ux_analytics_modal_tracking","metaserver/static/js/components/ui/css","metaserver/static/js/components/ui/modal","react-modal","lodash","metaserver/static/js/modules/clean/react/extensions/common","metaserver/static/js/modules/clean/react/extensions/data/helpers","metaserver/static/js/modules/clean/react/extensions/data/selectors","metaserver/static/js/app_actions/redirect","metaserver/static/js/modules/clean/react/file_viewer/open_button/types","metaserver/static/js/modules/clean/react/extensions/cloud_docs_compat","dig-components/typography","dig-components/text_fields","dig-components/icons","dig-components/icons/src","metaserver/static/js/app_directory/client","dig-components/progress_indicators","classnames","lodash","metaserver/static/js/app_actions/developers_site/types"],(function(e,t,n,s,i,o,a,r,l,c,u,d,p,m,_,f,h,g,v,E,S,y,A,O,I,x,b,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showExtensionsMiniDirectoryModal=t.ExtensionsMiniDirectoryModal=t.AppDirectoryEntryPoint=void 0,s=n.__importDefault(s),d=n.__importDefault(d),p=n.__importStar(p),O=n.__importStar(O),x=n.__importDefault(x);const M=e=>"api_app"===e[".tag"]?`${e[".tag"]}/${e.api_app}`:"first_party_app"===e[".tag"]?`${e[".tag"]}/${e.first_party_app}`:`${e[".tag"]}`;function w(){return s.default.createElement("div",{className:"extensions-mini-directory-modal__directory-entry-point"},s.default.createElement(E.Link,{href:"/apps",hasNoUnderline:!0,variant:"monochromatic",className:"extensions-mini-directory-modal__directory-entry-point-text-border"},s.default.createElement(E.Text,{isBold:!0},i.intl.formatMessage({id:"LbLi52",defaultMessage:"View all apps"}))))}t.AppDirectoryEntryPoint=w;class C extends s.default.Component{constructor(e){super(e),this.hasUsedSearchBar=!1,this.onScroll=b.throttle(e=>{e>0&&!this.state.showTopBorder&&this.setState({showTopBorder:!0}),0===e&&this.state.showTopBorder&&this.setState({showTopBorder:!1})},20),this.createClickHandler=e=>()=>{u.Modal.close();const{user:t,file:n,featureFlags:s,currentSession:i,telemetryContext:o,updateLinkState:a,onProfileServiceAuth:r}=this.props;if(h.redirectToActionOrShowAuth(t,[n],e,s,o,a,r),"redirect"===e.handler[".tag"])m.logEvent(i,"select_action",m.getAppActionExtras(e));else if("cloud_editor"===e.handler[".tag"]){const t=v.isWopiAction(e)?g.OpenButtonAction.OPEN_WITH:g.OpenButtonAction.OPEN_WITH_CLOUD_DOC;m.logEvent(this.props.currentSession,"select_legacy_action",{type:t})}},this.handleQueryChange=e=>{const t=e.currentTarget.value;this.setState({searchKey:t}),this.hasUsedSearchBar||(m.logEvent(this.props.currentSession,"start_searching",{}),this.hasUsedSearchBar=!0)},this.filterActions=()=>{const{appActions:e,categoryIdToInfos:t}=this.props,n=this.state.searchKey.trim().toLowerCase(),s=e.map(e=>e.category).map(e=>t[e]).filter(e=>-1!==e.display_name.toLowerCase().indexOf(n)).map(e=>e.id);return e.filter(e=>{const t=this.getAppDirectoryPageInfo(e);return((e,t)=>t||e.app_directory_id&&"first_party_app"===e.app_directory_id[".tag"]||e.developer_state===T.DeveloperState.IN_DEVELOPMENT)(e,t)&&(-1!==e.description.toLowerCase().indexOf(n)||(e=>!(!e||!e.short_description)&&-1!==e.short_description.toLowerCase().indexOf(n))(t)||s.includes(e.category))})},this.clearSearch=()=>{this.setState({searchKey:""})},this.renderExtensionItem=e=>{const t=e.icon,n=t.is_static?a.static_url("/static/images/generic_app_icon-vflIPYT1H.png"):t.url,o=m.isLinked(e),l=o?"primary":"opacity",c=o?f.isShareAction(e)?i.intl.formatMessage({id:"NoV3Co",defaultMessage:"Share"}):i.intl.formatMessage({id:"CNPdm5",defaultMessage:"Open"}):i.intl.formatMessage({id:"vV9l+M",defaultMessage:"Connect"});return s.default.createElement("div",{className:"extension-section",key:e.description},s.default.createElement("img",{src:n,className:"extensions-icon",alt:""}),this.renderActionInfo(e),s.default.createElement("div",{className:"extensions-mini-directory-modal__redirect_button_wrapper"},s.default.createElement(r.Button,{variant:l,onClick:this.createClickHandler(e),className:"extensions-mini-directory-modal__redirect_button"},c)))},this.getAppDirectoryPageInfo=e=>{const t=e.app_directory_id&&M(e.app_directory_id);return t?this.state.appDirectoryPageInfo.get(t):void 0},this.renderActionInfo=e=>{const t=this.getAppDirectoryPageInfo(e),n=t&&t.short_description,i=t&&t.page_url,o=s.default.createElement(s.default.Fragment,null,s.default.createElement(E.Text,{tagName:"div",isBold:!0},e.description),s.default.createElement(E.Text,{color:"faint",className:"extensions-short-description",size:"small"},n));return i?s.default.createElement("div",{className:"extensions-description"},s.default.createElement(E.Link,{href:i,target:"_blank",rel:"noreferrer",variant:"monochromatic",hasNoUnderline:!0,className:"extensions-description__link"},o)):s.default.createElement("div",{className:"extensions-description"},o)},this.renderEmptySearch=()=>{const e=this.state.searchKey,t=e?`/apps/search?query=${e}`:"/apps",n=e?i.intl.formatMessage({id:"4fGTX4",defaultMessage:"Search “{search_key}” in App Center"},{search_key:e}):i.intl.formatMessage({id:"C5jY7c",defaultMessage:"Search in App Center"});return s.default.createElement("div",{className:"extensions-mini-directory-modal__empty-search-app-center"},s.default.createElement(E.Text,null,i.intl.formatMessage({id:"niuDq6",defaultMessage:"Looking for something?"})),s.default.createElement(E.Link,{href:t,variant:"monochromatic"},s.default.createElement(E.Text,null,n)))},this.state={searchKey:"",appDirectoryPageInfo:new Map,loading:!0}}componentDidMount(){const e=this.props.appActions.map(e=>e.app_directory_id).filter(e=>void 0!==e);this.fetchAppDirectoryPageInfoMap(e).then(e=>this.setState({appDirectoryPageInfo:e,loading:!1}))}fetchAppDirectoryPageInfoMap(e){return n.__awaiter(this,void 0,void 0,(function*(){return(yield O.getPageInfos(e,this.props.user.id)).reduce((function(e,t){for(const n of t.app_identifiers)e.set(M(n),t);return e}),new Map)}))}render(){const{onRequestClose:e,modalTitle:t}=this.props,n=this.filterActions().sort(_.actionCompareFn);return s.default.createElement(o.Modal,{ariaLabel:i.intl.formatMessage({id:"wjwJvt",defaultMessage:"App actions"}),className:"extensions-mini-directory-modal",displayCloseButton:!0,open:!0,overlayClassName:"file-viewer-modal-overlay",overlayFixed:!1,onRequestClose:()=>e()},this.state.loading?s.default.createElement("div",{className:"extensions-mini-directory-modal__body-loading"}," ",s.default.createElement(I.Spinner,{"aria-valuetext":"Loading Apps"})," "):s.default.createElement("div",{className:"extensions-mini-directory-modal__body-wrapper"},s.default.createElement("div",{className:x.default({"extensions-mini-directory-modal__header-border":this.state.showTopBorder})},s.default.createElement("div",{className:"extensions-mini-directory-modal__title"},s.default.createElement(E.Title,null,t)),s.default.createElement("div",{className:"extensions-mini-directory-modal__search-bar"},s.default.createElement(S.TextInput,{"aria-label":"Search Apps",withLeftAccessory:s.default.createElement(y.UIIcon,{src:A.SearchLine}),withRightAccessory:this.state.searchKey&&s.default.createElement(r.IconButton,{size:"small",variant:"transparent",onClick:this.clearSearch},s.default.createElement(y.UIIcon,{src:A.FailFill})),placeholder:i.intl.formatMessage({id:"+enW1p",defaultMessage:"Search by action or app name"}),value:this.state.searchKey,onChange:this.handleQueryChange}))),s.default.createElement("div",{className:"extensions-container",onScroll:({currentTarget:{scrollTop:e}})=>this.onScroll(e)},n.length>0?n.map(e=>this.renderExtensionItem(e)):this.renderEmptySearch()),s.default.createElement(w,null)),s.default.createElement(l.UXAnalyticsModalTracking,{id:"extensions-mini-directory-modal"}))}}C.displayName="ExtensionsMiniDirectoryModalComponent",t.ExtensionsMiniDirectoryModal=c.requireCssWithComponent(C,["/static/js/typescript/component_libraries/deep-integrations/src/index.web-vflVod6hW.css","/static/css/app_actions/index-vflnjwhRA.css"]);const N=p.once(()=>{d.default.setAppElement(document.body)});t.showExtensionsMiniDirectoryModal=(e,n,i,o,a,r,l,c,d,p)=>{N(),u.Modal.showInstance(s.default.createElement(t.ExtensionsMiniDirectoryModal,{modalTitle:e,user:n,file:i,onRequestClose:u.Modal.close,appActions:o,categoryIdToInfos:a,featureFlags:r,updateLinkState:l,telemetryContext:c,currentSession:d,onProfileServiceAuth:p}));const{connected_apps:_,unconnected_apps:f}=m.partitionActionsByLinkStatus(o);m.logEvent(d,"view_scaling_modal",{connected_apps:_,unconnected_apps:f})}})),define("metaserver/static/js/modules/clean/react/extensions/extensions_utils",["require","exports","metaserver/static/js/modules/clean/react/file_viewer/open_button/utils","metaserver/static/js/cloud_docs/open_with_utils","metaserver/static/js/cloud_docs/event_logging"],(function(e,t,n,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCategoryIdToInfos=t.getOpenOptionsForFile=void 0;const o=Object.freeze({local_path:null,resolved_local_path:null,is_locally_available:!1,can_open_directly:!1,open_application_identifier:null,open_application_name:null,path_is_dir:!1,is_infinite_placeholder:!1,error_message:null});t.getOpenOptionsForFile=function(e){const t=i.getActionSourceFromSurface(e.surface),a=e.sharingServiceInfo||{};let{isCloudEditorDisabled:r}=e,l=r;return r||(r=!!e.cloudDocsInfo&&!e.cloudDocsInfo.openWithGddSupported,l=!!e.isOpenWithDisabled),n.getOpenOptions({file:e.file,isOpenWithDisabled:!!l,unityInfo:e.unityInfo||o,extraOptions:e.extraOptions,user:e.user,sharingServiceInfo:a,refreshSharingServiceInfo:e.refreshSharingServiceInfo,showOpenWithShare:!1,onPresentInZoom:e.onPresentInZoom,isCloudBasedDoc:s.isCloudBasedDoc(e.file),actionSource:t,isCloudEditorDisabled:r,landingPagesEnabled:e.landingPagesEnabled,isInActionBar:e.isInActionBar,previewActionHandler:e.previewActionHandler,openDesktopActionHandler:e.openDesktopActionHandler,goToFolderActionHandler:e.goToFolderActionHandler,isCurrentFolderEligibleForAutomation:e.isCurrentFolderEligibleForAutomation,isSubfolderEligibleForAutomation:e.isSubfolderEligibleForAutomation,hideZipAction:e.hideZipAction||!1,replayActionHandler:e.replayActionHandler,openInNewTabActionHandler:e.openInNewTabActionHandler})},t.getCategoryIdToInfos=function(e){const t={};return e.forEach(e=>{t[e.id]=e}),t}})),define("metaserver/static/js/modules/clean/react/extensions/split_share_button_component",["require","exports","tslib","classnames","lodash","react","react-redux","dig-components/menu","dig-components/buttons","dig-components/icons/src","dig-components/icons","spectrum/tooltip/index","metaserver/static/js/cloud_docs/constants","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/modules/clean/integrations/data/selectors","metaserver/static/js/modules/clean/react/extensions/apis","metaserver/static/js/modules/clean/react/extensions/education/types","metaserver/static/js/app_actions/redirect","metaserver/static/js/app_actions/telemetry_client","metaserver/static/js/campaigns/campaign_formats/index_new","metaserver/static/js/campaigns/utils","metaserver/static/js/components/ui/css","metaserver/static/js/modules/clean/react/extensions/common","metaserver/static/js/modules/clean/react/extensions/connect_flow","metaserver/static/js/modules/clean/react/extensions/data/action_creators","metaserver/static/js/modules/clean/react/extensions/data/helpers","metaserver/static/js/modules/clean/react/extensions/data/selectors","metaserver/static/js/modules/clean/react/extensions/data/store","metaserver/static/js/modules/clean/react/extensions/data/types","metaserver/static/js/modules/clean/react/extensions/extensions_mini_directory_modal","metaserver/static/js/modules/clean/react/extensions/extensions_utils","metaserver/static/js/modules/clean/react/extensions/file","metaserver/static/js/modules/clean/react/extensions/tooltips","metaserver/static/js/modules/clean/react/extensions/utils","metaserver/static/js/modules/clean/react/file_viewer/constants","metaserver/static/js/modules/clean/react/file_viewer/open_button/types","metaserver/static/js/onboarding/logging/events","metaserver/static/js/modules/clean/static_urls","metaserver/static/js/modules/clean/user_education/react/user_education_effect","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/web_user_action_events","metaserver/static/js/file_transfers/lib/utils","metaserver/static/js/file_transfers/async/browse_entry_point_onboarding_modal_async","metaserver/static/js/modules/core/browser","metaserver/static/js/modules/core/uri","metaserver/static/js/onboarding_checklist/async_share_button_tooltip","metaserver/static/js/flows/conversions/convert_and_share_submenu","metaserver/static/js/modules/clean/analytics","metaserver/static/js/modules/core/browser_detection","metaserver/static/js/docsend_analytics_add_on/components/docsend_analytics_add_on_modal","metaserver/static/js/modules/clean/stormcrow/gating_factory","typescript/component_libraries/deep-integrations/src/instrumentation/constants","lodash"],(function(e,t,n,s,i,o,a,r,l,c,u,d,p,m,_,f,h,g,v,E,S,y,A,O,I,x,b,T,M,w,C,N,P,j,F,D,U,L,B,k,R,W,V,H,q,G,z,X,Y,Z,K,$,Q){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SplitShareButton=t.SplitShareButtonComponent=void 0,s=n.__importDefault(s),o=n.__importStar(o),H=n.__importStar(H),T.getStore();const J=({openOption:e,description:t,rightAccessory:n,experimentInfo:s,actionSurface:i})=>{let a;return a=e.iconElement?e.iconElement:e.iconUrl?o.default.createElement("img",{alt:"",src:e.iconUrl,width:24,height:24}):null,o.default.useEffect(()=>{var e;"docsend_analytics_add_on"===(null==s?void 0:s.experimentName)&&X.ProEventsLogger.log(`docsend_analytics_add_on_${null===(e=s.variant)||void 0===e?void 0:e.toLowerCase()}`,{entryPoint:"split_share_menu",actionSurface:i})},[]),o.default.createElement(r.Menu.ActionItem,{value:e,withLeftAccessory:a,withSubtitle:t,withRightAccessory:n},e.text)};class ee extends o.default.Component{constructor(t){super(t),this.updateClientPortalMenuItem=()=>{new Promise((t,n)=>{e(["metaserver/static/js/business_space/browse/browse_exports"],t,n)}).then(n.__importStar).then(({ClientPortalMenuItem:e,isClientPortalMenuItemEnabled:t})=>{const n=t();this.setState({shouldShowClientPortalMenuItem:n,clientPortalMenuItem:o.default.createElement(e,{user:this.props.user,splitShareButtonFile:1===this.props.files.length&&"inline_action_bar"===this.props.actionSurface&&this.props.files[0].is_dir?this.props.files[0]:void 0})})})},this.preloadCampaignMenuItemAssets=()=>{new Promise((t,n)=>{e(["metaserver/static/js/campaigns/campaign_formats/menu/campaign_menu_item"],t,n)}).then(n.__importStar)},this.handleClickShare=e=>{e.preventDefault(),this.props.onShowShare(),this.props.logShareButtonClick&&this.props.logShareButtonClick(this.props.renderMenuOnly?R.ActionSourceValue.OVERFLOW_MENU:R.ActionSourceValue.SPLIT_SHARE),this.currentSession&&this.currentSession.event("click_share",{trigger_type:this.props.triggerType}),e.stopPropagation()},this.handleSelectAction=e=>{e.handler()},this.logSelectActionOverflowMenu=(e,t)=>{this.props.logShareButtonClick&&this.props.logShareButtonClick(this.props.renderMenuOnly?R.ActionSourceValue.OVERFLOW_MENU:R.ActionSourceValue.SPLIT_SHARE,e),A.logEvent(this.currentSession,"select_action",{type:t,trigger_type:this.props.triggerType})},this.handlePreventMouseDown=e=>{e.preventDefault(),this.state.tooltipState===h.TooltipState.BIG_ONBOARDING_TOOLTIP&&(this.markSplitShareTooltipViewed(),this.setState({tooltipState:h.TooltipState.NO_TOOLTIP})),e.stopPropagation()},this.handlePopoverHover=()=>{this.currentSession&&this.currentSession.event("popover_trigger_hover",{trigger_type:this.props.triggerType})},this.handleShareHover=()=>{this.currentSession&&this.currentSession.event("share_hover",{trigger_type:this.props.triggerType})},this.handlePopoverToggle=({isOpen:e})=>{const{onDropdownOpen:t,onDropdownClose:n,triggerType:s}=this.props;e&&t?t():!e&&n&&n(),this.currentSession&&this.currentSession.event(e?"open_popover":"close_popover",{trigger_type:s})},this.handlePresentInZoom=(e,t)=>{const{refreshSharingServiceInfo:n,sharingServiceInfo:s,onPresentInZoom:i,landingPageEnabled:o}=this.props;s&&n&&i&&O.presentInZoomFlow(e,s,n,i,"split_share_button",o,t)},this.handleShareInSlack=(e,t,n)=>{const{refreshSharingServiceInfo:s,sharingServiceInfo:i,landingPageEnabled:o}=this.props;i&&s&&O.shareInSlackFlow(t,i,s,e,"split_share_button",o,n)},this.handleShareToTrello=(e,t,n)=>{const{refreshSharingServiceInfo:s,sharingServiceInfo:i,landingPageEnabled:o}=this.props;i&&s&&O.shareInTrelloFlow(t,i,s,e,"split_share_button",o,n)},this.handleUploadToCanvas=(e,t,n)=>{const{refreshSharingServiceInfo:s,sharingServiceInfo:i,landingPageEnabled:o}=this.props;i&&s&&O.shareInCanvasFlow(t,i,s,e,"split_share_button",o,n)},this.handleUpdateLinkState=(e,t)=>{const{updateLinkState:n}=this.props;n({actionId:e,linkState:t})},this.handleAppAction=(e,t,n)=>{const{context:s,featureFlags:i}=this.props,o=e.map(e=>e);g.redirectToActionOrShowAuth(t,o,n,i,s,this.handleUpdateLinkState,this.handleShareAction),A.logEvent(this.currentSession,"select_action",A.getAppActionExtras(n))},this.handleShareAction=(e,t,n)=>{const s=n.handler.service_type[".tag"],i={".tag":"profile_linked"},o=()=>{this.handleUpdateLinkState(n.id,i),g.authorizeNoRedirect(e,n.id)};switch(s){case"slack_dropbox":return this.handleShareInSlack(t,e,o);case"zoom":return this.handlePresentInZoom(e,o);case"trello":return this.handleShareToTrello(t,e,o);case"canvas":return this.handleUploadToCanvas(t,e,o)}},this.getAppActionIconUrl=e=>{const{icon:t}=e;return t&&t.url&&!t.is_static?t.url:L.static_url("/static/images/generic_app_icon-vflIPYT1H.png")},this.getAppActionOpenOptionActions=({handler:e})=>{if("profile_service"!==e[".tag"])return{type:D.OpenButtonAction.APP_ACTION,userAction:F.UserAction.ShareToAction};switch(e.service_type[".tag"]){case"slack_dropbox":return{type:D.OpenButtonAction.SHARE_TO_SLACK,userAction:F.UserAction.ShareToSlack};case"zoom":return{type:D.OpenButtonAction.PRESENT_IN_ZOOM,userAction:F.UserAction.PresentInZoom};case"trello":return{type:D.OpenButtonAction.SHARE_TO_TRELLO,userAction:F.UserAction.ShareToTrello};default:return{type:D.OpenButtonAction.APP_ACTION,userAction:F.UserAction.ShareToAction}}},this.handleHellosignDeepIntegrationLaunch=(t,s,i,o)=>new Promise((t,n)=>{e(["metaserver/static/js/modules/clean/integrations/hellosign_deep_integration/launcher"],t,n)}).then(n.__importStar).then(({getLauncher:e})=>{const n=e();return n.init({entryPoint:o||"share_menu",file:t,user:s,source:i}),n}).then(e=>(e.launch(),e)),this.getHellosignOpenOption=(e,t,n)=>({handler:(s,i)=>{X.ProEventsLogger.log(`bt_send_for_signature_naming_${null==n?void 0:n.toLowerCase()}_click`,{entryPoint:i||"share_menu",actionSource:this.props.actionSurface}),this.handleHellosignDeepIntegrationLaunch(e,t,s,i),this.logSelectActionOverflowMenu(F.UserAction.SendForSignatureAction,D.OpenButtonAction.PREPARE_FOR_SIGNATURE)},iconUrl:L.static_url("/static/images/integrations/hellosign/signature-vflBGJCuJ.svg"),spriteName:null,text:"V1"===n?k.intl.formatMessage({id:"5FnylE",defaultMessage:"Request signature"}):"V2"===n?k.intl.formatMessage({id:"yE6iIU",defaultMessage:"Send signature request"}):k.intl.formatMessage({id:"KPapIP",defaultMessage:"Send for signature"}),type:D.OpenButtonAction.PREPARE_FOR_SIGNATURE,userAction:F.UserAction.SendForSignatureAction}),this.handleShareWithAnalytics=(e,t,n)=>{X.ProEventsLogger.log(`docsend_analytics_add_on_${n}_click`,{entryPoint:"split_share_menu",actionSource:this.props.actionSurface}),Z.showDocSendAnalyticsModal({fileId:e.file_id,fileName:m.filename(e.ns_path),user:t})},this.getAppActionOpenOption=(e,t,n)=>{const{type:s,userAction:i}=this.getAppActionOpenOptionActions(n);return{handler:()=>{this.handleAppAction(e,t,n),this.logSelectActionOverflowMenu(i,s)},spriteName:null,text:n.description,type:s,userAction:i,iconUrl:this.getAppActionIconUrl(n)}},this.getMoreAppsOpenOption=(e,t)=>({handler:()=>{this.handleMoreApps(e,t),A.logEvent(this.currentSession,"select_show_more",{}),this.logSelectActionOverflowMenu(F.UserAction.OpenMoreApps,D.OpenButtonAction.OPEN_MORE_APPS)},text:k.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}),type:D.OpenButtonAction.OPEN_MORE_APPS,userAction:F.UserAction.OpenMoreApps,spriteName:null,iconElement:o.default.createElement(u.UIIcon,{src:c.AddCircleLine})}),this.getAddAppsOpenOption=(e,t)=>({handler:()=>{this.handleMoreApps(e,t),A.logEvent(this.currentSession,"select_add_apps",{}),this.logSelectActionOverflowMenu(F.UserAction.OpenAddApps,D.OpenButtonAction.OPEN_ADD_APPS)},text:k.intl.formatMessage({id:"XFA09U",defaultMessage:"Connect apps"}),type:D.OpenButtonAction.OPEN_ADD_APPS,userAction:F.UserAction.OpenAddApps,spriteName:null,iconElement:o.default.createElement(u.UIIcon,{src:c.AddCircleLine})}),this.getAppCenterLinkOpenOption=()=>({handler:()=>{A.logEvent(this.currentSession,"select_show_more",{}),this.logSelectActionOverflowMenu(F.UserAction.OpenMoreApps,D.OpenButtonAction.OPEN_MORE_APPS),H.open_tab(new q.URI({path:"/apps"}))},text:k.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}),type:D.OpenButtonAction.OPEN_MORE_APPS,userAction:F.UserAction.OpenMoreApps,spriteName:null,iconElement:o.default.createElement(u.UIIcon,{src:c.AddCircleLine})}),this.handleMoreApps=(e,t)=>{const{appActions:n,featureFlags:s,context:i,categoryInfo:o}=this.props,a=C.getCategoryIdToInfos(o);w.showExtensionsMiniDirectoryModal(k.intl.formatMessage({id:"A7cFjC",defaultMessage:"Share with these apps"}),t,e,n.sort(x.actionCompareFn),a,s,this.handleUpdateLinkState,i,this.currentSession,this.handleShareAction)},this.computeReferrer=e=>{const t=this.props.renderMenuOnly?R.ActionSourceValue.OVERFLOW_MENU:R.ActionSourceValue.SPLIT_SHARE;return j.computeSplitShareMenuReferrer(e,t,this.props.retrievalSource,this.props.actionSurface)},this.getShareWithEmailOpenOption=()=>{const{onShowShare:e}=this.props;return{handler:()=>{e(),this.logSelectActionOverflowMenu(F.UserAction.InviteViaEmail,D.OpenButtonAction.INVITE_VIA_EMAIL)},spriteName:null,text:k.intl.formatMessage({id:"8U/qbn",defaultMessage:"Share with Dropbox"}),type:D.OpenButtonAction.INVITE_VIA_EMAIL,userAction:F.UserAction.InviteViaEmail,iconElement:o.default.createElement(u.UIIcon,{className:"test-id-share-dig-icon",src:c.ShareArrowLine})}},this.getConvertAndShareSubmenu=()=>{const{files:e,user:t}=this.props;if(1!==e.length)return null;const n=e[0];return o.default.createElement(z.ConvertAndShareSubmenu,{file:n,user:t})},this.getTransferOpenOptions=e=>({handler:()=>{e(),this.logSelectActionOverflowMenu(F.UserAction.Transfer,D.OpenButtonAction.TRANSFER)},spriteName:null,text:k.intl.formatMessage({id:"3MahuB",defaultMessage:"Send a copy"}),type:D.OpenButtonAction.TRANSFER,userAction:F.UserAction.Transfer,iconElement:o.default.createElement(u.UIIcon,{src:c.DropboxTransferLine})}),this.createShopCampaignProps=(e,t)=>{const n=j.getCountOfEachFileExtension(e),s={experiment:"core_act_shop_entry_point",location:t,file_exts:n};return{slotId:"split_share_menu",initialState:{contextData:{fileExts:n,fileIds:e.map(e=>e.file_id).join("."),referrer:t},loggingParams:{onImpression:{eventName:U.ShopEntryPointEvents.SHOP_ENTRY_POINT_IMPRESSION,extras:s},onConfirm:{eventName:U.ShopEntryPointEvents.SHOP_ENTRY_POINT_CTA_CLICK,extras:s}}}}},this.getPopoverTriggerRenderer=(e,t,n)=>i=>{const{isVisible:a,variant:r}=this.props,p=Object.assign({className:s.default("extensions-split-share-menu__trigger",{"extensions-split-share-menu__trigger--collapsed":e}),tabIndex:a?void 0:-1,onMouseEnter:this.handlePopoverHover,"aria-label":k.intl.formatMessage({id:"5MpLpV",defaultMessage:"Expand share menu"})},i);return e?o.default.createElement(d.Tooltip,{positionOffset:8,positioning:"left",tooltipContent:k.intl.formatMessage({id:"TFeNOo",defaultMessage:"Share"})},o.default.createElement(l.IconButton,Object.assign({variant:"primary"===r?"filled":r},p),o.default.createElement(u.UIIcon,{src:c.ShareArrowLine,"aria-label":n}))):t?o.default.createElement(l.Button,Object.assign({},p,{withIconLeft:o.default.createElement(u.UIIcon,{src:c.ShareArrowLine,className:"extensions-split-share--icon"}),variant:r,withDropdownIcon:!0}),k.intl.formatMessage({id:"DHK0zq",defaultMessage:"Share all selected"})):o.default.createElement(l.Button,Object.assign({},p,{variant:r,withDropdownIcon:!0,_hasSquaredSize:!0}))},this.renderPopoverItems=()=>{const{user:e,files:t,appActions:n,nonHellosignAppActions:s,featureFlags:{docsendAnalyticsAddOn:a,hellosignDeepIntegration:l,dndSplitShare:d,fileTransfersAppAction:m,flowsConvertAndShareUi:_,btSendForSignatureNaming:f},isSendForSignatureEnabled:h}=this.props,g=1===t.length,v=t[0],S=t.map(e=>e),y=this.computeReferrer(S),A="DEEP_INTEGRATION"===l&&!Y.is_supported_mobile_browser(),O=g&&p.isHellosignFileByExtension(N.getFileExt(Object.assign(Object.assign({},v),{bytes:0})));let I=null,b=n;if(A&&O&&h){b=s;const t=this.getHellosignOpenOption(v,e,f);if("CONTROL"===f||"V1"===f||"V2"===f){K.getGatingClientSingleton().logExposure({stormcrowVariantInfo:{feature:$.InstrFeatureType.SendForSignatureNaming,variant:f}})}I=o.default.createElement(J,{openOption:t})}let T=null;if("ON"===d&&"v1"!==(null==a?void 0:a.toLowerCase())){const n=b.find(e=>e.app_id===F.DOCSEND_PROD_APP_ID);if(n){b=b.filter(e=>e.app_id!==F.DOCSEND_PROD_APP_ID);const s=this.getAppActionOpenOption(t,e,n);s.text=k.intl.formatMessage({id:"r4C3UE",defaultMessage:"Send and track"});let i=void 0;"control"===(null==a?void 0:a.toLowerCase())&&(i={experimentName:"docsend_analytics_add_on",variant:"control"}),T=o.default.createElement(J,{key:s.text,openOption:s,experimentInfo:i,actionSurface:this.props.actionSurface})}}const M="v1"===(null==a?void 0:a.toLowerCase())||"v2"===(null==a?void 0:a.toLowerCase()),w=g&&p.isDocsendSupportedFile(v.bytes,N.getFileExt(v));let C=null;if(M&&w){const t={handler:()=>{this.handleShareWithAnalytics(v,e,null==a?void 0:a.toLowerCase())},spriteName:null,text:k.intl.formatMessage({id:"BFJj5Z",defaultMessage:"Share with Analytics"}),type:D.OpenButtonAction.SHARE_WITH_ANALYTICS,userAction:F.UserAction.ShareWithAnalytics,iconElement:o.default.createElement(u.UIIcon,{src:c.AnalyticsLine})};C=o.default.createElement(J,{key:t.text,openOption:t,experimentInfo:{experimentName:"docsend_analytics_add_on",variant:null==a?void 0:a.toLowerCase()},actionSurface:this.props.actionSurface})}const P=W.shouldShowTransferInSplitShare("ON"===m,S),j=()=>this.handleAddToTransfer(S,y,e),{slotId:U,initialState:L}=this.createShopCampaignProps(S,y),{campaignProps:B,filters:R}=E.preloadCampaign(U),V=Object.assign(Object.assign({},L.contextData),{shouldLogQualifyEvent:!1}),H=E.shouldCampaignRender(R,B,V);V.shouldLogQualifyEvent=!0,L.contextData=V;const q={slotId:U,initialState:Object.assign(Object.assign({},L),{campaignProps:B,filters:R})},G=o.default.createElement(E.CampaignSlot,Object.assign({},q)),{installedActions:z,unpromotedActions:X}=x.partitionActions(b),Z=Boolean(g),Q=Boolean(this.state.shouldShowClientPortalMenuItem),ee=Z||Boolean(P)||Boolean(T)||Boolean(I)||Boolean(H)||Boolean(Q),te=(!i.isEmpty(X)||!i.isEmpty(z)||!ee)&&o.default.createElement(r.Menu.Segment,null,z.map(n=>{const s=this.getAppActionOpenOption(t,e,n);return o.default.createElement(J,{key:s.text,openOption:s})}),!i.isEmpty(X)&&g?o.default.createElement(J,{openOption:i.isEmpty(z)?this.getAddAppsOpenOption(v,e):this.getMoreAppsOpenOption(v,e)}):!ee&&i.isEmpty(z)&&o.default.createElement(J,{openOption:this.getAppCenterLinkOpenOption()})),ne="ON"===_?this.getConvertAndShareSubmenu():null;return o.default.createElement(o.Fragment,null,ee&&o.default.createElement(r.Menu.Segment,null,Z&&o.default.createElement(J,{openOption:this.getShareWithEmailOpenOption()}),P&&j&&o.default.createElement(J,{openOption:this.getTransferOpenOptions(j)}),I,T,G,C,Q&&this.state.clientPortalMenuItem,ne),te)},this.markSplitShareTooltipViewed=()=>{f.markTooltipViewed(this.props.user.id,"split_share_edu")},this.state={tooltipState:h.TooltipState.NO_TOOLTIP,shouldShowClientPortalMenuItem:!1},this.telemetryClient=v.createTelemetryClient(Object.assign({component:"split-share-btn"},t.context)),this.onboardingChecklistShareButtonTooltipTriggerRef=o.default.createRef()}componentDidMount(){this.props.showEduTooltip&&this.setEduTooltip(),this.updateClientPortalMenuItem(),this.preloadCampaignMenuItemAssets()}componentDidUpdate(e){Q.isEqual(this.props.files,e.files)||this.updateClientPortalMenuItem()}setEduTooltip(){return n.__awaiter(this,void 0,void 0,(function*(){const e=yield f.getTooltipHistory(this.props.user.id,["open_with_edu","split_share_edu"]),t=this.props.files[0];"split_share_edu"===P.allowedTooltips(this.props.appActions.length>0,t.fq_path?"."+m.file_extension(m.filename(t.fq_path)):"",this.props.featureFlags).find(t=>void 0!==e[t]&&!e[t])&&this.setState({tooltipState:h.TooltipState.BIG_ONBOARDING_TOOLTIP})}))}handleAddToTransfer(e,t,n){V.asyncShowBrowseEntryPointOnboardingModal({primaryActionOnClick:()=>W.redirectToCreateTransferWithFiles(e,t),userId:n.id})}render(){const{files:e,context:t,isVisible:n,shareButtonLabel:a,triggerType:d,isCollapsed:_,shouldUsePortalPopover:f,appActions:h,featureFlags:g,showLeftDigIcon:E,variant:y,renderMenuOnly:A,expActionBarRedesignEnabled:O}=this.props,I=1===e.length,x=e[0];t?this.currentSession=this.telemetryClient.session({ext:v.getPiiSafeExtension(x?"."+m.file_extension(m.filename(x.fq_path)):"")}):delete this.currentSession;const b={"aria-label":a,className:s.default("extensions-split-share__share-button",{"primary-action-menu__button":d===M.TriggerType.SidebarPrimaryButton}),onClick:this.handleClickShare,tabIndex:n?void 0:-1,onMouseEnter:this.handleShareHover},T=o.default.createElement(l.Button,Object.assign({},b,{withIconLeft:E&&o.default.createElement(u.UIIcon,{src:c.ShareArrowLine,className:"extensions-split-share--icon"}),variant:y}),o.default.createElement(B.UserEducationEffect,{containerName:"SplitShareButton",name:"ShareButtonLabel",useSpan:!0},a)),w=this.getPopoverTriggerRenderer(_,!I,a),C=this.props.sharingServiceInfo&&j.isSlackAvailable(this.props.sharingServiceInfo)&&j.isZoomAvailable(this.props.sharingServiceInfo),P=I&&"DEEP_INTEGRATION"===g.hellosignDeepIntegration&&p.isHellosignFileByExtension(N.getFileExt(Object.assign(Object.assign({},x),{bytes:0})))&&!Y.is_supported_mobile_browser();return A?this.renderPopoverItems():o.default.createElement("div",{className:s.default("extensions-split-share-btn",{"extensions-split-share-btn--invisible":!n,"slack-zoom-available":C&&!_,"slack-zoom-available-collapsed":C&&_,"hellosign-available":P,"share-fake-split-button":!i.isEmpty(h)}),ref:this.onboardingChecklistShareButtonTooltipTriggerRef},!_&&I&&T,o.default.createElement(G.AsyncOnboardingChecklistShareButtonTooltip,{triggerRef:this.onboardingChecklistShareButtonTooltipTriggerRef}),o.default.createElement(r.Menu.Wrapper,{className:s.default("extensions-split-share__popover",{"hellosign-available-dropdown":P,"extensions-split-share__unportaled-menu":!f}),onClick:this.handlePreventMouseDown,onDoubleClick:this.handlePreventMouseDown,onSelection:(e,t)=>{S.handleCampaignMenuSelection(e,t,this.handleSelectAction)},onToggle:this.handlePopoverToggle,closeOnSelection:!0,isPortaled:f},({getContentProps:e,getTriggerProps:t})=>o.default.createElement(o.default.Fragment,null,w(t()),o.default.createElement(r.Menu.Content,Object.assign({placement:"bottom-end",className:O?"rc-action-bar-submenu-content":""},e()),this.renderPopoverItems()))))}}t.SplitShareButtonComponent=ee,ee.defaultProps={isVisible:!0,shareButtonLabel:k.intl.formatMessage({id:"TFeNOo",defaultMessage:"Share"}),triggerType:M.TriggerType.PrimaryButton,variant:"opacity"},ee.displayName="SplitShareButtonComponent";const te={refreshSharingServiceInfo:I.refreshSharingServiceInfoAdapter,updateLinkState:I.updateLinkState},ne=a.connect((e,t)=>{const n=t.files.map(e=>Object.assign(Object.assign({},e),{bytes:0}));return{appActions:b.getShareActionsForFiles(e,n),nonHellosignAppActions:b.getNonHellosignActionsForFiles(e,n,F.HELLOSIGN_PROD_APP_ID),categoryInfo:b.getCategoryInfos(e),featureFlags:b.getFeatureFlags(e),sharingServiceInfo:b.getSharingServiceInfoAdapter(e),landingPageEnabled:_.isConnectServiceLandingPagesEnabled(e),isSendForSignatureEnabled:_.isSendForSignatureEnabled(e)}},te)(ee);t.SplitShareButton=y.requireCssWithComponent(ne,["/static/css/extensions/index-vflTeCGSU.css","/static/css/app_actions/index-vflnjwhRA.css"])})),define("metaserver/static/js/modules/clean/react/extensions/status_page",["require","exports","tslib","react","metaserver/static/js/components/ui/css","spectrum/button/index","metaserver/static/js/modules/clean/react/image","metaserver/static/js/modules/clean/static_urls","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/constants/payments","metaserver/static/js/account/email","metaserver/static/js/account/email_verify_reasons","metaserver/static/js/dropbox/proto/js_init_data/extensions/extensions","metaserver/static/js/proto_utils/unpack"],(function(e,t,n,s,i,o,a,r,l,c,u,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=t.DocuSignInvalidFilePage=t.FileTooLargePage=t.UnverifiedEmailPage=t.NoWritePermissionPage=t.DocuSignPermissionDeniedPage=t.AppActionsOverQuotaPage=t.AppActionsErrorPage=t.AppActionsLoadingPage=void 0,s=n.__importDefault(s),c=n.__importStar(c);const _=e=>{const t=r.static_url(`/static/images/illustration_catalog/${e.illustrationName}.png`),n=r.static_url(`/static/images/illustration_catalog/${e.illustrationName}@2x.png`);return s.default.createElement("div",{className:"app-actions-status-page"},s.default.createElement(a.Image,{className:"app-actions-status-image",src:t,srcHiRes:n}),s.default.createElement("div",{className:"app-actions-status-content"},e.children))},f=e=>s.default.createElement(_,{illustrationName:e.illustrationName},s.default.createElement("div",{className:"app-actions-status-text"},s.default.createElement("div",{className:"app-actions-status-text__header"},e.headerText)),s.default.createElement("div",{className:"app-actions-status-detail"},e.detailText),s.default.createElement(o.Button,{className:"app-actions-status-button",onClick:e.buttonOnClick,href:e.buttonHref,variant:"primary"},e.buttonTitle));function h(){window.close()}t.AppActionsLoadingPage=i.requireCssWithComponent(e=>s.default.createElement("div",{className:"app-actions-status-page"},s.default.createElement(a.Image,{className:"app-actions-status-image",src:r.static_url("/static/images/dbx_cloud_doc_loading-vfl9ZK2NS.gif")}),s.default.createElement("div",{className:"app-actions-status-detail"},e.fileName)),["/static/css/app_actions/status_page-vflxeNuOK.css","/static/css/components/loading_indicator-vflkh07Fb.css"]),t.AppActionsErrorPage=i.requireCssWithComponent(e=>s.default.createElement(f,{illustrationName:"sickbox-illo_m1",headerText:l.intl.formatMessage({id:"G79Iwz",defaultMessage:"Oops... something went wrong"}),detailText:l.intl.formatMessage({id:"ZvMuf8",defaultMessage:"Oh no, it looks like we failed to load your file. Please return to Dropbox and try once more."}),buttonOnClick:h,buttonTitle:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"})}),["/static/css/app_actions/status_page-vflxeNuOK.css","/static/css/spectrum/index.web-vfliw9181.css"]),t.AppActionsOverQuotaPage=i.requireCssWithComponent(e=>{let t=c.OUT_OF_SPACE_URL+"?oqa=wb_oq_aa",n=l.intl.formatMessage({id:"iIucBq",defaultMessage:"Get more space"});return e.isTeam&&(t="/help/business/space-limit-full",n=l.intl.formatMessage({id:"K2PjtT",defaultMessage:"Learn more about Dropbox space"})),s.default.createElement(f,{illustrationName:"illo-catbox",headerText:l.intl.formatMessage({id:"0eDgXK",defaultMessage:"Your Dropbox is full"}),detailText:l.intl.formatMessage({id:"nyrsTE",defaultMessage:"Uh oh, in order to perform this action, you need to add more storage to your Dropbox."}),buttonTitle:n,buttonHref:t})},["/static/css/app_actions/status_page-vflxeNuOK.css","/static/css/spectrum/index.web-vfliw9181.css"]),t.DocuSignPermissionDeniedPage=i.requireCssWithComponent(e=>s.default.createElement(f,{illustrationName:"account_requires_access",headerText:l.intl.formatMessage({id:"lZ3sPD",defaultMessage:"Your DocuSign account has restricted access"}),detailText:l.intl.formatMessage({id:"lF/7ht",defaultMessage:"It looks like your DocuSign account does not have permission to send envelopes. Please contact your DocuSign admin."}),buttonTitle:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),buttonOnClick:h}),["/static/css/app_actions/status_page-vflxeNuOK.css","/static/css/spectrum/index.web-vfliw9181.css"]),t.NoWritePermissionPage=i.requireCssWithComponent(e=>s.default.createElement(f,{illustrationName:"403_error-illo",headerText:l.intl.formatMessage({id:"G79Iwz",defaultMessage:"Oops... something went wrong"}),detailText:l.intl.formatMessage({id:"NiMCaD",defaultMessage:"You do not have access to update files in this folder."}),buttonTitle:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),buttonOnClick:h}),["/static/css/app_actions/status_page-vflxeNuOK.css","/static/css/spectrum/index.web-vfliw9181.css"]),t.UnverifiedEmailPage=i.requireCssWithComponent(e=>s.default.createElement(f,{illustrationName:"illo-catbox",headerText:l.intl.formatMessage({id:"Bf160P",defaultMessage:"Verify Your Email"}),detailText:l.intl.formatMessage({id:"Vg1D7j",defaultMessage:"In order to perform this action, Dropbox needs to verify your email address to share links."}),buttonTitle:l.intl.formatMessage({id:"DUVaTi",defaultMessage:"Verify Email"}),buttonOnClick:()=>{return t=e.role,void u.EmailVerification.getForRole(t).show_verify_modal(null,d.EmailVerificationReasons.GENERIC);var t}}),["/static/css/app_actions/status_page-vflxeNuOK.css","/static/css/spectrum/index.web-vfliw9181.css","/static/css/account/emails-vflCpG_Hm.css","/static/css/maestro_layout-vflen4FrE.css","/static/css/upsell/prompt_pagelet-vflqruaIz.css","/static/css/notify-vflZVEumu.css"]),t.FileTooLargePage=i.requireCssWithComponent(({maxFileSize:e})=>{const t=Number(e),n=(i=t,isFinite(i)&&i>0?l.intl.formatMessage({id:"fQlkHi",defaultMessage:"The file you selected is larger than the supported {supported_value}MB. Please try again with a smaller file."},{supported_value:t.toString(10)}):l.intl.formatMessage({id:"WMJEtg",defaultMessage:"The file you selected is larger than supported. Please try again with a smaller file."}));var i;return s.default.createElement(f,{illustrationName:"illo-catbox",headerText:l.intl.formatMessage({id:"4pvYSI",defaultMessage:"Can’t open file"}),detailText:n,buttonTitle:l.intl.formatMessage({id:"QeGZf9",defaultMessage:"Return to Dropbox"}),buttonOnClick:h})},["/static/css/app_actions/status_page-vflxeNuOK.css","/static/css/spectrum/index.web-vfliw9181.css"]),t.DocuSignInvalidFilePage=i.requireCssWithComponent(e=>s.default.createElement(f,{illustrationName:"illo-catbox",headerText:l.intl.formatMessage({id:"4pvYSI",defaultMessage:"Can’t open file"}),detailText:l.intl.formatMessage({id:"+3VSGf",defaultMessage:"The file you selected cannot be validated in DocuSign. Please try again with a valid file."}),buttonTitle:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),buttonOnClick:h}),["/static/css/app_actions/status_page-vflxeNuOK.css","/static/css/spectrum/index.web-vfliw9181.css"]);t.RootComponent=e=>{const n=m.unpackProto(e.encodedProto,p.extensions.StatusPageProps);switch(n.pageType){case p.extensions.StatusPageProps.PageType.DEFAULT:return s.default.createElement(t.AppActionsErrorPage,null);case p.extensions.StatusPageProps.PageType.QUOTA:return s.default.createElement(t.AppActionsOverQuotaPage,{isTeam:n.isTeam});case p.extensions.StatusPageProps.PageType.DOCUSIGN:return s.default.createElement(t.DocuSignPermissionDeniedPage,null);case p.extensions.StatusPageProps.PageType.ACCESS:return s.default.createElement(t.NoWritePermissionPage,null);case p.extensions.StatusPageProps.PageType.UNVERIFIED_EMAIL:return s.default.createElement(t.UnverifiedEmailPage,{role:n.role});case p.extensions.StatusPageProps.PageType.FILE_TOO_LARGE:return s.default.createElement(t.FileTooLargePage,{maxFileSize:Number(n.maxFileSize)});case p.extensions.StatusPageProps.PageType.DOCUSIGN_INVALID_FILE:return s.default.createElement(t.DocuSignInvalidFilePage,null)}}})),define("metaserver/static/js/modules/clean/react/file_viewer/unity/unity_utils",["require","exports","tslib","metaserver/static/js/modules/clean/unity/check_file_cache","metaserver/static/js/modules/clean/unity/features"],(function(e,t,n,s,i){"use strict";function o(e,t){i.UnityFeatures.file_browser_display_name((function(n){e.file_browser_display_name=n,t(e)}),()=>t(e))}function a(e){return null!=e&&(!!e.is_locally_available||!!e.is_infinite_placeholder)&&t.UnityHelpers.clientSupportsOpenInFileBrowser()}function r(e){return null!=e&&!!e.is_locally_available&&!1!==e.can_open_directly}Object.defineProperty(t,"__esModule",{value:!0}),t.UnityHelpers=t.isUnityFileSupported=t.isUnityFolderSupported=void 0,s=n.__importDefault(s),t.isUnityFolderSupported=a,t.isUnityFileSupported=r,t.UnityHelpers={isUnityEnabled:function(){return i.UnityFeatures.isUnitySupported()},isFileInUnityCache:function(e,t){return!!s.default.is_cached_and_locally_available(e,t)},clientSupportsOpenInFileBrowser:function(){return i.UnityFeatures.client_supports_open_in_file_browser()},getFileInfoFromUnityCache:function(e,t){return s.default.get(e,t)},fetchUnityFileInfo:function(e,t,n,s,a){i.UnityFeatures.check_file(e,t,n,e=>{e.is_locally_available?o(e,s):s(e)},a)},getUnityFileInfo:function(e,n,s,i,a){if(t.UnityHelpers.isFileInUnityCache(e,n)){const s=t.UnityHelpers.getFileInfoFromUnityCache(e,n);s.is_locally_available&&null==s.file_browser_display_name?o(s,i):i(s)}else t.UnityHelpers.fetchUnityFileInfo(e,n,s,i,a)},openFile:function(e,t,n,s){i.UnityFeatures.open_file(e,t,n,i.UnityFeatures.standard_open_file_handler,()=>i.UnityFeatures.standard_open_file_handler(!1),s)},isUnityFolderSupported:a,isUnityFileSupported:r}})),define("metaserver/static/js/modules/clean/react/extensions/shared_file_popover_content_component",["require","exports","tslib","react","metaserver/static/js/modules/clean/react/extensions/common","metaserver/static/js/modules/clean/react/extensions/cloud_docs_compat","metaserver/static/js/components/ui/css","metaserver/static/js/modules/clean/react/file_viewer/open_button/types","metaserver/static/js/cloud_docs/open_with_utils","metaserver/static/js/modules/clean/react/extensions/unity_and_cloud_editors","metaserver/static/js/modules/clean/react/file_viewer/constants","metaserver/static/js/cloud_docs/types"],(function(e,t,n,s,i,o,a,r,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedFilePopoverContent=t.SharedFilePopoverContentComponent=void 0,s=n.__importDefault(s);class p extends s.default.Component{constructor(e){super(e),this.createActionClickHandler=e=>()=>{if("cloud_editor"===e.handler[".tag"]){const t=o.isWopiAction(e)?r.OpenButtonAction.OPEN_WITH:r.OpenButtonAction.OPEN_WITH_CLOUD_DOC;i.logEvent(this.props.currentSession,"select_legacy_action",{type:t});const n=d.UserActionSourceType.WEB_PREVIEW,s=o.cloudEditorNameToParams(e.handler.editor_name);l.openWithCloudEditor(l.fileToOpenWithParams(this.props.file),this.props.user.id,s,!1,n)}}}render(){if(0===this.props.openOptions.length&&0===this.props.cloudEditorAppActions.length)return null;const e=this.props.cloudEditorAppActions.map(e=>({appAction:e,handler:this.createActionClickHandler(e),userAction:u.UserAction.OpenWithAppAction,actionName:e.description}));return s.default.createElement(c.UnityAndCloudEditors,{unityOptions:[],legacyCloudEditorOptions:this.props.openOptions,cloudEditorAppActions:e,bylines:{},wrapValuesForActionBar:!!this.props.isInActionBar})}}t.SharedFilePopoverContentComponent=p,p.displayName="SharedFilePopoverContentComponent",t.SharedFilePopoverContent=a.requireCssWithComponent(p,["/static/css/app_actions/index-vflnjwhRA.css"])})),define("metaserver/static/js/modules/clean/react/extensions/extensions_popover_content_component_v2",["require","exports","tslib","dig-components/icons","dig-components/icons/src","dig-components/menu","metaserver/static/js/file_store/utils","metaserver/static/js/app_actions/redirect","metaserver/static/js/components/ui/css","metaserver/static/js/modules/clean/react/extensions/cloud_docs_compat","metaserver/static/js/modules/clean/react/extensions/common","metaserver/static/js/modules/clean/react/extensions/data/helpers","metaserver/static/js/modules/clean/react/extensions/extensions_mini_directory_modal","metaserver/static/js/modules/clean/react/extensions/menu_survey","metaserver/static/js/modules/clean/react/extensions/unity_and_cloud_editors","metaserver/static/js/modules/clean/react/extensions/utils","metaserver/static/js/modules/clean/react/file_viewer/constants","metaserver/static/js/modules/clean/react/file_viewer/open_button/types","metaserver/static/js/modules/clean/react/file_viewer/unity/with_unity","metaserver/static/js/modules/clean/static_urls","metaserver/static/js/modules/core/i18n","react","metaserver/static/js/modules/clean/react/file_viewer/file_conversion/file_conversion_options"],(function(e,t,n,s,i,o,a,r,l,c,u,d,p,m,_,f,h,g,v,E,S,y,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsPopoverV2NoUnity=t.ExtensionsPopoverV2WithUnity=void 0,y=n.__importDefault(y);class O extends y.default.Component{constructor(e){super(e),this.createAppActionClickHandler=e=>()=>{const{file:t,user:n,featureFlags:s,telemetryContext:i,updateLinkState:o}=this.props;if(r.redirectToActionOrShowAuth(n,[t],e,s,i,o),"redirect"===e.handler[".tag"]){const t=u.getAppActionExtras(e);u.logEvent(this.props.currentSession,"select_action",Object.assign({menu_version:2},t))}else if("cloud_editor"===e.handler[".tag"]){const t=c.isWopiAction(e)?g.OpenButtonAction.OPEN_WITH:g.OpenButtonAction.OPEN_WITH_CLOUD_DOC;u.logEvent(this.props.currentSession,"select_legacy_action",{type:t})}},this.wrapperForAction=e=>({appAction:e,handler:this.createAppActionClickHandler(e),userAction:h.UserAction.OpenWithAppAction,actionName:e.description}),this.renderActionRow=e=>{const t=e.icon;let n;n=t.is_static?E.static_url("/static/images/generic_app_icon-vflIPYT1H.png"):t.url;const s=e.description,i=this.props.isInActionBar?f.toActionBarValue(this.wrapperForAction(e)):this.wrapperForAction(e);return y.default.createElement(o.Menu.ActionItem,{key:e.id,value:i,withLeftAccessory:y.default.createElement("img",{alt:"",src:n,width:24,height:24})},s)},this.renderUnpromotedActions=(e,t)=>{const{user:n,file:a,categoryIdToInfos:r,featureFlags:l,currentSession:c,telemetryContext:d,updateLinkState:m,isInActionBar:_}=this.props,h=e.length>0,g={handler:()=>{const s=[...e,...t];p.showExtensionsMiniDirectoryModal(S.intl.formatMessage({id:"KVD2SP",defaultMessage:"Open or edit with these apps"}),n,a,s,r,l,m,d,c),u.logEvent(c,h?"select_show_more":"select_add_app",{surface:d&&d.surface})}},v=_?f.toActionBarValue(g):g;return y.default.createElement(o.Menu.ActionItem,{key:S.intl.formatMessage({id:"R/67N/",defaultMessage:"Show more"}),value:v,withLeftAccessory:h&&!_?null:y.default.createElement(s.UIIcon,{src:i.AddCircleLine})},h?S.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}):S.intl.formatMessage({id:"XFA09U",defaultMessage:"Connect apps"}))}}render(){const{user:e,appActions:t,openOptions:n,bylines:s,currentSession:i,isInActionBar:a}=this.props,r=u.getOpenOptionsWithLogging(n,i),{unityOptions:l,cloudEditorOptions:c,previewOption:p,openInReplayOption:f,openInDesktopOption:h,goToFolderOption:g,openInNewTabOption:v}=d.partitionOptions(r),{cloudEditors:E,installedActions:S,unpromotedActions:O}=d.partitionActions(t),I=S.length>0,x=O.length>0;return y.default.createElement(y.default.Fragment,null,y.default.createElement(A.FileConversionOptions,{openOptions:r,currentSession:i,wrapValuesForActionBar:!!a}),y.default.createElement(_.UnityAndCloudEditors,{isInActionBar:a,unityOptions:l,legacyCloudEditorOptions:c,cloudEditorAppActions:E.map(e=>this.wrapperForAction(e)),bylines:s,currentSession:i,previewOption:p,openInReplayOption:f,openInNewTabOption:v,openInDesktopOption:h,goToFolderOption:g,wrapValuesForActionBar:!!a}),a&&(I||x)&&y.default.createElement(o.Menu.Segment,null,S.map(e=>this.renderActionRow(e)),this.renderUnpromotedActions(S,O)),!a&&I&&y.default.createElement(o.Menu.Segment,{key:"installed-actions"},S.map(e=>this.renderActionRow(e))),!a&&x&&y.default.createElement(o.Menu.Segment,null,this.renderUnpromotedActions(S,O)),y.default.createElement(m.OpenMenuSurvey,{userId:e.id,session:i}))}}O.displayName="ExtensionsPopoverV2Component";t.ExtensionsPopoverV2WithUnity=e=>a.isBrowseFile(e.file)?y.default.createElement(v.WithUnity,{file:e.file,user:e.user,render:t=>y.default.createElement(O,Object.assign({},e,{unityInfo:t}))}):null,t.ExtensionsPopoverV2NoUnity=l.requireCssWithComponent(O,["/static/css/app_actions/index-vflnjwhRA.css","/static/css/extensions/index-vflTeCGSU.css"])})),define("metaserver/static/js/modules/clean/react/extensions/unity_and_cloud_editors",["require","exports","tslib","react","dig-components/icons","dig-components/icons/src","dig-components/menu","metaserver/static/js/modules/clean/react/extensions/byline","metaserver/static/js/components/ui/css","metaserver/static/js/modules/clean/react/extensions/utils","metaserver/static/js/modules/clean/react/extensions/cloud_docs_compat","metaserver/static/js/modules/clean/react/extensions/common","metaserver/static/js/modules/clean/react/file_viewer/open_button/types","metaserver/static/js/modules/clean/react/sprite","metaserver/static/js/modules/core/browser_detection"],(function(e,t,n,s,i,o,a,r,l,c,u,d,p,m,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnityAndCloudEditors=void 0,s=n.__importDefault(s);class f extends s.default.Component{render(){const{unityOptions:e,legacyCloudEditorOptions:t,cloudEditorAppActions:n,bylines:l,currentSession:f,previewOption:h,openInReplayOption:g,openInDesktopOption:v,isInActionBar:E,goToFolderOption:S,wrapValuesForActionBar:y,openInNewTabOption:A}=this.props,O=e=>y?c.toActionBarValue(e):e,I=t.map(e=>{const{type:t}=e,n=t===p.OpenButtonAction.OPEN_WITH_CLOUD_DOC?"cloud_doc":"wopi";return s.default.createElement(a.Menu.ActionItem,{key:e.text,value:O(e),withLeftAccessory:e.spriteName?s.default.createElement(m.Sprite,{group:"web",name:e.spriteName,alt:""}):s.default.createElement("img",{alt:"",src:e.iconUrl,width:24,height:24})},s.default.createElement(r.ExtensionsBylineTooltip,{isInActionBar:E,bylines:l[n],onDidShow:d.handleShowByline(n,f),key:e.text},s.default.createElement("span",null,e.text)))}),x=e.map(e=>s.default.createElement(a.Menu.ActionItem,{key:e.text,value:O(e),withLeftAccessory:(function(e){return"ow_desktop"===e.spriteName&&e.type===p.OpenButtonAction.UNITY_FILE?-1!==e.text.indexOf("Dropbox")?s.default.createElement(i.UIIcon,{src:o.DropboxLine}):s.default.createElement(i.UIIcon,{src:o.OpenLine}):s.default.createElement(m.Sprite,{group:"web",name:e.spriteName||"",alt:""})})(e)},e.text));let b=!1;const T=n.map(e=>{b||(b=u.isWopiAction(e.appAction));const t=e.appAction.handler.editor_name;return s.default.createElement(a.Menu.ActionItem,{key:e.appAction.description,value:O(e),withLeftAccessory:s.default.createElement("img",{alt:"",src:e.appAction.icon.url,width:24,height:24})},s.default.createElement(r.ExtensionsBylineTooltip,{isInActionBar:E,bylines:l[t],onDidShow:d.handleShowByline(t,f),key:e.appAction.description},s.default.createElement("span",null,e.appAction.description)))}),M=h&&s.default.createElement(a.Menu.ActionItem,{key:h.text,value:O(h),withLeftAccessory:s.default.createElement(i.UIIcon,{src:o.ShowLine})},h.text),w=g&&s.default.createElement(a.Menu.ActionItem,{key:g.text,value:O(g),withLeftAccessory:s.default.createElement(i.UIIcon,{src:o.DropboxReplayLine})},g.text),C=v&&s.default.createElement(a.Menu.ActionItem,{key:v.text,value:O(v),withLeftAccessory:s.default.createElement(i.UIIcon,{src:_.mac?o.FinderLine:o.FileExplorerLine})},v.text),N=A&&s.default.createElement(a.Menu.ActionItem,{key:A.text,value:O(A),withLeftAccessory:s.default.createElement(i.UIIcon,{src:o.GlobeLine})},A.text),P=S&&s.default.createElement(a.Menu.ActionItem,{key:S.text,value:O(S),withLeftAccessory:s.default.createElement(i.UIIcon,{src:o.FolderShowLine})},S.text),j=x.length>0||I.length>0||T.length>0||!!N||!!M||!!w||!!C||!!P;return b?j&&s.default.createElement(a.Menu.Segment,{key:"open-options"},N,P,T,x,I,M,w,C):j&&s.default.createElement(a.Menu.Segment,{key:"open-options"},N,P,x,I,T,M,w,C)}}f.displayName="UnityAndCloudEditorsComponent",t.UnityAndCloudEditors=l.requireCssWithComponent(f,["/static/css/app_actions/index-vflnjwhRA.css","/static/css/dig-components/index.web-vflkNfl3z.css"])})),define("metaserver/static/js/modules/clean/react/extensions/menu_survey",["require","exports","tslib","react","react-redux","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","dig-components/tooltips","dig-components/typography","metaserver/static/js/components/ui/css","metaserver/static/js/modules/clean/react/extensions/common","metaserver/static/js/modules/clean/react/extensions/data/action_creators","metaserver/static/js/modules/clean/react/extensions/data/selectors","metaserver/static/js/modules/core/i18n"],(function(e,t,n,s,i,o,a,r,l,c,u,d,p,m,_,f){"use strict";var h;Object.defineProperty(t,"__esModule",{value:!0}),t.OpenMenuSurvey=t.MenuSurvey=t.MenuSurveyElement=void 0,s=n.__importStar(s),(function(e){e.Positive="positive",e.Negative="negative"})(h||(h={}));t.MenuSurveyElement=({surveyComplete:e,onClickSurvey:t,onMouseEnterSurvey:n})=>s.default.createElement(l.Menu.Segment,null,s.default.createElement(l.Menu.Row,null,s.default.createElement("div",{className:"menu-survey__wrapper"},s.default.createElement(u.Text,{size:"small",color:"faint",className:"menu-survey__text"},e?f.intl.formatMessage({id:"iqApHe",defaultMessage:"Thanks for your feedback"}):f.intl.formatMessage({id:"PunJ70",defaultMessage:"Is this menu helpful?"})),e?null:[s.default.createElement(c.Tooltip,{title:f.intl.formatMessage({id:"ReNt2T",defaultMessage:"Helpful"}),placement:"top",key:h.Positive},s.default.createElement(o.IconButton,{variant:"transparent",onClick:()=>t(h.Positive),onMouseEnter:()=>n(h.Positive)},s.default.createElement(a.UIIcon,{src:r.ThumbsUpLine,size:"small","aria-label":"Thumbs Up"}))),s.default.createElement(c.Tooltip,{title:f.intl.formatMessage({id:"he/OAb",defaultMessage:"Not helpful"}),placement:"top",key:h.Negative},s.default.createElement(o.IconButton,{variant:"transparent",onClick:()=>t(h.Negative),onMouseEnter:()=>n(h.Negative)},s.default.createElement(a.UIIcon,{src:r.ThumbsDownLine,size:"small","aria-label":"Thumbs Down"})))])));const g=d.requireCssWithComponent(t.MenuSurveyElement,["/static/css/app_actions/index-vflnjwhRA.css","/static/css/extensions/index-vflTeCGSU.css"]);t.MenuSurvey=({userId:e,session:t,menuSurveyEnabled:n,setMenuSurveyViewed:i})=>{const[o,a]=s.useState(!1);s.useEffect(()=>{n&&p.logEvent(t,"view_feedback",{})},[n]);return o||n?s.default.createElement(g,{surveyComplete:o,onClickSurvey:n=>{a(!0),i(e),p.logEvent(t,"click_feedback",{action_type:n}),setTimeout(()=>a(!1),3e3)},onMouseEnterSurvey:e=>{p.logEvent(t,"hover_feedback",{action_type:e})}}):null};const v={setMenuSurveyViewed:m.setOpenMenuSurveyViewed},E=i.connect(e=>({menuSurveyEnabled:_.getOpenMenuSurveyEnabled(e)}),v);t.OpenMenuSurvey=E(t.MenuSurvey)})),define("metaserver/static/js/modules/clean/react/extensions/byline",["require","exports","tslib","react","dig-components/tooltips"],(function(e,t,n,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsBylineTooltip=void 0,s=n.__importDefault(s);class o extends s.default.Component{constructor(e){super(e),this.handleMouseOver=()=>{clearTimeout(this.timer),this.timer=setTimeout(()=>{this.props.bylines&&(this.setState({show:!0}),this.props.onDidShow())},this.props.delay)},this.handleMouseOut=()=>{this.setState({show:!1}),clearTimeout(this.timer)},this.triggerRef=s.default.createRef(),this.state={show:!1}}componentWillUnmount(){clearTimeout(this.timer)}render(){const{children:e,bylines:t,isInActionBar:n}=this.props,o=s.default.Children.only(e);return t?s.default.createElement(s.default.Fragment,null,s.default.createElement(i.Tooltip.Control,{triggerRef:this.triggerRef,open:this.state.show,placement:n?"right":"left"},(e=>{if(e)return e.length>1?s.default.createElement("ul",{className:"extensions-byline-list"},e.map(e=>s.default.createElement("li",{key:e,className:"extensions-byline-list-item"},e))):s.default.createElement("div",{className:"extensions-byline"},e[0])})(t)),s.default.cloneElement(o,{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,ref:this.triggerRef})):o}}t.ExtensionsBylineTooltip=o,o.defaultProps={delay:500},o.displayName="ExtensionsBylineTooltip"})),define("metaserver/static/js/modules/clean/react/extensions/client",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/modules/clean/react/extensions/feature_flags","metaserver/static/js/cloud_docs/cloud_doc_api_client","metaserver/static/js/cloud_docs/types","metaserver/static/js/modules/clean/react/extensions/apis"],(function(e,t,n,s,i,o,a,r){"use strict";function l(e){return"app_id"in e}var c;function u(){return d()}function d(e=c.DISABLED){return{displayState:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getExtensionsClient=t.Client=t.newExtensionsConfig=t.actionCompareFn=t.emptyExtensionsConfig=t.DisplayState=t.isAppId=void 0,t.isAppId=l,(function(e){e[e.LOADING=0]="LOADING",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED"})(c=t.DisplayState||(t.DisplayState={})),t.emptyExtensionsConfig=u,t.actionCompareFn=function(e,t){return e.priority&&t.priority?t.priority-e.priority:e.priority?-1:t.priority?1:e.description<t.description?-1:e.description>t.description?1:0},t.newExtensionsConfig=d;class p{constructor(e){this.loaded=!1,this.state={actions:[],actionMapping:[],categoryInfos:[],bylines:{},featureFlags:{},sharingServiceInfo:{},cloudDocsInfo:{openWithGddSupported:!1},actionIdToAppAction:{},appActionsEnabled:!1,categoryMapsByExt:{},openMenuSurveyEnabled:!1,shareMenuSurveyEnabled:!1},this.client=e}getActionsForFile(e,t){return n.__awaiter(this,void 0,void 0,(function*(){return(yield this.getActionsForFileBatch([e],t))[e.file_id]||u()}))}getActionsForFileBatch(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const n=yield this.loadState(t);return this.getExtensionsConfigsForFiles(n,e)}))}getFeatureFlags(){return this.state.featureFlags}updateLinkStateForAction(e,t){const n=this.state.actions;for(const s of n)s.id===e&&(s.link_state=t);this.state=Object.assign(Object.assign({},this.state),{actions:n})}loadState(e){return n.__awaiter(this,void 0,void 0,(function*(){if(!this.loaded){this.stateRequest||(this.stateRequest=this.fetchActions(e));const t=this.stateRequest;try{this.state=yield this.stateRequest}catch(e){this.stateRequest===t&&(this.stateRequest=void 0)}}return this.state}))}getExtensionsConfigsForFiles(e,t){const n={};return t.forEach(t=>{n[t.file_id]=d(e.appActionsEnabled&&!t.is_dir?c.ENABLED:c.DISABLED)}),n}fetchActions(e){return n.__awaiter(this,void 0,void 0,(function*(){try{const t=this.client.ns("app_actions").rpc("get_actions_for_user",{include_cloud_editors:!0,include_unlinked_ga_extensions:!0},{subjectUserId:e.id}),[n,s,o]=yield Promise.all([t,this.refreshSharingServiceInfo(e.id),this.getCloudDocsInfo(e)]),a=(function(e){const t={};e.actions.forEach(e=>{!t[e.id]&&e.app_id&&(t[e.id]=e)});const n={};e.action_mapping.forEach(e=>{const s=e.matcher;if("extension"!==s[".tag"])return;const i=s.extension,o=new Map;e.action_ids.forEach(e=>{const n=t[e];let s=o.get(n.category);s?s.push(n.id):(s=[n.id],o.set(n.category,s))}),n[i]=o});const s={};e.bylines.forEach(e=>{let t=e.extension_id[".tag"];l(e.extension_id)&&(t=e.extension_id.app_id),s[t]=e.byline});const o=i.parseFeatureFlags(e.stormcrow_assignments);return{actionIdToAppAction:t,bylines:s,categoryMapsByExt:n,featureFlags:o}})(n);return this.loaded=!0,{actions:n.actions,actionMapping:n.action_mapping,categoryInfos:n.category_infos,bylines:a.bylines,featureFlags:a.featureFlags,sharingServiceInfo:s,cloudDocsInfo:o,appActionsEnabled:!0,actionIdToAppAction:a.actionIdToAppAction,categoryMapsByExt:a.categoryMapsByExt,openMenuSurveyEnabled:!1,shareMenuSurveyEnabled:!1}}catch(e){if(e.error&&"feature_gated"===e.error[".tag"])return this.loaded=!0,this.state;throw e}}))}fetchMenuSurveyEnabledState(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=yield r.getTooltipHistory(e,["realign_open_menu_survey","realign_share_menu_survey"]);return{openMenuSurveyEnabled:!t.realign_open_menu_survey,shareMenuSurveyEnabled:!t.realign_share_menu_survey}}))}setOpenMenuSurveyViewed(e){return n.__awaiter(this,void 0,void 0,(function*(){return r.markTooltipViewed(e,"realign_open_menu_survey")}))}setShareMenuSurveyViewed(e){return n.__awaiter(this,void 0,void 0,(function*(){return r.markTooltipViewed(e,"realign_share_menu_survey")}))}getCloudDocsInfo(e){return n.__awaiter(this,void 0,void 0,(function*(){const t={openWithGddSupported:!1};if(e.is_team)try{const n=yield o.getTeamSettings(e.id);t.openWithGddSupported=n.settings[a.CloudDocProviderIntegration.GDD_INTEGRATION][".tag"]===a.IntegrationCreateAndEdit[".tag"]}catch(e){t.openWithGddSupported=!1}else t.openWithGddSupported=!0;return t}))}getSharingServiceInfo(){return Object.assign({},this.state.sharingServiceInfo)}getActions(){return this.state.actions}getActionMapping(){return this.state.actionMapping}getBylines(){return this.state.bylines}getCategoryInfos(){return this.state.categoryInfos}getCloudDocsInfoState(){return this.state.cloudDocsInfo}refreshSharingServiceInfo(e){return n.__awaiter(this,void 0,void 0,(function*(){if(void 0!==this.sharingServiceReq)return this.sharingServiceReq;try{const t=yield this.client.ns("profile_services").rpc("list_services",void 0,{subjectUserId:e}),n={};return t.services.forEach(e=>{const t=e.service_type[".tag"];n[t]=e}),this.state=Object.assign(Object.assign({},this.state),{sharingServiceInfo:n}),n}catch(e){return this.sharingServiceReq=void 0,{}}}))}}let m;t.Client=p,t.getExtensionsClient=function(){return m||(m=new p(new s.UserApiV2Client)),m}})),define("metaserver/static/js/modules/clean/react/extensions/file",["require","exports","metaserver/static/js/modules/clean/filepath/filepath"],(function(e,t,n){"use strict";function s(e){return void 0!==e.ext}function i(e){return void 0!==e.fq_path}function o(e){return void 0!==e.filename}Object.defineProperty(t,"__esModule",{value:!0}),t.isCloudDoc=t.isInVaultFolder=t.getFileExt=t.hasFilename=t.hasFqPath=t.hasExt=void 0,t.hasExt=s,t.hasFqPath=i,t.hasFilename=o,t.getFileExt=function(e){return s(e)?e.ext:i(e)?"."+n.file_extension(n.filename(e.fq_path)):o(e)?"."+n.file_extension(e.filename):void 0},t.isInVaultFolder=function(e){return!!e.is_in_vault_folder},t.isCloudDoc=function(e){return!!e.is_cloud_doc}})),define("metaserver/static/js/modules/clean/react/extensions/feature_flags",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFeatureFlags=void 0;const n={testFlag:"test_gated_feature",appDirectory:"app_directory",hellosignDeepIntegration:"hellosign_deep_integration_sidebar",spacesPaperSwsFssDropdown:"spaces_paper_sws_fss_dropdown",dndSplitShare:"dnd_phase1_exp6_split_share",fileTransfersAppAction:"file_transfers_app_action",docsendAnalyticsAddOn:"docsend_analytics_add_on",flowsConvertAndShareUi:"flows_convert_and_share_ui",btSendForSignatureNaming:"bt_send_for_signature_naming"};t.parseFeatureFlags=function(e){const t={};return(function(){const e=[];for(const t in n)if(n.hasOwnProperty(t)){const s=t;e.push([s,n[s]])}return e})().forEach(([n,s])=>{const i=e[s];void 0!==i&&(t[n]=i)}),t}})),define("metaserver/static/js/modules/clean/react/extensions/tooltips",["require","exports","metaserver/static/js/modules/core/i18n"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EduTooltipExperiment=t.allowedTooltips=t.tooltipFromName=void 0,t.tooltipFromName=function(e){switch(e){case"open_with_edu":case"split_share_edu":case"edit_experiment_image":case"edit_experiment_pdf":case"upload_intercept_image":case"upload_intercept_pdf":case"desktop_notification":case"realign_open_menu_survey":case"realign_share_menu_survey":case"other":return{".tag":e}}};const s={open_with_edu:({hasExtensions:e})=>e,split_share_edu:()=>!1,upload_intercept_image:()=>!1,upload_intercept_pdf:()=>!1,edit_experiment_pdf:()=>!1,edit_experiment_image:()=>!1,desktop_notification:()=>!1,realign_open_menu_survey:({hasExtensions:e})=>e,realign_share_menu_survey:({hasExtensions:e})=>e,other:()=>!1},i=["open_with_edu","desktop_notification","realign_open_menu_survey","realign_share_menu_survey"];t.allowedTooltips=function(e,t,n){return i.filter(i=>s[i]({hasExtensions:e,fileExt:t,featureFlags:n}))},(function(e){e.TOOLTIP_CONFIGS={open_with_edu:{tooltipTitle:n.intl.formatMessage({id:"VopzGG",defaultMessage:"Do more with your files"}),tooltipMessage:n.intl.formatMessage({id:"1vlc0Q",defaultMessage:"Work on this file in other apps. Updates you make will automatically save back to Dropbox."})}},e.EDU_SPLIT_SHARE_MAP={CONTROL:{tooltipTitle:n.intl.formatMessage({id:"v7foBc",defaultMessage:"Extend the power of Dropbox"}),tooltipMessage:n.intl.formatMessage({id:"VKi3Pj",defaultMessage:"Now you can send files to Slack or present in Zoom without leaving Dropbox."})}}})(t.EduTooltipExperiment||(t.EduTooltipExperiment={}))})),define("metaserver/static/js/modules/clean/react/extensions/data/action_creators",["require","exports","tslib","metaserver/static/js/modules/clean/react/extensions/client","metaserver/static/js/modules/clean/react/extensions/data/types","metaserver/static/js/modules/clean/integrations/data/actions"],(function(e,t,n,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setShareMenuSurveyEnabledState=t.setOpenMenuSurveyEnabledState=t.setCloudDocsInfoState=t.updateExtensionsState=t.refreshSharingServiceInfoAdapter=t.refreshSharingServiceInfo=t.setShareMenuSurveyViewed=t.setOpenMenuSurveyViewed=t.updateLinkState=t.setExtensionsFeatureFlags=t.initializeExtensionsStore=void 0;t.initializeExtensionsStore=({files:e,user:o})=>function(a){return n.__awaiter(this,void 0,void 0,(function*(){const n=yield s.getExtensionsClient().getActionsForFileBatch(e,o),r=s.getExtensionsClient().getFeatureFlags();a(t.setExtensionsFeatureFlags({featureFlags:r}));const l=s.getExtensionsClient().getSharingServiceInfo();a({type:i.ActionTypes.SET_SHARING_SERVICE_INFO_STATE,payload:{sharingServiceInfo:l}}),a({type:i.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES,payload:{fileExtensionsConfigs:n}});const c=s.getExtensionsClient().getActions(),u=s.getExtensionsClient().getActionMapping(),d=s.getExtensionsClient().getBylines(),p=s.getExtensionsClient().getCategoryInfos(),m=s.getExtensionsClient().getCloudDocsInfoState();a(t.updateExtensionsState({actions:c,actionMapping:u,bylines:d,categoryInfos:p})),a(t.setCloudDocsInfoState({cloudDocsInfo:m}))}))};t.setExtensionsFeatureFlags=({featureFlags:e})=>({type:i.ActionTypes.SET_EXTENSIONS_FEATURE_FLAGS,payload:{featureFlags:e}});t.updateLinkState=({actionId:e,linkState:n})=>function(i){const o=s.getExtensionsClient();o.updateLinkStateForAction(e,n);const a=o.getActions(),r=o.getActionMapping(),l=o.getBylines(),c=o.getCategoryInfos();i(t.updateExtensionsState({actions:a,actionMapping:r,bylines:l,categoryInfos:c}))};t.setOpenMenuSurveyViewed=e=>function(n){s.getExtensionsClient().setOpenMenuSurveyViewed(e),n(t.setOpenMenuSurveyEnabledState({openMenuSurveyEnabled:!1}))};t.setShareMenuSurveyViewed=e=>function(n){s.getExtensionsClient().setShareMenuSurveyViewed(e),n(t.setShareMenuSurveyEnabledState({shareMenuSurveyEnabled:!1}))};t.refreshSharingServiceInfo=({user:e,onRefresh:t})=>function(o){return n.__awaiter(this,void 0,void 0,(function*(){const n=s.getExtensionsClient();yield n.refreshSharingServiceInfo(e.id);const a=yield s.getExtensionsClient().getSharingServiceInfo();t&&t(a),o({type:i.ActionTypes.SET_SHARING_SERVICE_INFO_STATE,payload:{sharingServiceInfo:a}})}))},t.refreshSharingServiceInfoAdapter=function({onRefresh:e}){return function(t,n,s){const a=e&&(t=>{"fulfilled"===t.state?e(i.convertToSharingServiceInfo(t.value)):e()});o.fetchListServices(a)(t,n,s)}};t.updateExtensionsState=({actions:e,actionMapping:t,bylines:n,categoryInfos:s})=>({type:i.ActionTypes.UPDATE_EXTENSIONS_STATE,payload:{actions:e,actionMapping:t,bylines:n,categoryInfos:s}});t.setCloudDocsInfoState=({cloudDocsInfo:e})=>({type:i.ActionTypes.SET_CLOUD_DOCS_INFO_STATE,payload:{cloudDocsInfo:e}});t.setOpenMenuSurveyEnabledState=({openMenuSurveyEnabled:e})=>({type:i.ActionTypes.SET_OPEN_MENU_SURVEY_ENABLED_STATE,payload:{openMenuSurveyEnabled:e}});t.setShareMenuSurveyEnabledState=({shareMenuSurveyEnabled:e})=>({type:i.ActionTypes.SET_SHARE_MENU_SURVEY_ENABLED_STATE,payload:{shareMenuSurveyEnabled:e}})})),define("metaserver/static/js/modules/clean/react/extensions/data/reducer",["require","exports","metaserver/static/js/modules/clean/react/extensions/data/types"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extensionsReducer=t.defaultExtensionsState=void 0,t.defaultExtensionsState={actionMapping:[],actions:[],categoryInfos:[],bylines:{},featureFlags:{},fileExtensionsConfigs:{},sharingServiceInfo:{},cloudDocsInfo:{openWithGddSupported:!1},openMenuSurveyEnabled:!1,shareMenuSurveyEnabled:!1};t.extensionsReducer=function(e=t.defaultExtensionsState,s){switch(s.type){case n.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES:return((e,t)=>{const{fileExtensionsConfigs:n}=t.payload;return Object.assign(Object.assign({},e),{fileExtensionsConfigs:Object.assign(Object.assign({},e.fileExtensionsConfigs),n)})})(e,s);case n.ActionTypes.SET_EXTENSIONS_FEATURE_FLAGS:return((e,t)=>{const{featureFlags:n}=t.payload;return Object.assign(Object.assign({},e),{featureFlags:n})})(e,s);case n.ActionTypes.SET_SHARING_SERVICE_INFO_STATE:return((e,t)=>{const{sharingServiceInfo:n}=t.payload;return Object.assign(Object.assign({},e),{sharingServiceInfo:n})})(e,s);case n.ActionTypes.UPDATE_EXTENSIONS_STATE:return((e,t)=>Object.assign(Object.assign({},e),t.payload))(e,s);case n.ActionTypes.SET_CLOUD_DOCS_INFO_STATE:return((e,t)=>{const{cloudDocsInfo:n}=t.payload;return Object.assign(Object.assign({},e),{cloudDocsInfo:n})})(e,s);case n.ActionTypes.SET_OPEN_MENU_SURVEY_ENABLED_STATE:return((e,t)=>{const{openMenuSurveyEnabled:n}=t.payload;return Object.assign(Object.assign({},e),{openMenuSurveyEnabled:n})})(e,s);case n.ActionTypes.SET_SHARE_MENU_SURVEY_ENABLED_STATE:return((e,t)=>{const{shareMenuSurveyEnabled:n}=t.payload;return Object.assign(Object.assign({},e),{shareMenuSurveyEnabled:n})})(e,s)}return e}})),define("metaserver/static/js/modules/clean/react/extensions/data/selectors",["require","exports","metaserver/static/js/redux/namespaces","metaserver/static/js/redux/selectors","metaserver/static/js/modules/clean/react/extensions/data/reducer","metaserver/static/js/modules/clean/react/extensions/client","metaserver/static/js/modules/clean/integrations/data/selectors","metaserver/static/js/modules/clean/react/extensions/data/types","metaserver/static/js/modules/clean/react/extensions/file"],(function(e,t,n,s,i,o,a,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isShareAction=t.getNonHellosignActionsForFiles=t.getOpenActionsForFile=t.getShareActionsForFiles=t.getFirstPartyActionIds=t.getActionsForFiles=t.getShareMenuSurveyEnabled=t.getOpenMenuSurveyEnabled=t.getCategoryInfos=t.getBylines=t.getActions=t.getCloudDocInfo=t.getSharingServiceInfoAdapter=t.sharingServiceInfo=t.extensionsEnabledForFile=t.getFeatureFlags=t.fileExtensionsConfigs=t.getExtensionsState=void 0;t.getExtensionsState=e=>s.getStateAtNamespace(e,n.EXTENSIONS_NAMESPACE_KEY)||i.defaultExtensionsState;t.fileExtensionsConfigs=e=>t.getExtensionsState(e).fileExtensionsConfigs;t.getFeatureFlags=e=>t.getExtensionsState(e).featureFlags,t.extensionsEnabledForFile=function(e,n){return(function(e,n){return t.getExtensionsState(e).fileExtensionsConfigs[n]||o.emptyExtensionsConfig()})(e,n.file_id).displayState!==o.DisplayState.DISABLED};t.sharingServiceInfo=e=>t.getExtensionsState(e).sharingServiceInfo;t.getSharingServiceInfoAdapter=e=>{const t=a.getListServicesInfo(e).latestListServicesResult;return t&&r.convertToSharingServiceInfo(t)};t.getCloudDocInfo=e=>t.getExtensionsState(e).cloudDocsInfo;t.getActions=e=>t.getExtensionsState(e).actions;t.getBylines=e=>t.getExtensionsState(e).bylines;t.getCategoryInfos=e=>t.getExtensionsState(e).categoryInfos;t.getOpenMenuSurveyEnabled=e=>t.getExtensionsState(e).openMenuSurveyEnabled;function c(e,t){return!(e.length>1&&!t.multiselect_enabled)&&e.every(e=>(function(e,t){return void 0===t.filters||t.filters.every(t=>"matcher_any"===t[".tag"]&&!!t.matcher_any.some(t=>{if("extension"===t[".tag"]){const n=l.getFileExt(e);return t.extension===n}return"max_size_bytes"===t[".tag"]?e.bytes<=t.max_size_bytes:"is_file"===t[".tag"]?e.is_dir!==t.is_file:"is_cloud_doc"!==t[".tag"]||l.isCloudDoc(e)===t.is_cloud_doc}))})(e,t))}function u(e){var t;const n=e.is_dir,s=l.isInVaultFolder(e),i=null===(t=e.per_node_metadata)||void 0===t?void 0:t.link_node;return!(n||s||i)}function d(e){const t=e.per_node_metadata;return!(l.isInVaultFolder(e)||(null==t?void 0:t.link_node)||(null==t?void 0:t.suppress_ns_partition)||(null==t?void 0:t.suppress_shared_link))}function p(e,n){return(function(e,t){return e.every(u)?t.filter(t=>c(e,t)):[]})(n,t.getActions(e))}function m(e,t){return t.every(d)?p(e,t).filter(e=>_(e)):[]}function _(e){return"share_menu"===e.menu_alignment[".tag"]}t.getShareMenuSurveyEnabled=e=>t.getExtensionsState(e).shareMenuSurveyEnabled,t.getActionsForFiles=p,t.getFirstPartyActionIds=function(e,t){return p(e,[t]).map(e=>e.id).filter(e=>e.startsWith("fp_action_id:"))},t.getShareActionsForFiles=m,t.getOpenActionsForFile=function(e,t){return p(e,[t]).filter(e=>!_(e))},t.getNonHellosignActionsForFiles=function(e,t,n){return m(e,t).filter(e=>e.app_id!==n)},t.isShareAction=_})),define("metaserver/static/js/modules/clean/react/extensions/data/store",["require","exports","tslib","lodash","metaserver/static/js/modules/clean/react/extensions/data/action_creators","metaserver/static/js/redux/store","metaserver/static/js/redux/namespaces","metaserver/static/js/modules/clean/react/extensions/data/reducer","metaserver/static/js/modules/clean/integrations/data/store"],(function(e,t,n,s,i,o,a,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeStore=t.getStore=void 0,s=n.__importStar(s),t.getStore=s.once(()=>(l.registerReducersForIntegration(),o.getStoreAndRegisterReducers({[a.EXTENSIONS_NAMESPACE_KEY]:r.extensionsReducer}))),t.initializeStore=function(e,n){const s=t.getStore();return l.initStoreForIntegration(e.id),n&&s.dispatch(i.initializeExtensionsStore({user:e,files:n})),s}})),define("metaserver/static/js/modules/clean/react/extensions/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertToSharingServiceInfo=t.TriggerType=t.ActionTypes=void 0,(function(e){e.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES="EXTENSIONS/UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES",e.SET_EXTENSIONS_FEATURE_FLAGS="EXTENSIONS/SET_EXTENSIONS_FEATURE_FLAGS",e.UPDATE_LINK_STATE="EXTENSIONS/UPDATE_LINK_STATE",e.SET_SHARING_SERVICE_INFO_STATE="EXTENSIONS/SET_SHARING_SERVICE_INFO_STATE",e.UPDATE_EXTENSIONS_STATE="EXTENSIONS/UPDATE_EXTENSIONS_STATE",e.SET_CLOUD_DOCS_INFO_STATE="EXTENSIONS/SET_CLOUD_DOCS_INFO_STATE",e.SET_OPEN_MENU_SURVEY_ENABLED_STATE="EXTENSIONS/SET_OPEN_MENU_SURVEY_ENABLED_STATE",e.SET_SHARE_MENU_SURVEY_ENABLED_STATE="EXTENSIONS/SET_SHARE_MENU_SURVEY_ENABLED_STATE"})(t.ActionTypes||(t.ActionTypes={})),(function(e){e.PrimaryButton="primary_button",e.SecondaryButton="secondary_button",e.SidebarPrimaryButton="sidebar_primary_button",e.CollapsedButton="collapsed_button",e.OpacityButton="opacity_button"})(t.TriggerType||(t.TriggerType={})),t.convertToSharingServiceInfo=function(e){try{const t={};return e.services.forEach(e=>{const n=e.service_type[".tag"];t[n]=e}),t}catch(e){}return{}}})),define("metaserver/static/js/modules/clean/react/extensions/apis",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/modules/clean/react/extensions/tooltips"],(function(e,t,n,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.markAppSurveyShown=t.hasUserSeenSurveyForApp=t.markTooltipViewed=t.getTooltipHistory=void 0,t.getTooltipHistory=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const n=new s.UserApiV2Client;try{const s=t.map(e=>i.tooltipFromName(e)),o=yield n.ns("extensions").rpc("get_extensions_tooltip_history_v2",{tooltips:s},{subjectUserId:e}),a={};return o.view_states.forEach(e=>{a[e.tooltip[".tag"]]=e.viewed}),a}catch(e){const n={};return t.forEach(e=>{n[e]=!0}),n}}))},t.markTooltipViewed=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const n=new s.UserApiV2Client,o=i.tooltipFromName(t);yield n.ns("extensions").rpc("mark_extensions_tooltip_viewed",{tooltip:o},{subjectUserId:e})}))},t.hasUserSeenSurveyForApp=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const n=new s.UserApiV2Client;return(yield n.ns("extensions").rpc("get_extension_survey_history",{app_id:t},{subjectUserId:e})).survey_shown}))},t.markAppSurveyShown=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const n=new s.UserApiV2Client;yield n.ns("extensions").rpc("mark_extension_survey_shown",{app_id:t},{subjectUserId:e})}))}}));
//# sourceMappingURL=pkg-fvsdk-other.min.js-vfl0gm5nJ.map