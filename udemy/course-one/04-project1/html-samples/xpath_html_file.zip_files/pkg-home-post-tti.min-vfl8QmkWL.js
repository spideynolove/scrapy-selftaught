define("metaserver/static/js/cloud_docs/home_create_file_experiments_post_tti",["require","exports","tslib","react","metaserver/static/js/cloud_docs/constants","metaserver/static/js/new_file_menu/new_file_menu","metaserver/static/js/browse/constants","metaserver/static/js/home/modals/async_home_modals","metaserver/static/js/home/store","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/constants"],(function(e,t,s,i,o,r,n,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewFileMenu=t.getCloudDocsExperiments=void 0,i=s.__importDefault(i),t.getCloudDocsExperiments=function(){return{expGddCreate:!1,expPaperCreate:!1,expBinderCreate:!1}};const m=(e,t)=>i=>s.__awaiter(void 0,void 0,void 0,(function*(){a.asyncShowNewFolderModal({user:e,initialPath:i,origin:n.CREATE_FOLDER_ACTION_ORIGIN_TYPE.HOME_CREATE_FILE_MODAL,redirectOnClose:t})})),u=e=>{c.homeActivityLogger.logClickRightMenu(d.LoggingTypes.CLICK_CREATE_NEW_FILE,{display_type:e})};t.getNewFileMenu=function(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.cloudDocsExperiments.expGddCreate,s=e.cloudDocsExperiments.expPaperCreate,n=e.cloudDocsExperiments.expBinderCreate,a=()=>i.default.createElement(r.NewFileMenu,{key:"new-file-menu",user:l.getUser(),disabled:!1,showGdd:t,showPaper:s,showBinder:n,source:o.NewFileMenuFromType.HOME,handleClickNewFolder:m,logClickEvent:u});return new Promise((e,t)=>{e(a)})}))}})),define("metaserver/static/js/home/content_suggestions/actions",["require","exports","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/content_suggestions/constants"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedActions=void 0,t.SuggestedActions={dispatchLoaded(e){s.Dispatcher.dispatch({type:i.SuggestedResourceActionTypes.LOAD_SUCCESS,items:e})}}})),define("metaserver/static/js/home/content_suggestions/actions_post_tti",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/content_suggestions/constants","metaserver/static/js/starred/id_type_pair","metaserver/static/js/content_suggestions/api","metaserver/static/js/home/content_suggestions/actions","metaserver/static/js/home/resource/api_post_tti","metaserver/static/js/home/resource_id_types","metaserver/static/js/home/store","metaserver/static/js/home/constants","metaserver/static/js/display_types/constants","metaserver/static/js/modules/clean/navigation","metaserver/static/js/content_suggestions/constants","metaserver/static/js/home/resource/actions_post_tti","metaserver/static/js/modules/clean/browse_uri_interface"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openSuggestedParentOnHome=t.openSuggestedItemOnHome=t.fetchSuggestedFileMetadata=t.loadItems=t.dismissSuggestedItem=void 0,t.dismissSuggestedItem=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){try{yield n.trackDismissSuggestedItemFromIdTypePair(e,t,"home"),i.Dispatcher.dispatch({type:o.SuggestedResourceActionTypes.DISMISS_ITEM_SUCCESS,dismissed:t})}catch(e){i.Dispatcher.dispatch({type:o.SuggestedResourceActionTypes.DISMISS_ITEM_FAILURE,dismissed:t})}}))},t.loadItems=function(e,t,r){return s.__awaiter(this,void 0,void 0,(function*(){try{const s=yield n.getSuggested(e,r,"home",t,void 0),l=n.handlePayload(s);"ERROR"!==l?a.SuggestedActions.dispatchLoaded(l.items):i.Dispatcher.dispatch({type:o.SuggestedResourceActionTypes.LOAD_FAILURE})}catch(e){i.Dispatcher.dispatch({type:o.SuggestedResourceActionTypes.LOAD_FAILURE})}}))},t.fetchSuggestedFileMetadata=function(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.map(e=>({id:e.resourceId,type:c.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID})),s=yield l.getFileMetadata(d.getUser(),t),o={};s.forEach(e=>o[r.idTypePairToString(e)]=e.file_metadata),i.Dispatcher.dispatch({type:m.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:o})}))};t.openSuggestedItemOnHome=(e,t,s)=>{if(s){const s=e.displayType===u.EXTERNAL_RESOURCE_TYPE?p.NavigationMethod.UNSAFE_NEW_TAB:p.NavigationMethod.NEW_TAB;p.logAndNavigate(e.url,t,s)}else h.PreviewableDisplayTypes.includes(e.displayType)?_.openInFileViewer("ENCODED_FILE_OBJ_ID:"+e.encodedFileObjId,t):p.logAndNavigate(e.url,t,p.NavigationMethod.REDIRECT)};t.openSuggestedParentOnHome=(e,t,s)=>{const i=d.getHomeStore().getUser(),o=e.breadcrumb.length?e.breadcrumb[0]:null,r=o?o.url:g.browse_uri_for_fq_path(i,"").toString();if(r){const e=s?p.NavigationMethod.NEW_TAB:p.NavigationMethod.REDIRECT;p.logAndNavigate(r,t,e)}}})),define("metaserver/static/js/home/content_suggestions/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingTypes=t.SUGGEST_REASONS=t.SuggestedResourceActionTypes=void 0,(function(e){e.LOAD_SUCCESS="HOME_SUGGESTED_LOAD_SUCCESS",e.LOAD_FAILURE="HOME_SUGGESTED_LOAD_FAILURE",e.DISMISS_ITEM_SUCCESS="HOME_SUGGESTED_DISMISS_ITEM_SUCCESS",e.DISMISS_ITEM_FAILURE="HOME_SUGGESTED_DISMISS_ITEM_FAILURE"})(t.SuggestedResourceActionTypes||(t.SuggestedResourceActionTypes={})),(function(e){e.UNKNOWN="UNKNOWN",e.RECENCY="RECENCY",e.FRECENCY="FRECENCY",e.WEEKLY_PERIODICITY="WEEKLY_PERIODICITY",e.EVENT_COUNT="EVENT_COUNT",e.EDIT_COUNT="EDIT_COUNT",e.VIEW_COUNT="VIEW_COUNT",e.PREDICTION="PREDICTION",e.PREDICTION_VIEW="PREDICTION_VIEW",e.PREDICTION_EDIT="PREDICTION_EDIT",e.PREDICTION_SHARE="PREDICTION_SHARE",e.WEEKLY_FRECENCY="WEEKLY_FRECENCY",e.DIR_WEEKLY_FRECENCY="DIR_WEEKLY_FRECENCY",e.RECENT_SHARE="RECENT_SHARE"})(t.SUGGEST_REASONS||(t.SUGGEST_REASONS={})),t.LoggingTypes={OPEN_SUGGESTED_ITEM:"open_suggested_item",OPEN_PARENT_FOLDER:"open_parent_folder",RENDERED_SUGGESTED_ITEM:"rendered_suggested_item",CLICK_ADD_TO_STARRED:"click_add_to_starred",CLICK_DISMISS_SUGGESTED_ITEM:"click_dismiss_suggested_item",CANCEL_DISMISS_SUGGESTED_ITEM:"cancel_dismiss_suggested_item",DISMISS_SUGGESTED_ITEM:"dismiss_suggested_item",LIKE_SUGGESTED_ITEM:"like_suggested_item",SUGGESTED_SECTION_SHOWN:"suggested_section_shown",THUMBNAIL_LOADED:"thumbnail_loaded",THUMBNAIL_ERROR:"thumbnail_error",HIDE_SECTION:"hide_section",UNHIDE_SECTION:"unhide_section",CLICK_INFO_ICON:"click_info_icon"}})),define("metaserver/static/js/home/content_suggestions/home_suggest",["require","exports","tslib","react","metaserver/static/js/modules/clean/js_client_stopwatch","metaserver/static/js/home/actions_post_tti","metaserver/static/js/home/content_suggestions/actions_post_tti","metaserver/static/js/home/content_suggestions/suggested_resource_store","metaserver/static/js/home/content_suggestions/util/logging/home_suggest_logger","metaserver/static/js/home/store","metaserver/static/js/files_view/contexts/file_thumb_store","metaserver/static/js/home/constants","metaserver/static/js/content_suggestions/suggest_loading","metaserver/static/js/content_suggestions/suggest_empty","metaserver/static/js/content_suggestions/grid_layout","metaserver/static/js/content_suggestions/suggest_frame","metaserver/static/js/content_suggestions/suggest_nonempty","metaserver/static/js/content_suggestions/models/suggested_item"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h,_,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=t.HomeSuggest=t.initPrefetch=void 0,i=s.__importDefault(i);t.initPrefetch=()=>{};class v extends i.default.PureComponent{constructor(e){super(e),this.numItemsLastLogged=0,this.onStoreUpdate=()=>this.setState(this.getStateFromStore()),this.onChangeSuggestVisibility=()=>{const e=!this.props.isHiddenByUser;r.setSectionVisibilityPostTTI(c.getUserId(),{".tag":"suggest"},!e),l.homeSuggestLogger.logShowHideSection(e)},this.handleDismissSuggestedItem=(e,t)=>{const s=f.suggestedItemToIdTypePair(t);return n.dismissSuggestedItem(e,s)},this.removeSuggestionFromUi=e=>()=>{e.isDismissed&&this.setState({dismissedSuggestionKeys:[...this.state.dismissedSuggestionKeys,e.key]})},this.store=a.getSuggestedResourceStore(e.homeAvailabilityLogger),this.featureVariant=this.store.getFeatureVariant(),this.removeStoreListener=this.store.addListener(this.onStoreUpdate),this.state=Object.assign(Object.assign({},this.getStateFromStore()),{dismissedSuggestionKeys:[]}),this.loggedItems={},o.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging")}getStateFromStore(){const e=this.store.getItems();return{loadingState:this.store.getLoadingState(),suggested:e}}UNSAFE_componentWillMount(){const e=c.getHomeStore().getUser();this.store.getLoadingState()===m.LoadingStates.FAILURE&&n.loadItems(e,this.featureVariant,10)}componentWillUnmount(){this.removeStoreListener&&this.removeStoreListener()}renderSuggestContainer(){const{containerWidth:e,isHiddenByUser:t}=this.props;if(t)return null;const{itemsToShow:s,tileWidth:o}=h.getLayout(e),r=this.state.suggested.filter(e=>!this.state.dismissedSuggestionKeys.includes(e.key)).slice(0,s),a=r.filter(e=>!e.isDismissed).length;if(this.state.loadingState!==m.LoadingStates.SUCCESS&&0===a)return i.default.createElement(u.SuggestLoadingInner,{isHiddenByUser:t,itemsToShow:s,tileWidth:o});if(0===s||0===a)return i.default.createElement(p.SuggestEmpty,null);if(this.numItemsLastLogged!==s){const e=[];r.forEach(t=>{this.loggedItems[t.resourceId]||(e.push(t),this.loggedItems[t.resourceId]=!0)}),l.homeSuggestLogger.logRenderedSuggestedItems(e),l.homeSuggestLogger.logSuggestedShown(r.length,this.featureVariant,s),this.numItemsLastLogged=s}return i.default.createElement(g.SuggestNonEmpty,{source:"home",logger:l.homeSuggestLogger,user:c.getHomeStore().getUser(),dismissSuggestedItem:this.handleDismissSuggestedItem,removeSuggestionFromUi:this.removeSuggestionFromUi,tileWidth:o,suggestedItemsToShow:r,openSuggestedItem:n.openSuggestedItemOnHome,openSuggestedParent:n.openSuggestedParentOnHome})}render(){const{canRenderItems:e,isHiddenByUser:t}=this.props;return e?i.default.createElement(d.ThumbStoreProvider,{shouldPrewarm:!0,path:"suggest"},i.default.createElement(_.SuggestFrame,{isHiddenByUser:t},i.default.createElement(_.SuggestHeader,{isHiddenByUser:t,buttonAction:this.onChangeSuggestVisibility}),this.renderSuggestContainer())):null}}t.HomeSuggest=v,v.displayName="HomeSuggest";t.RootComponent=e=>i.default.createElement(v,Object.assign({},e))})),define("metaserver/static/js/home/content_suggestions/logger_api",["require","exports","tslib","lodash","metaserver/static/js/modules/core/exception","metaserver/static/js/modules/clean/web_timing_logger","metaserver/static/js/home/api"],(function(e,t,s,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logHomeActivity=void 0,i=s.__importStar(i),n=s.__importStar(n);let a={},l={};const c=(e,t,s)=>{n.makeRequest({url:s,type:"POST",data:{role:t,activities_json:JSON.stringify(i.map(e,"json")),send_ts:Date.now(),page_start_ts:window.performance&&window.performance.timing?window.performance.timing.navigationStart||window.performance.timing.fetchStart:void 0}},{isBackground:!0,delayRequest:!0}).then(()=>e.forEach(e=>e.resolve()),()=>e.forEach(e=>e.reject()))},d=i.throttle(()=>{i.size(a)>1&&o.reportStack("Multiple role activities",{severity:o.SEVERITY.NONCRITICAL,exc_extra:a}),Object.keys(a).forEach(e=>{const t=a[e];c(t,e,"/home_feed/log_activities")}),a={},Object.keys(l).forEach(e=>{const t=l[e];c(t,e,"/home_feed/log_suggested_activities")}),l={}},1e3,{leading:!0,trailing:!0});t.logHomeActivity=({role:e,eventName:t,extra:n,suggestId:c,table:m})=>new Promise((u,p)=>s.__awaiter(void 0,void 0,void 0,(function*(){m||(m="home_activity");const h={json:{event_name:t,event_time:Date.now(),extra:i.mapValues(n||{},e=>String(e))},resolve:u,reject:p};switch(m){case"home_activity":a[e]=a[e]||[],a[e].push(h);break;case"home_suggest":{a[e]=a[e]||[];const{json:t}=h,i=s.__rest(h,["json"]),o=Object.assign({json:Object.assign({},t)},i);a[e].push(o),h.json.suggest_id=c,l[e]=l[e]||[],l[e].push(h);break}default:return void o.reportStack("Unknown logging table specified",{severity:o.SEVERITY.NONCRITICAL,exc_extra:{table:m,role:e,eventName:t,extra:n,suggestId:c}})}yield r.waitForTTI(),d()})))})),define("metaserver/static/js/home/content_suggestions/suggested_resource_store",["require","exports","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/flux/flux_store","metaserver/static/js/home/content_suggestions/constants","metaserver/static/js/home/content_suggestions/actions","metaserver/static/js/content_suggestions/api","metaserver/static/js/home/content_suggestions/actions_post_tti","metaserver/static/js/home/store"],(function(e,t,s,i,o,r,n,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSuggestedResourceStore=t.PrivateSuggestedResourceStoreClass=void 0;class d extends o.FluxStore{constructor(e){super(s.Dispatcher),this.items=[],this.loadingState=i.LoadingStates.LOADING;let t=!1;e.handlePrefetch(i.HomePrefetchTypes.GET_SUGGESTED,e=>{const i=a.handlePayload(e);if("ERROR"!==i){const{items:e,modelVariant:s}=i;this.usedVariant=s,t?n.SuggestedActions.dispatchLoaded(e):this.onItemsLoadSuccess(e)}else t?s.Dispatcher.dispatch({type:r.SuggestedResourceActionTypes.LOAD_FAILURE}):this.onItemsLoadFailure()}),t=!0}getItems(){return this.items}getLoadingState(){return this.loadingState}getFeatureVariant(){if(!this.featureVariant){const e=c.getHomeStore().getActiveVariant(i.SUGGEST_GRID_FEATURE).toLowerCase();this.featureVariant=i.SUGGEST_GRID_FEATURE+":"+e}return this.featureVariant}getUsedVariant(){return this.usedVariant}onItemsLoadSuccess(e){this.items=e,this.loadingState=i.LoadingStates.SUCCESS,e&&l.fetchSuggestedFileMetadata(e)}onItemsLoadFailure(){this.loadingState=i.LoadingStates.FAILURE}onDismissItemSuccess(e){this.loadingState=i.LoadingStates.LOADING,this.items=this.items.map(t=>"ENCODED_FILE_OBJ_ID"===e.type&&t.encodedFileObjId===e.id||"FQ_PATH"===e.type&&t.fqPath===e.id?Object.assign(Object.assign({},t),{isDismissed:!0}):t),this.loadingState=i.LoadingStates.SUCCESS}onDismissItemFailure(e){this.loadingState=i.LoadingStates.LOADING,this.items=this.items.map(t=>"ENCODED_FILE_OBJ_ID"===e.type&&t.encodedFileObjId===e.id||"FQ_PATH"===e.type&&t.fqPath===e.id?Object.assign(Object.assign({},t),{isDismissed:!1}):t),this.loadingState=i.LoadingStates.SUCCESS}__onDispatch(e){const t=e.action;switch(t.type){case r.SuggestedResourceActionTypes.LOAD_SUCCESS:this.onItemsLoadSuccess(t.items),this.__emitChange();break;case r.SuggestedResourceActionTypes.LOAD_FAILURE:this.onItemsLoadFailure(),this.__emitChange();break;case r.SuggestedResourceActionTypes.DISMISS_ITEM_SUCCESS:this.onDismissItemSuccess(t.dismissed),this.__emitChange();break;case r.SuggestedResourceActionTypes.DISMISS_ITEM_FAILURE:this.onDismissItemFailure(t.dismissed),this.__emitChange()}}}t.PrivateSuggestedResourceStoreClass=d;let m=null;t.getSuggestedResourceStore=function(e){return null===m&&(m=new d(e)),m}})),define("metaserver/static/js/home/content_suggestions/util/logging/home_suggest_logger",["require","exports","tslib","lodash","metaserver/static/js/home/content_suggestions/logger_api","metaserver/static/js/home/store","metaserver/static/js/home/constants","metaserver/static/js/home/content_suggestions/constants"],(function(e,t,s,i,o,r,n,a){"use strict";function l(e){return`home_${e}`}Object.defineProperty(t,"__esModule",{value:!0}),t.homeSuggestLogger=t.HomeSuggestLogger=t.withHomePrefix=void 0,i=s.__importStar(i),t.withHomePrefix=l;class c{constructor(){this.homeSection=n.HomeSections.SUGGEST,this.loggingSource=l(this.homeSection)}logOpenSuggestedItem(e,t,s,i="home"){return o.logHomeActivity({eventName:a.LoggingTypes.OPEN_SUGGESTED_ITEM,role:r.getHomeStore().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:s,clickOrigin:t,source:this.loggingSource,isDir:e.isDir}})}logOpenParentFolder(e,t,s,i="home"){return o.logHomeActivity({eventName:a.LoggingTypes.OPEN_PARENT_FOLDER,role:r.getHomeStore().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:s,clickOrigin:t,source:this.loggingSource,isDir:e.isDir}})}logClickDismissSuggestedItem(e,t,s,i="home"){o.logHomeActivity({eventName:a.LoggingTypes.CLICK_DISMISS_SUGGESTED_ITEM,role:r.getHomeStore().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:s,clickOrigin:t,source:this.loggingSource,isDir:e.isDir}})}logDismissSuggestedItem(e,t,s,i,n="home"){o.logHomeActivity({eventName:a.LoggingTypes.DISMISS_SUGGESTED_ITEM,role:r.getHomeStore().getRole(),suggestId:e.suggestId,table:"home_suggest",extra:{position:s,clickOrigin:t,source:this.loggingSource,reason:i,isDir:e.isDir}})}logSuggestedShown(e,t,s,i="home"){o.logHomeActivity({eventName:a.LoggingTypes.SUGGESTED_SECTION_SHOWN,role:r.getHomeStore().getRole(),table:"home_suggest",extra:{num_items:e,variant:t,items_shown:s}})}logShowHideSection(e,t="home"){o.logHomeActivity({eventName:e?a.LoggingTypes.HIDE_SECTION:a.LoggingTypes.UNHIDE_SECTION,role:r.getHomeStore().getRole(),table:"home_suggest",extra:{section_name:this.homeSection}})}logRenderedSuggestedItems(e,t="home"){const s=r.getHomeStore().getRole(),n=i.map(e,(e,t)=>o.logHomeActivity({eventName:a.LoggingTypes.RENDERED_SUGGESTED_ITEM,role:s,suggestId:e.suggestId,table:"home_suggest",extra:{index:t,isDir:e.isDir}}));Promise.all(n)}}t.HomeSuggestLogger=c,t.homeSuggestLogger=new c})),define("metaserver/static/js/home/modals/new_folder_modal",["require","exports","tslib","react","dig-components/buttons","dig-components/modal","dig-components/typography","metaserver/static/js/modules/clean/browse_uri_interface","metaserver/static/js/file_actions/create-folder","ts-key-enum","metaserver/static/js/logging/hive/schemas/web-modal-activity","metaserver/static/js/browse/actions","metaserver/static/js/folder_dialog/api","metaserver/static/js/components/ui/modal_controller","metaserver/static/js/modules/clean/sharing/cdm_new_folder_modal_components","metaserver/static/js/modules/clean/ux_analytics/utils","metaserver/static/js/modules/clean/viewer","metaserver/static/js/modules/clean/web_modal_activity_logger","metaserver/static/js/modules/clean/web_timing_logger","metaserver/static/js/modules/core/dom","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/history_singleton","metaserver/static/js/folder_dialog/folder_picker_dig"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h,_,g,f,v,y,E,b,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showNewFolderModal=void 0,i=s.__importStar(i),l=s.__importStar(l),v=s.__importStar(v),y=s.__importStar(y);class T extends i.Component{constructor(e){super(e),this.close=()=>{this.logger.log(d.ModalEventName.CLOSE),this.setState({isModalOpen:!1}),_.dispatchModalClosed(),p.unmountModal(this.elementToFocusOnClose instanceof HTMLElement?this.elementToFocusOnClose:void 0)},this.handleFolderSelected=e=>{this.setState({currentPath:e||"/"})},this.handleClickCancel=()=>{this.logger.log(d.ModalEventName.SECONDARY_CLICK),m.browseActions.cancelCreateFolder(this.props.origin),this.props.redirectOnClose&&this.props.redirectOnClose(this.props.initialPath),this.close()},this.handleCreateClick=()=>{this.logger.log(d.ModalEventName.PRIMARY_CLICK,{path:this.state.currentPath}),l.createFolder({destination:this.state.currentPath,name:this.state.currentInputFolderName,user:this.props.user,checkFsw:!0,origin:this.props.origin,surface:"home"}).then(e=>{"success"===e.type?(this.logger.log(d.ModalEventName.SUCCESS),this.props.redirectOnClose?this.props.redirectOnClose(e.folder.path_display):b.browserRedirectWrapper(a.browse_uri_for_fq_path(this.props.user,e.folder.path_display))):this.props.redirectOnClose&&this.props.redirectOnClose(),this.close()})},this.handleKeyDown=e=>{this.shouldAllowSubmit()&&e.key===c.Key.Enter&&y.focus_in_input()&&this.handleCreateClick()},this.handleReady=()=>{this.logger.log(d.ModalEventName.READY),_.dispatchModalOpened()},this.handleError=e=>{this.logger.log(d.ModalEventName.ERROR,{error:e.message})},this.handleDataLoaded=e=>{this.logger.log(d.ModalEventName.DATA_LOADED,{path:e})},this.handleBreadcrumbClicked=e=>{this.logger.log(d.ModalEventName.BREADCRUMB_CLICKED,{path:e})},this.handleRowClicked=(e,t,s)=>{this.logger.log(d.ModalEventName.ROW_CLICKED,{path:e,index:t,is_keyboard:s})},this.handleFolderNameChange=e=>{const t=e.target.value.trim();let s=void 0,i=void 0;t.length&&(h.FolderNameDefaultErrorValidator(t)?h.FolderNameDefaultWarningValidator(t)||(i=h.FolderNameDefaultWarningMessage):s=h.FolderNameDefaultErrorMessage),this.setState({currentInputFolderName:t,folderNameValid:h.FolderNameDefaultErrorValidator(t),folderNameErrorText:s,folderNameWarningText:i})},this.shouldAllowSubmit=()=>{const{currentPath:e,currentInputFolderName:t,folderNameValid:s}=this.state;return!!("view"!==this.props.user.user_root_permissions||e&&"/"!==e)&&(""!==t&&s)},this.elementToFocusOnClose=document.activeElement,this.state={currentPath:e.initialPath||"/",currentInputFolderName:"",folderNameValid:!0,folderNameErrorText:void 0,folderNameWarningText:void 0,isModalOpen:!0}}componentDidMount(){this.logger=new f.WebModalActivityLogger(d.ModalName.HOME_NEW_FOLDER),this.logger.log(d.ModalEventName.SHOW),this.props.onShowModal&&this.props.onShowModal(this.logger.modalSessionId)}render(){const{user:e,initialPath:t}=this.props,{folderNameValid:s,folderNameErrorText:a,folderNameWarningText:l}=this.state,c=i.createElement(S.FolderPicker,{user:e,webTimer:v.get_timer(),rootName:g.Viewer.get_role_title(e)||E.intl.formatMessage({id:"mSjmSo",defaultMessage:"Dropbox"}),initialPath:t,canSelectReadonly:!1,onFolderSelected:this.handleFolderSelected,showFolderSuggestion:!1,apiClient:{getFolderContents:u.getFolderContentsAPIv2},skipFocusOnMount:!0,forceFolderSelectedCallback:!0,onError:this.handleError,onDataLoaded:this.handleDataLoaded,onBreadcrumbClicked:this.handleBreadcrumbClicked,onRowClicked:this.handleRowClicked});return i.createElement(r.Modal,{onAfterOpen:this.handleReady,open:this.state.isModalOpen,onRequestClose:this.close,withCloseButton:E.intl.formatMessage({id:"TnYT4C",defaultMessage:"Close"})},i.createElement(r.Modal.Header,{hasBottomSpacing:"title-small"},i.createElement(n.Title,{size:"small"},E.intl.formatMessage({id:"5Z9j+l",defaultMessage:"Create folder"}))),i.createElement(r.Modal.Body,{className:"folder-picker-container__fixed-height"},i.createElement(h.FolderNameInput,{key:"input",focusOnMount:!0,isValid:s,errorText:a,warningText:l,handleFolderNameChange:this.handleFolderNameChange,onKeyDown:this.handleKeyDown,useDig:!0,className:"folder-picker-name-input"}),c),i.createElement(r.Modal.Footer,null,i.createElement(o.Button,{variant:"opacity",onClick:this.handleClickCancel},E.intl.formatMessage({id:"aNfH1w",defaultMessage:"Cancel"})),i.createElement(o.Button,{variant:"primary",onClick:this.handleCreateClick,disabled:!this.shouldAllowSubmit()},E.intl.formatMessage({id:"Z2P2Q/",defaultMessage:"Create"}))))}}T.displayName="NewFolderModal";t.showNewFolderModal=({user:e,origin:t,initialPath:s,onShowModal:o,redirectOnClose:r})=>{l.logCreateFolder({uid:e.id,origin:t}),p.mountModal(i.createElement(T,{user:e,initialPath:s,onShowModal:o,origin:t,redirectOnClose:r}))}})),define("metaserver/static/js/home/post_tti/interface",["require","exports","metaserver/static/js/home/resource/actions_post_tti","metaserver/static/js/home/starred/actions_post_tti","metaserver/static/js/home/roots/home_access_web_post_tti","metaserver/static/js/home/recents/actions/recent_activity_actions_post_tti","metaserver/static/js/home/recents/actions/recent_activity_actions_utils_post_tti","metaserver/static/js/home/post_tti/unity_post_tti","metaserver/static/js/home/recents/components/recent_activity_container_post_tti","metaserver/static/js/home/recents/recent_activity_starred_post_tti","metaserver/static/js/home/recents/store_utils_post_tti","metaserver/static/js/home/recents/components/attachment_list_view_post_tti","metaserver/static/js/modules/clean/sharing/async_share_modal_util","metaserver/static/js/home/api_post_tti","metaserver/static/js/home/post_tti/props_post_tti","metaserver/static/js/home/util/logging/availability_logger_post_tti","metaserver/static/js/home/recents/recent_activity_client_post_tti","metaserver/static/js/home/recents/recent_activity_logger_utils_post_tti","metaserver/static/js/home/starred/actions_post_tti","metaserver/static/js/cloud_docs/home_create_file_experiments_post_tti","metaserver/static/js/modules/clean/react/extensions/client","metaserver/static/js/home/recents/recent_activity_file_action_post_tti","metaserver/static/js/home/starred/starred_item_file_action_post_tti","metaserver/static/js/home/content_suggestions/home_suggest","metaserver/static/js/modules/clean/upsell/home_inline_location","spectrum/dimensions/index","metaserver/static/js/home/surface_teams_homepage/home_teams","metaserver/static/js/home/recommended_members/recommended_members_post_tti","metaserver/static/js/plusplus/file_actions"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h,_,g,f,v,y,E,b,S,T,I,j,w,P,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLinkNodeEventObject=t.handleLinkNodeAction=t.initPrefetchRecommendedMembers=t.RecommendedMembers=t.initPrefetchHomeTeams=t.HomeTeams=t.Dimensions=t.initPrefetchHomeInlineContentPrompt=t.HomeInlineContentPrompt=t.initPrefetch=t.HomeSuggest=t.StarredItemFileActionPost=t.RecentActivityFileActionPost=t.getExtensionsClient=t.getNewFileMenu=t.loadAllStarredItems=t.logViewInFolder=t.logRecentsLoaded=t.logRequestFailed=t.openUrl=t.logOpenPathUrl=t.postLogEvent=t.archivePaperResources=t.logHomeAvailability=t.getPostTTIPropsInEdison=t.getDefaultHomePostTTIProps=t.getPostTTIProps=t.setSectionVisibility=t.createPaperDoc=t.asyncShowShareModal=t.AttachmentListView=t.loadRecentItems=t.loadPaperRecentItems=t.ensureAttachments=t.fetchStarredStatus=t.setStarredStatusOfPaperRecentItems=t.recentActivityContainerComponentDidMount=t.getUnityFeatures=t.deleteAttachments=t.deleteRecentItem=t.previewFileSyncRecentItem=t.shareFile=t.openVersions=t.downloadFiles=t.openFile=t.homeAccessWebComponentDidMount=t.getStarredStatusMetadata=t.createAutoShareLink=t.openInFileViewer=void 0,Object.defineProperty(t,"openInFileViewer",{enumerable:!0,get:function(){return s.openInFileViewer}}),Object.defineProperty(t,"createAutoShareLink",{enumerable:!0,get:function(){return s.createAutoShareLink}}),Object.defineProperty(t,"getStarredStatusMetadata",{enumerable:!0,get:function(){return i.getStarredStatusMetadata}}),Object.defineProperty(t,"homeAccessWebComponentDidMount",{enumerable:!0,get:function(){return o.homeAccessWebComponentDidMount}}),Object.defineProperty(t,"openFile",{enumerable:!0,get:function(){return r.openFile}}),Object.defineProperty(t,"downloadFiles",{enumerable:!0,get:function(){return r.downloadFiles}}),Object.defineProperty(t,"openVersions",{enumerable:!0,get:function(){return r.openVersions}}),Object.defineProperty(t,"shareFile",{enumerable:!0,get:function(){return r.shareFile}}),Object.defineProperty(t,"previewFileSyncRecentItem",{enumerable:!0,get:function(){return r.previewFileSyncRecentItem}}),Object.defineProperty(t,"deleteRecentItem",{enumerable:!0,get:function(){return r.deleteRecentItem}}),Object.defineProperty(t,"deleteAttachments",{enumerable:!0,get:function(){return n.deleteAttachments}}),Object.defineProperty(t,"getUnityFeatures",{enumerable:!0,get:function(){return a.getUnityFeatures}}),Object.defineProperty(t,"recentActivityContainerComponentDidMount",{enumerable:!0,get:function(){return l.recentActivityContainerComponentDidMount}}),Object.defineProperty(t,"setStarredStatusOfPaperRecentItems",{enumerable:!0,get:function(){return c.setStarredStatusOfPaperRecentItems}}),Object.defineProperty(t,"fetchStarredStatus",{enumerable:!0,get:function(){return c.fetchStarredStatus}}),Object.defineProperty(t,"ensureAttachments",{enumerable:!0,get:function(){return d.ensureAttachments}}),Object.defineProperty(t,"loadPaperRecentItems",{enumerable:!0,get:function(){return d.loadPaperRecentItems}}),Object.defineProperty(t,"loadRecentItems",{enumerable:!0,get:function(){return d.loadRecentItems}}),Object.defineProperty(t,"AttachmentListView",{enumerable:!0,get:function(){return m.AttachmentListView}}),Object.defineProperty(t,"asyncShowShareModal",{enumerable:!0,get:function(){return u.asyncShowShareModal}}),Object.defineProperty(t,"createPaperDoc",{enumerable:!0,get:function(){return p.createPaperDoc}}),Object.defineProperty(t,"setSectionVisibility",{enumerable:!0,get:function(){return p.setSectionVisibility}}),Object.defineProperty(t,"getPostTTIProps",{enumerable:!0,get:function(){return h.getPostTTIProps}}),Object.defineProperty(t,"getDefaultHomePostTTIProps",{enumerable:!0,get:function(){return h.getDefaultHomePostTTIProps}}),Object.defineProperty(t,"getPostTTIPropsInEdison",{enumerable:!0,get:function(){return h.getPostTTIPropsInEdison}}),Object.defineProperty(t,"logHomeAvailability",{enumerable:!0,get:function(){return _.logHomeAvailability}}),Object.defineProperty(t,"archivePaperResources",{enumerable:!0,get:function(){return g.archivePaperResources}}),Object.defineProperty(t,"postLogEvent",{enumerable:!0,get:function(){return g.postLogEvent}}),Object.defineProperty(t,"logOpenPathUrl",{enumerable:!0,get:function(){return f.logOpenPathUrl}}),Object.defineProperty(t,"openUrl",{enumerable:!0,get:function(){return f.openUrl}}),Object.defineProperty(t,"logRequestFailed",{enumerable:!0,get:function(){return f.logRequestFailed}}),Object.defineProperty(t,"logRecentsLoaded",{enumerable:!0,get:function(){return f.logRecentsLoaded}}),Object.defineProperty(t,"logViewInFolder",{enumerable:!0,get:function(){return f.logViewInFolder}}),Object.defineProperty(t,"loadAllStarredItems",{enumerable:!0,get:function(){return v.loadAllStarredItems}}),Object.defineProperty(t,"getNewFileMenu",{enumerable:!0,get:function(){return y.getNewFileMenu}}),Object.defineProperty(t,"getExtensionsClient",{enumerable:!0,get:function(){return E.getExtensionsClient}}),Object.defineProperty(t,"RecentActivityFileActionPost",{enumerable:!0,get:function(){return b.RecentActivityFileActionPost}}),Object.defineProperty(t,"StarredItemFileActionPost",{enumerable:!0,get:function(){return S.StarredItemFileActionPost}}),Object.defineProperty(t,"HomeSuggest",{enumerable:!0,get:function(){return T.HomeSuggest}}),Object.defineProperty(t,"initPrefetch",{enumerable:!0,get:function(){return T.initPrefetch}}),Object.defineProperty(t,"HomeInlineContentPrompt",{enumerable:!0,get:function(){return I.HomeInlineContentPrompt}}),Object.defineProperty(t,"initPrefetchHomeInlineContentPrompt",{enumerable:!0,get:function(){return I.initPrefetchHomeInlineContentPrompt}}),Object.defineProperty(t,"Dimensions",{enumerable:!0,get:function(){return j.Dimensions}}),Object.defineProperty(t,"HomeTeams",{enumerable:!0,get:function(){return w.HomeTeams}}),Object.defineProperty(t,"initPrefetchHomeTeams",{enumerable:!0,get:function(){return w.initPrefetchHomeTeams}}),Object.defineProperty(t,"RecommendedMembers",{enumerable:!0,get:function(){return P.RecommendedMembers}}),Object.defineProperty(t,"initPrefetchRecommendedMembers",{enumerable:!0,get:function(){return P.initPrefetchRecommendedMembers}}),Object.defineProperty(t,"handleLinkNodeAction",{enumerable:!0,get:function(){return O.handleLinkNodeAction}}),Object.defineProperty(t,"getLinkNodeEventObject",{enumerable:!0,get:function(){return O.getLinkNodeEventObject}})})),define("metaserver/static/js/home/post_tti/props_post_tti",["require","exports","tslib","metaserver/static/js/cloud_docs/home_create_file_experiments_post_tti","metaserver/static/js/home/util/prefetch_handler","metaserver/static/js/modules/core/exception","lodash","metaserver/static/js/home/store","metaserver/static/js/proto_utils/unpack","metaserver/static/js/dropbox/proto/edison_starred/edison_starred","metaserver/static/js/dropbox/proto/edison_recent/edison_recent"],(function(e,t,s,i,o,r,n,a,l,c,d){"use strict";function m(){return{maybeRenderTeamAdminModals:!1,permissionsAtUploadModalProps:{autoTeamGroupId:""},uploaderPostTTIExperiments:{},cloudDocsExperiments:i.getCloudDocsExperiments(),preferredEditors:{},showLegacyCreatePaperButton:!1,expFlowsAutomatedFolderUI:!1,userHasSharedFileOrFolderInfo:{}}}Object.defineProperty(t,"__esModule",{value:!0}),t.getPostTTIPropsInEdison=t.getPostTTIProps=t.getDefaultHomePostTTIProps=void 0,t.getDefaultHomePostTTIProps=m,t.getPostTTIProps=n.once(()=>new Promise(e=>{const t=o.getPrefetchHandler("__REGISTER_POST_TTI_PREFETCH_HANDLER"),s=()=>e(m());t?o.handlePrefetch(t,t=>{try{e(JSON.parse(t))}catch(e){r.reportStack("Failed to parse post TTI props",{severity:r.SEVERITY.CRITICAL,exc_extra:{error:e}}),s()}},e=>{r.reportStack("Post TTI prefetch failed",{severity:r.SEVERITY.CRITICAL,exc_extra:{error:e}}),s()}):s()})),t.getPostTTIPropsInEdison=function(){return s.__awaiter(this,void 0,void 0,(function*(){const e=a.getHomeStore(),t=e.getPostTTIPropsPromise();return new Promise(t?function(s){t.then(t=>{let i;const o=e.getPageType(location.pathname);if("HOME"===o)s(m());else{i="STARRED"===o?l.unpackProto(t,c.edison_starred.EdisonStarredPostTtiPrefetchResults):l.unpackProto(t,d.edison_recent.EdisonRecentsPostTTIPrefetchResults);let e=m();i.error||(e=JSON.parse(i.jsonData)),s(e)}})}:function(e){e(m())})}))}})),define("metaserver/static/js/home/post_tti/unity_post_tti",["require","exports","tslib"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUnityFeatures=void 0,t.getUnityFeatures=function(){return s.__awaiter(this,void 0,void 0,(function*(){try{const{UnityFeatures:t}=yield new Promise((t,s)=>{e(["metaserver/static/js/modules/clean/unity/features"],t,s)}).then(s.__importStar);return t.isUnitySupported()?t:null}catch(e){return null}}))}})),define("metaserver/static/js/home/recents/actions/recent_activity_actions_post_tti",["require","exports","tslib","lodash","react-intl","spectrum-sharing/utils/sharing_constants","metaserver/static/js/modules/clean/browse_uri_interface","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/preferred_editor_utils","metaserver/static/js/modules/clean/downloads","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/modules/clean/navigation","metaserver/static/js/display_types/constants","metaserver/static/js/home/post_tti/unity_post_tti","metaserver/static/js/home/recents/actions/recent_activity_actions_utils_post_tti","metaserver/static/js/home/recents/models/utils","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_logger_utils_post_tti","metaserver/static/js/home/recents/store_utils_post_tti","metaserver/static/js/home/recents/stores/attachment_store","metaserver/static/js/home/resource/actions_post_tti","metaserver/static/js/home/store","metaserver/static/js/modules/clean/react/modal_dig","metaserver/static/js/modules/clean/sharing/async_share_modal_util","metaserver/static/js/modules/core/assert","metaserver/static/js/modules/core/exception","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/core/notify","metaserver/static/js/modules/core/uri","metaserver/static/js/edison/ui/router_utils"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h,_,g,f,v,y,E,b,S,T,I,j,w,P,O,A){"use strict";function R(e){return{index:e.index}}function D(e,t,s,i,o){const r=e.fqPath&&(a.isCloudDocByExtension(d.file_extension(e.fqPath))||l.hasPreferredEditorSupport(e.fqPath));if(e.isDir||i&&!r){const o=(function(e,t){return e.fqPath?String(n.preview_uri_for_fq_path(t,e.fqPath)):e.previewInfo&&e.previewInfo.href||null})(e,b.getHomeStore().getUser());if(o){if(e.isDir&&!i)if(A.shouldUseReactRouter()){const i=n.get_browse_root(b.getHomeStore().getUser())+e.fqPath;f.openUrl(i,g.ActionType.OPEN_DIR,t,s)}else m.logAndNavigate(o,()=>f.logRecentActivityAction(g.ActionType.VIEW_FILE,t,s),m.NavigationMethod.REDIRECT);else f.openTab(o,g.ActionType.VIEW_FILE,t,s);return!0}return!1}{const i=o?g.ActionType.COMMENT:g.ActionType.VIEW_FILE;return E.openInFileViewer(e.id,()=>f.logRecentActivityAction(i,t,s),o),!0}}Object.defineProperty(t,"__esModule",{value:!0}),t.previewAttachment=t.previewFileSyncRecentItem=t.openVersions=t.downloadFiles=t.deleteRecentItem=t.openFile=t.shareFile=void 0,i=s.__importStar(i),c=s.__importStar(c),j=s.__importStar(j),t.shareFile=function(e,t,i){var o;return s.__awaiter(this,void 0,void 0,(function*(){const s=b.getUser(),n=yield v.ensureAttachments([e],g.EnsureAttachmentsPurpose.SHARE_FILE),a=n[0],l=a.fqPath||"",c=a.previewInfo,d=c?c.target_ns:null;let m=!1;return i?(E.createAutoShareLink(s,l),m=!0):m=yield T.asyncShowShareModal(s,{fqPath:l,isFolder:!!(null===(o=a.previewInfo)||void 0===o?void 0:o.is_dir),origin:r.SHARE_ACTION_ORIGIN_TYPE.RECENTS,targetNsId:d}),t&&m&&(f.logShareFile(s.id,l,t.totalCount,t.cellView),h.homeLogEvent(t,g.ActionType.SHARE,n,h.getFqPaths(n).indexOf(l))),m}))},t.openFile=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=yield p.getUnityFeatures();I.assert(!!s,"Unity is not supported by this browser");const o=yield v.ensureAttachments([e],g.EnsureAttachmentsPurpose.OPEN_FILE),{nsId:r,nsPath:n}=o[0],a=o[0].fqPath||"",l=b.getUserId();s.open_file(r,n,l,i.noop,e=>{P.Notify.error("We were unable to open this file"),j.reportException({err:Error(e),tags:["recents"],severity:j.SEVERITY.NONCRITICAL})}),t&&(f.logUnityOpenFile(l,a,t.totalCount,t.cellView),h.homeLogEvent(t,g.ActionType.OPEN,o))}))},t.deleteRecentItem=function(e,t,r,n){return s.__awaiter(this,void 0,void 0,(function*(){const{federatedRecentItem:s,displayType:n}=e;if(s)j.reportStack("Deleting is not supported for federated recent items",{severity:j.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e}});else{const e=_.extractAttachmentIds(t),s=()=>h.deleteAttachments(e,r);let a,l;if(1===e.length){const t=y.getAttachmentStore().getById(e[0]);if(t&&t.isLoaded){l=t.isDir?w.intl.formatMessage({id:"Z9HlH9",defaultMessage:"Delete folder?"}):w.intl.formatMessage({id:"mPIBsk",defaultMessage:"Delete file?"});const e=n===u.DisplayTypes.SHARED_FOLDER?o.defineMessage({id:"9Fi8TL",defaultMessage:"Are you sure you want to remove the shared folder <b>{file_name}</b> from your Dropbox? This shared folder will stay shared with other members and you can re-add it later."}):o.defineMessage({id:"l7h1V3",defaultMessage:"Do you want to delete <b>{file_name}</b>?"});a=w.intl.formatMessage(e,{file_name:i.escape(t.displayName||""),b:e=>`<b>${e.join("")}</b>`})}else l=w.intl.formatMessage({id:"mPIBsk",defaultMessage:"Delete file?"}),a=w.intl.formatMessage({id:"D3751u",defaultMessage:"Do you want to delete this file?"})}else l=w.intl.formatMessage({id:"V5KZzi",defaultMessage:"Delete files?"}),a=w.intl.formatMessage({id:"ZRCJDk",defaultMessage:"Do you want to delete <b>{num} files</b>?"},{num:i.escape(String(e.length)),b:e=>`<b>${e.join("")}</b>`});S.SimpleModal.show({title_text:l,body_html:a,confirm_text:w.intl.formatMessage({id:"iNfEof",defaultMessage:"Delete"}),confirm_callback:s,cancel_text:w.intl.formatMessage({id:"AqRWwC",defaultMessage:"Cancel"}),autoclose:!0})}}))},t.downloadFiles=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=b.getUserId(),i=yield v.ensureAttachments(e,g.EnsureAttachmentsPurpose.DOWNLOAD_FILES);t&&(f.logDownloadFile(s,h.getFqPaths(i),t.totalCount,t.cellView),h.homeLogEvent(t,g.ActionType.DOWNLOAD,i)),i.forEach(e=>{if(e.isDir&&e.fqPath&&null!=e.previewInfo&&null!=e.previewInfo.block_hash)c.get_zip({fq_paths:[e.fqPath],subject_uid:s,block_hash:e.previewInfo.block_hash,parent_path:e.fqPath});else{const t=null!=e.previewInfo&&"href"in e.previewInfo?e.previewInfo.href:void 0;t&&c.get({url:t})}})}))},t.openVersions=function(e,t,i){return s.__awaiter(this,void 0,void 0,(function*(){const s=b.getUserId(),{attachments:o,isRetry:r}=yield v.ensureAttachmentsWithRetryStatus([t],g.EnsureAttachmentsPurpose.OPEN_VERSIONS),n=o[0].fqPath||"",a=(function(e,t,s={}){return s=Object.assign({_subject_uid:String(t)},s),new O.URI({path:`/history${e}`,query:s})})(n,s);m.logAndNavigate(a.toString(),i?()=>(f.logOpenVersions(s,n,i.totalCount,i.cellView),h.homeLogEvent(i,g.ActionType.VERSIONS,o)):void 0,r?m.NavigationMethod.REDIRECT:e)}))},t.previewFileSyncRecentItem=function(e,t,i,o){return s.__awaiter(this,void 0,void 0,(function*(){const{attachments:s,isRetry:r}=yield v.ensureAttachmentsWithRetryStatus([e.attachmentIds[0]],g.EnsureAttachmentsPurpose.PREVIEW_RECENT_ITEM);if(1===s.length){const n=s[0];if(!e.isMounted&&e.scl)return void(e.fqPath&&a.isPointerByExtension(e.fqPath)?f.openUnsafeTab(e.scl,g.ActionType.VIEW_FILE,e.attachmentIds,o):f.openTab(e.scl,g.ActionType.VIEW_FILE,e.attachmentIds,o));if(D(n,e.attachmentIds,o,t&&!r,i.isCommentAction))return}j.reportStack("Preview failed",{severity:j.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e,attachments:s,previewOptions:R(i)}})}))},t.previewAttachment=function(e,t,s,i){D(t.find(t=>t.id===e),_.extractAttachmentIds(t),i,m.isMetaKeyPressed(s))}})),define("metaserver/static/js/home/recents/actions/recent_activity_actions_utils_post_tti",["require","exports","tslib","lodash","metaserver/static/js/file_actions/metrics","metaserver/static/js/metrics/index","metaserver/static/js/files_view/file_actions/api_v2","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/recent_activity_logger_utils_post_tti","metaserver/static/js/home/recents/store_utils_post_tti","metaserver/static/js/home/recents/utils/events","metaserver/static/js/home/store","metaserver/static/js/modules/clean/react/snackbar","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/core/exception"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h,_){"use strict";function g(e){return i.compact(i.map(e,"fqPath"))}function f(e,t,s,i){return m.logEvent(t,e.cellView,s,e.totalCount,i)}Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAttachments=t.homeLogEvent=t.getFqPaths=void 0,i=s.__importStar(i),n=s.__importStar(n),t.getFqPaths=g,t.homeLogEvent=f,t.deleteAttachments=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){const s=u.getUserId(),m=yield d.ensureAttachments(e,a.EnsureAttachmentsPurpose.PROMPT_AND_DELETE_ATTACHMENTS),v=g(m),y=m.filter(e=>null!==e.fqPath).map(e=>({fq_path:e.fqPath,is_dir:e.isDir}));if(t){const{totalCount:e,cellView:i}=t;c.logDeleteFiles(s,v,e,i),f(t,a.ActionType.DELETE,m,void 0)}const E=r.getMetricsReporter(),b={surface:"recents",batchSizeBucket:o.bucketForBatchSize(e.length),contentType:"files"},S=E.createTimer({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_total_ms"},b),T=Date.now(),I=E.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_average_ms"},b),j=E.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/completed"},b),w=i.uniqueId("DELETE_FILES");l.recentActivityDispatcher.dispatch({type:a.DELETE_FILES_PENDING,attachmentIds:e,transactionId:w}),p.Snackbar.complete(h.intl.formatMessage({id:"20q1Pn",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:v.length}),"home-delete");const P=yield n.deleteFiles(y,s,!1);if(S.record(),I.record((Date.now()-T)/e.length),P.isError)p.Snackbar.fail(h.intl.formatMessage({id:"gq9/8S",defaultMessage:"Failed to perform the delete. Please try again later."}),"home-delete"),_.reportException({err:new Error(P.error_summary),severity:"non-critical",tags:["browse","recents"]}),j.record(0),l.recentActivityDispatcher.dispatch({type:a.DELETE_FILES_ROLLBACK,transactionId:w});else{l.recentActivityDispatcher.dispatch({type:a.DELETE_FILES_COMMIT,transactionId:w});const e=P.result.entries.filter(e=>n.isFailure(e)&&!n.isPathLookupFailure(e.failure)).length,t=P.result.entries.filter(n.isFailure);j.record(e>0?0:1),o.recordPathLookupErrors(t,"delete",b)}}))}})),define("metaserver/static/js/home/recents/components/attachment_file_icon_view_post_tti",["require","exports","tslib","react","dig-components/tooltips","dig-components/typography","metaserver/static/js/home/util/resource_icon"],(function(e,t,s,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentFileIconView=void 0,i=s.__importDefault(i);class a extends i.default.Component{constructor(){super(...arguments),this.onClick=e=>{e.preventDefault(),e.stopPropagation(),this.props.handleClick(this.props.id,e)}}render(){const{overlayText:e,file:t,width:s,height:a}=this.props;return e?i.default.createElement("button",{onClick:this.onClick,className:"recents-item__attachment-item recents-item__attachment-item--has-overlay",style:{width:s,height:a}},i.default.createElement("span",{className:"recents-item__attachment-overlay"},i.default.createElement(r.Text,{size:"large",inverse:!0,isBold:!0},e))):i.default.createElement(o.Tooltip,{title:t.displayName,placement:"bottom"},i.default.createElement("button",{className:"recents-item__attachment-item","aria-label":t.displayName,onClick:this.onClick,style:{width:s,height:a}},i.default.createElement(n.HomeResourceIcon,{className:"recents-item__attachment-icon",displayType:t.displayType,fileName:t.displayName,isLarge:!0})))}}t.AttachmentFileIconView=a,a.displayName="AttachmentFileIconView"})),define("metaserver/static/js/home/recents/components/attachment_grid_post_tti",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentGrid=void 0;class s{constructor(e,t){this._gridWidth=e,this._gutterWidth=t}static create(e,t){return new s(e,t)}generate(e,t=1/0){const s=[];let i=0;for(;s.length<t&&i<e.length;){const t=this.buildRow(e.slice(i));i+=t.length,s.push(t)}return s}buildRow(e){const t=[];let s=this._gridWidth+this._gutterWidth;for(const i of e){if(s=s-i.width-this._gutterWidth,!(s>=0||0===t.length))break;t.push(i)}return t}}t.AttachmentGrid=s})),define("metaserver/static/js/home/recents/components/attachment_image_view_post_tti",["require","exports","tslib","react","classnames","dig-components/typography","dig-components/tooltips"],(function(e,t,s,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentImageView=void 0,i=s.__importDefault(i),o=s.__importDefault(o);class a extends i.default.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0},this.onClick=e=>{e.preventDefault(),e.stopPropagation(),this.props.handleClick(this.props.id,e)},this.onLoad=()=>{this.setState({isLoading:!1})},this.onError=()=>{this.props.handleLoadError(this.props.id),this.setState({isLoading:!1})}}render(){const{image:e,overlayText:t}=this.props,s=i.default.createElement("button",{onClick:this.onClick,className:o.default("recents-item__attachment-item",{"recents-item__attachment-item--has-overlay":!!t}),style:{width:e.width,height:e.height},"aria-label":e.displayName},i.default.createElement("img",{alt:e.displayName,className:o.default("recents-item__attachment-thumbnail",{"recents-item__attachment-thumbnail--has-overlay":!!t,"recents-item__attachment-thumbnail--is-loading":this.state.isLoading}),src:e.thumbnailUrl,onLoad:this.onLoad,onError:this.onError}),t&&i.default.createElement("span",{className:"recents-item__attachment-overlay"},i.default.createElement(r.Text,{size:"large",inverse:!0,isBold:!0},t)));return t?s:i.default.createElement(n.Tooltip,{title:e.displayName,placement:"bottom"},s)}}t.AttachmentImageView=a,a.displayName="AttachmentImageView"})),define("metaserver/static/js/home/recents/components/attachment_list_layout_post_tti",["require","exports","tslib","lodash","metaserver/static/js/photos/thumbnail_url_util","metaserver/static/js/home/recents/components/attachment_file_icon_view_post_tti","metaserver/static/js/home/recents/components/attachment_grid_post_tti","metaserver/static/js/home/recents/components/attachment_image_view_post_tti","metaserver/static/js/modules/core/browser_detection","metaserver/static/js/modules/core/assert"],(function(e,t,s,i,o,r,n,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentListLayout=void 0,i=s.__importStar(i);const d=o.ThumbnailSizeMode.FIT_ONE,m=o.ThumbnailSizeMode.EXACT_NO_BACKGROUND;class u{constructor(e,t,s){this.gridWidth=e,this.columnWidth=t,this.gutterWidth=s,this._grid=n.AttachmentGrid.create(this.gridWidth,this.gutterWidth)}static create(e,t,s){return new u(e,t,s)}generate(e,t,s){const i=this.cellMetadata(e,s);return this._grid.generate(i,t)}cellMetadata(e,t){const s=i.zipObject(t,t);return e.map(e=>{const{isLoaded:t,thumbnailUrl:i}=e;return s[e.id]||t&&!i?this.buildFileIconViewMetadata(e):t?this.buildImageViewMetadata(e):this.buildLoadingImageViewMetadata(e)})}buildFileIconViewMetadata(e){return{id:e.id,scaledThumbnailUrl:null,view:r.AttachmentFileIconView,width:this.columnWidth,height:this.columnWidth,attachment:e}}buildLoadingImageViewMetadata(e){return{id:e.id,scaledThumbnailUrl:null,view:null,width:this.columnWidth,height:this.columnWidth,attachment:e}}buildImageViewMetadata(e){let t=e.thumbnailUrl;const{width:s,height:i,variant:r}=this.calculateThumbnailDimensions(e.thumbnailDimensions);return t.startsWith("data:")||(t=(function(e,t){let s,i,r;const n=l.is_high_density_display();switch(t){case"aggregated-scaled":r=n?200:100,s=n?200:100,i=d;break;case"aggregated-cropped":r=n?200:100,s=n?200:100,i=m;break;case"aggregated-wide-cropped":r=n?718:359,s=n?200:100,i=m;break;default:return c.assert(!1,`invalid ThumbnailVariant: ${t}`),""}return o.thumbnailUrlForSize(e,r,s,i)})(t,r)),{id:e.id,view:a.AttachmentImageView,scaledThumbnailUrl:t,width:s+0,height:i+0,attachment:e}}calculateThumbnailDimensions(e){let t,s,i;if(e){i="aggregated-scaled";const o=e.width/e.height;t=this.columnWidth,s=Math.floor(o*t),s>this.columnWidth-0&&(i="aggregated-wide-cropped",s=this.columnWidth-0)}return(!e||s<75)&&(i="aggregated-cropped",s=this.columnWidth,t=this.columnWidth),{width:s,height:t,variant:i}}}t.AttachmentListLayout=u})),define("metaserver/static/js/home/recents/components/attachment_list_view_post_tti",["require","exports","tslib","lodash","react","metaserver/static/js/components/loading_indicator","metaserver/static/js/display_types/constants","metaserver/static/js/home/recents/actions/recent_activity_actions_post_tti","metaserver/static/js/home/recents/components/attachment_file_icon_view_post_tti","metaserver/static/js/home/recents/components/attachment_image_view_post_tti","metaserver/static/js/home/recents/components/attachment_list_layout_post_tti","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/store_utils_post_tti","metaserver/static/js/modules/core/i18n"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentListView=void 0,i=s.__importStar(i),o=s.__importDefault(o);class h extends o.default.Component{constructor(e){super(e),this.previewAttachment=(e,t)=>{const{attachments:s}=this.props,i={totalCount:s.length,cellView:this};a.previewAttachment(e,s,t,i)},this.handleImageLoadError=e=>{const t=[...this.state.errored];t.push(e),this.setState({errored:t})},this.revealNextGroup=()=>{this.setState({rows:this.state.rows+m.SHOW_MORE_THUMBNAIL_ROW_INCREMENT})},this.state={rows:1,errored:[],expandedAttachments:{},grid:[]}}componentDidMount(){this.updateLayoutController()}componentDidUpdate(e,t){e.width===this.props.width&&t.errored===this.state.errored&&t.rows===this.state.rows||(this.updateLayoutController(),this.state.rows>t.rows&&this.loadRemainingAttachments())}updateLayoutController(){this.props.width&&this.props.width>0&&this.setState({grid:i.flattenDeep(d.AttachmentListLayout.create(this.props.width,this.props.width>400?100:50,8).generate(this.props.attachments,this.isLoading()?1:this.state.rows,this.state.errored))})}loadRemainingAttachments(){const e=this.props.attachments.filter(e=>!e.isLoaded).map(e=>e.id);e.length&&u.ensureAttachments(e,m.EnsureAttachmentsPurpose.LOAD_REMAINING_ATTACHMENTS)}isLoading(){return this.state.rows>1&&this.props.attachments.some(e=>!e.isLoaded)}renderAttachmentItems(){const{attachments:e}=this.props,{grid:t}=this.state;if(!t.length)return[];let s=this.previewAttachment;const i=t.length,r=e.length,a=r-i+1,d=!this.isLoading()&&i<r;return t.map((e,i)=>{let r;d&&i===t.length-1&&(s=this.revealNextGroup,r=p.intl.formatMessage({id:"o+CHKf",defaultMessage:"+{count}"},{count:a}));const{attachment:m,view:u,id:h,scaledThumbnailUrl:_,width:g,height:f}=e,{displayName:v,displayType:y}=m;switch(u){case l.AttachmentFileIconView:return o.default.createElement(l.AttachmentFileIconView,{key:`attachment-${h}`,id:h,file:{displayName:v||"",displayType:y||n.DisplayTypes.FILE},overlayText:r,handleClick:s,width:g,height:f});case c.AttachmentImageView:return o.default.createElement(c.AttachmentImageView,{key:`attachment-expanded-${h}`,overlayText:r,id:h,image:{thumbnailUrl:_,displayName:v||"",width:g,height:f},handleClick:s,handleLoadError:this.handleImageLoadError});default:return null}})}renderLoadingView(){return o.default.createElement("div",{className:"attachment-loading"},o.default.createElement(r.LoadingIndicator,{style:r.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER,className:"recents-loading-indicator"}))}render(){let e=null;return this.isLoading()&&(e=this.renderLoadingView()),o.default.createElement(o.default.Fragment,null,this.renderAttachmentItems(),e)}}t.AttachmentListView=h,h.displayName="AttachmentListView"})),define("metaserver/static/js/home/recents/components/recent_activity_container_post_tti",["require","exports","tslib","lodash","metaserver/static/js/modules/clean/sharing/share_modal_util","metaserver/static/js/modules/clean/sharing/wizard/wizard_modals"],(function(e,t,s,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recentActivityContainerComponentDidMount=t.shareExistingFolder=t.generateModalSessionId=void 0,i=s.__importStar(i),Object.defineProperty(t,"generateModalSessionId",{enumerable:!0,get:function(){return o.generateModalSessionId}}),Object.defineProperty(t,"shareExistingFolder",{enumerable:!0,get:function(){return r.shareExistingFolder}}),t.recentActivityContainerComponentDidMount=function(e){return s.__awaiter(this,void 0,void 0,(function*(){(function(e){let t=0;const s=()=>{const s=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,i=document.documentElement.scrollHeight-window.innerHeight;s/i>.8&&i>t&&(e(),t=i)};window.addEventListener("scroll",i.throttle(s,150)),s()})(e)}))}})),define("metaserver/static/js/home/recents/recent_activity_client_post_tti",["require","exports","tslib","metaserver/static/js/modules/constants/python","lodash","metaserver/static/js/home/api","metaserver/static/js/home/recents/recent_activity_client_utils"],(function(e,t,s,i,o,r,n){"use strict";function a(e,t,s,i=!0){return r.makeRequest({subject_user:e,type:"POST",url:t,data:s},{isBackground:i})}function l(e,t,i,o=!0){return s.__awaiter(this,void 0,void 0,(function*(){return n.getPayload(yield a(e,t,i,o))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.checkFileInRootCollection=t.activityGenerateJson=t.archivePaperResources=t.postLogEvent=t.retrievePaperRecents=t.recentsJson=t.fetchPayload=void 0,o=s.__importStar(o),t.fetchPayload=l,t.recentsJson=function(e,t){return a(e,"/recents/json",{num_activities:t?20:10,cursor:t})},t.retrievePaperRecents=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){return yield a(e,"/home_feed/retrieve_paper_recents",{is_initial_fetch:t})}))},t.postLogEvent=function(e,t){r.makeRequest({url:"/recents/logger",type:"POST",subject_user:e,data:t,dataType:"text"},{isBackground:!0})},t.archivePaperResources=function(e,t){return l(e,"/home_feed/archive_paper_resources",{resources_json:JSON.stringify(t)},!1)},t.activityGenerateJson=function(e,t,r){return s.__awaiter(this,void 0,void 0,(function*(){return(yield l(e,"/activity/generate/json",{activity_keys:JSON.stringify(o.uniq(t)),loading_modes:JSON.stringify([i.FILE_ACTIVITY_LOADING_MODE.PREVIEW_INFO]),encrypted:r})).activities_by_activity_key}))},t.checkFileInRootCollection=function(e,t){return s.__awaiter(this,void 0,void 0,(function*(){return(yield l(e,"/recents/check_files_in_root_collection",{files_json:JSON.stringify(t)})).file_in_root_collection_info}))}})),define("metaserver/static/js/home/recents/recent_activity_file_action_post_tti",["require","exports","tslib","react","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/app_actions/app_actions_menu","metaserver/static/js/modules/clean/react/extensions/data/types","metaserver/static/js/home/resource_id_types","metaserver/static/js/home/store","metaserver/static/js/home/util/file_utils"],(function(e,t,s,i,o,r,n,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecentActivityFileActionPost=void 0,i=s.__importDefault(i);class d extends i.default.PureComponent{constructor(e){super(e),this.onActionDropdownOpen=()=>{this.setState({isActionDropdownOpen:!0})},this.onActionDropdownClose=()=>{this.setState({isActionDropdownOpen:!1})},this.state={isActionDropdownOpen:!1}}render(){const{recentItem:e,attachments:t,arialabelledby:s}=this.props;if(!(e&&e.idType===a.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID&&t.length&&e.viewingUserId&&e.displayName))return null;const d=c.getFileFromPartial({file_id:e.resourceId,ext:"."+o.file_extension(e.displayName),ns_id:t[0].nsId||void 0,ns_path:t[0].nsPath||void 0,fq_path:t[0].fqPath||void 0});return i.default.createElement(r.UnconnectedExtensionsMenu,{className:"recents-item__action recents-item__action--hover-only recents-item__action--standard-breakpoint-only",user:l.getUser(),file:d,arialabelledby:s,onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,telemetryContext:{surface:"home_recent"},triggerType:n.TriggerType.OpacityButton})}}t.RecentActivityFileActionPost=d,d.displayName="RecentActivityFileActionPost"})),define("metaserver/static/js/home/recents/recent_activity_logger_post_tti",["require","exports","tslib","lodash","metaserver/static/js/modules/core/assert","metaserver/static/js/home/recents/recent_activity_client_post_tti","metaserver/static/js/pap/analytics_client","metaserver/static/js/dropbox/proto/pap_events/top_level_nav/shown_recents_screen"],(function(e,t,s,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logTimeToFirstAction=t.logCellAction=t.logRequestFailed=t.logPageLoaded=t.disableLogging=t.enableLogging=t.FilterViews=void 0,i=s.__importStar(i);const l=a.pap_events.top_level_nav.Shown_RecentsScreen;t.FilterViews={EVERYTHING:"everything"};const c=["is_full_page","item_count","contains_aggregation","latency","is_paginated","is_empty"],d=["failure_type","is_paginated"],m=["in_aggregation","filter_view","action_type","target_activity_type","action_scope","position","file_extension","days_ago"],u=["latency","action_type","action_scope"];let p=!0;function h(e,t,s={}){if(!p)return;const i=Object.assign(Object.assign({},s),{event_name:t});r.postLogEvent(e,i)}function _(e,t,s){const r=Object.keys(s),n=i.difference(r,t);o.assert(0===n.length,`${e} called with unsupported keys: ${n}`)}t.enableLogging=function(){p=!0},t.disableLogging=function(){p=!1},t.logPageLoaded=function(e,t){_("logPageLoaded",c,t),h(e,"client_page_loaded",t);const s=Object.assign(Object.assign({},t),{active_user_id:e,event_name:"client_page_loaded",isEmpty:0===t.item_count});n.logEvent(l.create(s))},t.logRequestFailed=function(e,t){_("logRequestFailed",d,t),h(e,"request_failed",t)},t.logCellAction=function(e,t){_("logCellAction",m,t),h(e,"cell_action",t)},t.logTimeToFirstAction=function(e,t){_("logTimeToFirstAction",u,t),h(e,"time_to_first_action",t)}})),define("metaserver/static/js/home/recents/recent_activity_logger_utils_post_tti",["require","exports","tslib","react-dom","lodash","metaserver/static/js/home/recents/utils/events","metaserver/static/js/home/recents/recent_activity_logger_post_tti","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/recents/stores/attachment_store","metaserver/static/js/modules/clean/web_timing_logger","metaserver/static/js/modules/clean/navigation","metaserver/static/js/home/recents/recent_activity_logger_utils","metaserver/static/js/edison/ui/router_utils","metaserver/static/js/modules/clean/history_singleton","metaserver/static/js/modules/core/uri"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h){"use strict";function _(e,t,s,r,l){const d=i.findDOMNode(l);if(null===d)return;const u=o.filter(o.uniq(o.map(s,e=>null!=e?e.split(".").pop().toLowerCase():void 0)),Boolean),p=r>1;let h;h=1===r?a.ActionScope.SINGLE:s.length===r?a.ActionScope.AGGREGATION:a.ActionScope.SUBSET;const _=Array.prototype.indexOf.call(d.parentNode.childNodes,d),g=Number(d.getAttribute("data-item-type")),f=Number(d.getAttribute("data-item-date")),v={in_aggregation:p,filter_view:n.FilterViews.EVERYTHING,action_type:e,action_scope:h,target_activity_type:g,position:_,file_extension:u.join(","),days_ago:(y=f,Math.floor((Date.now()-y)/864e5))};var y;n.logCellAction(t,v),(function(e,t){if(!m.canLogFirstAction())return;const s=c.start_time();if(!s)return;m.onLogFirstAction(),n.logTimeToFirstAction(e,Object.assign(Object.assign({},t),{latency:Date.now()-s}))})(t,o.pick(v,"action_scope","action_type"))}function g(e){return(t,s,i,o)=>{_(e,t,s,i,o)}}function f(e){return(t,s,i,o)=>g(e)(t,[s],i,o)}function v(e,t,s={}){const i=Object.assign(Object.assign({is_full_page:t.isFullPage},s),{latency:Date.now()-t.startTime});n.logPageLoaded(e,i)}function y(e,t,s){const i=l.getAttachmentStore().getByIds(t);return r.logEvent(e,s.cellView,i,s.totalCount,void 0,s.loggedComponentName)}Object.defineProperty(t,"__esModule",{value:!0}),t.openUrl=t.openUnsafeTab=t.openTab=t.logRecentActivityAction=t.logRecentsLoaded=t.startRequestTimer=t.logRequestFailed=t.logViewInFolder=t.logOpenVersions=t.logDownloadFile=t.logCommentFile=t.logOpenSharedLinkUrl=t.logOpenPathUrl=t.logUnityOpenFile=t.logDeleteFiles=t.logPreviewFiles=t.logShareFile=void 0,i=s.__importStar(i),o=s.__importStar(o),c=s.__importStar(c),t.logShareFile=f(a.ActionType.SHARE),t.logPreviewFiles=g(a.ActionType.VIEW_FILE),t.logDeleteFiles=g(a.ActionType.DELETE),t.logUnityOpenFile=f(a.ActionType.UNITY_OPEN),t.logOpenPathUrl=g(a.ActionType.OPEN_DIR),t.logOpenSharedLinkUrl=g(a.ActionType.VIEW_SHARED_LINK),t.logCommentFile=f(a.ActionType.COMMENT),t.logDownloadFile=g(a.ActionType.DOWNLOAD),t.logOpenVersions=f(a.ActionType.VERSIONS),t.logViewInFolder=g(a.ActionType.VIEW_IN_FOLDER),t.logRequestFailed=function(e,t){n.logRequestFailed(e,{failure_type:t?t.status:-1,is_paginated:!1})},t.startRequestTimer=function(){const e=m.getRecentsLoggingData();return(t,s={})=>v(t,e,s)},t.logRecentsLoaded=v,t.logRecentActivityAction=y,t.openTab=function(e,t,s,i){d.logAndNavigate(e,()=>y(t,s,i),d.NavigationMethod.NEW_TAB)},t.openUnsafeTab=function(e,t,s,i){d.logAndNavigate(e,()=>y(t,s,i),d.NavigationMethod.UNSAFE_NEW_TAB)},t.openUrl=function(e,t,s,i){if(u.shouldUseReactRouter()){const o=h.URI.parse(e).getPath();y(t,s,i),p.getBrowserHistory().push(o)}else d.logAndNavigate(e,()=>y(t,s,i),d.NavigationMethod.REDIRECT)}})),define("metaserver/static/js/home/recents/recent_activity_starred_post_tti",["require","exports","metaserver/static/js/starred/constants","metaserver/static/js/starred/actions","metaserver/static/js/home/recents/recent_activity_federated_model","metaserver/static/js/home/store","metaserver/static/js/home/recents/recent_activity_starred","metaserver/static/js/flux/dispatcher"],(function(e,t,s,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchStarredStatus=t.setStarredStatusOfPaperRecentItems=void 0,t.setStarredStatusOfPaperRecentItems=function(e){e.length&&a.Dispatcher.dispatch({type:s.StarredActionTypes.SET_STATUS,starredStatuses:e.map(e=>new o.FederatedRecentItem(e).getStarredStatus())})},t.fetchStarredStatus=function(e){const t=n.getIdTypePairsByRecentActivityItems(e);t.length&&i.StarredActions.fetchStatuses(r.getRole(),t,!0)}})),define("metaserver/static/js/home/recents/store_utils_post_tti",["require","exports","tslib","lodash","metaserver/static/js/modules/core/i18n","metaserver/static/js/home/recents/stores/attachment_store","metaserver/static/js/modules/core/notify","metaserver/static/js/home/recents/recent_activity_dispatcher","metaserver/static/js/home/recents/recent_activity_client_post_tti","metaserver/static/js/home/recents/recent_activity_constants","metaserver/static/js/home/store","metaserver/static/js/modules/core/exception","metaserver/static/js/home/post_tti/unity_post_tti","metaserver/static/js/home/recents/store_utils","metaserver/static/js/home/recents/recent_activity_logger_utils_post_tti"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h){"use strict";function _(e,t,i=c.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS){return s.__awaiter(this,void 0,void 0,(function*(){return(yield f(e,t,i)).attachments}))}Object.defineProperty(t,"__esModule",{value:!0}),t.loadRecentItems=t.loadPaperRecentItems=t.ensureAttachmentsWithRetryStatus=t.ensureAttachments=void 0,i=s.__importStar(i),t.ensureAttachments=_;const g=[c.EnsureAttachmentsPurpose.LOAD_REMAINING_ATTACHMENTS,c.EnsureAttachmentsPurpose.RECENTS_JSON_CONTINUATION];function f(e,t,p=c.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS,h=!1){return s.__awaiter(this,void 0,void 0,(function*(){const _=r.getAttachmentStore().getByIds(e),v=_.filter(e=>!e.isLoaded).map(e=>e.id);if(v.length){if(r.getAttachmentStore().areSomeActivityKeysPending(v))return yield new Promise((s,i)=>{const o=r.getAttachmentStore().addListener(()=>{r.getAttachmentStore().areSomeActivityKeysPending(v)||(o(),f(e,t,p,!0).then(s,i))})});if(p>0){try{yield(function(e){return s.__awaiter(this,void 0,void 0,(function*(){a.recentActivityDispatcher.dispatch({type:c.ADD_PENDING_ACTIVITY_KEYS,activityKeys:e});const t=r.getAttachmentStore().groupIdsByEncryptedToken(e),o=d.getUserId();let n={},m=0;yield Promise.all(i.map(t,(e,t)=>s.__awaiter(this,void 0,void 0,(function*(){try{n=Object.assign(Object.assign({},n),yield l.activityGenerateJson(o,e,t))}catch(t){a.recentActivityDispatcher.dispatch({type:c.REMOVE_PENDING_ACTIVITY_KEYS,activityKeys:e}),m++}})))),a.recentActivityDispatcher.dispatch({type:c.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY,rawRelatedActivitiesByKey:n,userId:o});const p=i.filter(n,e=>!(!e.ns_id||!e.ns_path)).map(({ns_id:e,ns_path:t})=>({ns_id:e,ns_path:t,bytes:0,isDeleted:!1}));if(p.length&&(u.getUnityFeatures().then(e=>{e&&e.check_file_batch(p,o,null).then(e=>{a.recentActivityDispatcher.dispatch({type:c.RECEIVE_CAN_OPEN_INFO,canOpenInfo:e})})}),l.checkFileInRootCollection(o,p).then(e=>a.recentActivityDispatcher.dispatch({type:c.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO,fileInRootCollectionInfo:e}))),m)throw new Error(`${m} activityGenerateJson failures`)}))})(v)}catch(e){}return yield f(e,t,p-1,!0)}throw m.reportStack("retry attempts depleted",{severity:m.SEVERITY.NONCRITICAL,exc_extra:{attachmentIds:e,purpose:t}}),g.indexOf(t)<0&&n.Notify.error(o.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),new Error("retry attempts depleted")}return{attachments:_,isRetry:h}}))}function v(){return s.__awaiter(this,void 0,void 0,(function*(){return{logRecentsLoaded:h.logRecentsLoaded,ensureAttachments:_,logRequestFailed:h.logRequestFailed,loadPaperRecentItems:y}}))}function y(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=l.retrievePaperRecents(d.getUserId(),e);p.handleRetrievePaperRecentsPromise(v,yield t,e)}))}t.ensureAttachmentsWithRetryStatus=f,t.loadPaperRecentItems=y,t.loadRecentItems=function(e){return p.logErrorAndRethrowAsync(v,()=>s.__awaiter(this,void 0,void 0,(function*(){return p.handleAndLogRecentsJsonPromise(v,yield l.recentsJson(d.getUserId(),e),!e)})))}})),define("metaserver/static/js/home/resource/actions_post_tti",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/home/store","metaserver/static/js/home/resource/store","metaserver/static/js/modules/clean/referrer_cleansing_redirect","metaserver/static/js/modules/constants/python","metaserver/static/js/modules/clean/react/file_viewer/controller","metaserver/static/js/modules/core/browser","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/home/api","metaserver/static/js/home/post_tti/props_post_tti","metaserver/static/js/modules/core/uri","metaserver/static/js/cloud_docs/preferred_editor_utils","metaserver/static/js/cloud_docs/constants","metaserver/static/js/cloud_docs/utils","metaserver/static/js/cloud_docs/types","metaserver/static/js/modules/core/browser","metaserver/static/js/cloud_docs/event_logging","spectrum/util/uuid_generator","metaserver/static/js/plusplus/logging","metaserver/static/js/pnm/utils","metaserver/static/js/plusplus/file_actions","metaserver/static/js/home/post_tti/props_post_tti"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h,_,g,f,v,y,E,b,S,T,I,j){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openInFileViewer=t.createAutoShareLink=void 0,a=s.__importStar(a),y=s.__importStar(y),t.createAutoShareLink=function(e,t){const s=new h.URI({path:"/sm/create"+m.normalize(t)});s.updateQuery("_subject_uid",e.id.toString()),s.updateQuery("redirect","0"),u.makeRequest({url:s.toString(),type:"POST",data:null,dataType:"text"}).then(e=>d.redirect(e))},t.openInFileViewer=function(e,t,s){const d=n.getHomeResourceStore().addListener((function(){const e=n.getHomeResourceStore().getFileToPreview();if(e){const n=(function(e){var t,s;if("cloud_doc"===(null===(s=null===(t=e.preview)||void 0===t?void 0:t.content)||void 0===s?void 0:s[".tag"])){return e.preview.content.exit_url}})(e),m=r.getHomeStore().getUser();if(n)if(t(),d(),g.POINTER_EXTS.includes(f.getFileExt(e).slice(1)))a.safe_open_tab_and_redirect(n),E.logUserAction({actionEvent:v.UserActionEventType.PRE_OPEN,userId:m.id,docPathOrId:e.file_id,actionSource:v.UserActionSourceType.WEB_HOME});else{const t=b.generateUUID("web_open_id"),s=h.URI.parse(n).updateQuery("web_open_id",t).toString();y.open_tab(s),E.logUserAction({actionEvent:v.UserActionEventType.PRE_OPEN,userId:m.id,docPathOrId:e.file_id,actionSource:v.UserActionSourceType.WEB_HOME,data:{webOpenId:t}})}else{const r=()=>(function(e,t,s,r){window.requestAnimationFrame(()=>{if(c.isShown())c.updateFiles([e]);else{const s="/recents"===location.pathname?l.FileViewOriginType.RECENTS:"/starred"===location.pathname?l.FileViewOriginType.STARRED:l.FileViewOriginType.HOME;c.open([e],0,t,"react-file-viewer",{canClose:!0,oref:l.OREF_CONSTANTS.HOME,fileViewTarget:l.FileViewTargetType.PRIVATE,fileViewOrigin:s,fileViewAction:l.FileViewActionType.CLICK,onClose:()=>i.Dispatcher.dispatch({type:o.HomeActionTypes.CLOSE_FILE_VIEWER})}),i.Dispatcher.dispatch({type:o.HomeActionTypes.OPEN_FILE_VIEWER})}s(),r()})})(e,m,t,d);e.hasOwnProperty("per_node_metadata")&&T.isSupportedLinkNodeClickAction(e.per_node_metadata)?I.handleLinkNodeAction(e.per_node_metadata,e=>{S.logProductAnalytics(m.id,"web","select",e,"home")}):!s&&_.hasPreferredEditorSupport(e)?window.RUNNING_IN_EDISON?j.getPostTTIPropsInEdison().then(t=>{const{preferredEditors:s}=t;_.openInPreferredEditor(m,e,s,r,{fileViewAction:l.FileViewActionType.CLICK,fileViewOrigin:l.FileViewOriginType.HOME}),d()}):p.getPostTTIProps().then(t=>{const{preferredEditors:s}=t;_.openInPreferredEditor(m,e,s,r,{fileViewAction:l.FileViewActionType.CLICK,fileViewOrigin:l.FileViewOriginType.HOME}),d()}):r()}}}));i.Dispatcher.dispatch({type:o.HomeResourceStoreActionTypes.REQUEST_PREVIEW,resourceId:e})}})),define("metaserver/static/js/home/resource/api_post_tti",["require","exports","metaserver/static/js/home/api"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileMetadata=void 0,t.getFileMetadata=function(e,t){return s.makeRequest({url:"/home_feed/get_file_metadata",type:"POST",subject_user:e.id,data:{resources_json:JSON.stringify(t)}},{isBackground:!0})}})),define("metaserver/static/js/home/roots/file_uploader",["require","exports","tslib","react","metaserver/static/js/file_uploader/upload_controller","metaserver/static/js/file_uploader/upload_kit_provider"],(function(e,t,s,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileUploader=void 0,i=s.__importDefault(i);t.FileUploader=e=>i.default.createElement(r.UploadKitProvider,{chooseDestination:!0,user:e.user},i.default.createElement(o.UploadController,Object.assign({},e)))})),define("metaserver/static/js/home/roots/home_access_web_post_tti",["require","exports","tslib","metaserver/static/js/modules/clean/history","metaserver/static/js/modules/clean/upsell/prompt_event_emitter"],(function(e,t,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.homeAccessWebComponentDidMount=void 0,i=s.__importDefault(i),t.homeAccessWebComponentDidMount=function(t){return s.__awaiter(this,void 0,void 0,(function*(){i.default.remove_query_param("role"),o.promptBufferedEventEmitter.on(o.Events.ON_PROMPT_INITIALIZED,i=>s.__awaiter(this,void 0,void 0,(function*(){if((!i||!i.didMainCampaignLoad()&&!i.didCampaignForUserEducationLoad())&&t){const{postTTINCCTReminderModal:t}=yield new Promise((t,s)=>{e(["metaserver/static/js/ncct/ui/post_tti_ncct_modal"],t,s)}).then(s.__importStar);t()}})))}))}})),define("metaserver/static/js/home/starred/actions_post_tti",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/resource/api_post_tti","metaserver/static/js/starred/id_type_pair","metaserver/static/js/home/constants","metaserver/static/js/home/store","metaserver/static/js/home/starred/constants","metaserver/static/js/home/starred/api_post_tti","metaserver/static/js/home/starred/actions"],(function(e,t,s,i,o,r,n,a,l,c,d){"use strict";function m(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.map(e=>e.idTypePair);if(0===t.length)return;const s=yield o.getFileMetadata(a.getUser(),t),l={};s.forEach(e=>l[r.idTypePairToString(e)]=e.file_metadata),i.Dispatcher.dispatch({type:n.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:l})}))}Object.defineProperty(t,"__esModule",{value:!0}),t.getStarredStatusMetadata=t.loadAllStarredItems=void 0,t.loadAllStarredItems=function(){return s.__awaiter(this,void 0,void 0,(function*(){let e;i.Dispatcher.dispatch({type:l.StarredResourceActionTypes.LOADING_ALL});try{e=yield c.retrieveStarred(l.LOAD_ALL_ITEMS_COUNT)}catch(e){throw d.onRetrieveStarredError(l.StarredLoadingTypes.ALL,e)}d.StarredActions.handleRetrieveStarredPayload(()=>Promise.resolve({getStarredStatusMetadata:m}),l.StarredLoadingTypes.ALL,e)}))},t.getStarredStatusMetadata=m})),define("metaserver/static/js/home/starred/starred_item_file_action_post_tti",["require","exports","tslib","react","metaserver/static/js/app_actions/app_actions_menu","metaserver/static/js/modules/clean/react/extensions/data/types","metaserver/static/js/home/recents/models/utils","metaserver/static/js/home/resource_id_types","metaserver/static/js/home/util/file_utils"],(function(e,t,s,i,o,r,n,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredItemFileActionPost=void 0,i=s.__importDefault(i);class c extends i.default.PureComponent{constructor(e){super(e),this.onActionDropdownOpen=()=>{this.setState({isActionDropdownOpen:!0})},this.onActionDropdownClose=()=>{this.setState({isActionDropdownOpen:!1})},this.state={isActionDropdownOpen:!1}}render(){const{starredItem:e,user:t}=this.props;if(e.idType!==a.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID||!t.id||!e.title)return null;const s=l.getFileFromPartial({file_id:e.resourceId,fq_path:e.details.fqPath||void 0,ext:n.getExtension(e.title)});return i.default.createElement(o.UnconnectedExtensionsMenu,{className:"starred-item__file-actions",file:s,user:this.props.user,onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,telemetryContext:{surface:"home_starred"},triggerType:r.TriggerType.OpacityButton})}}t.StarredItemFileActionPost=c,c.displayName="StarredItemFileActionPost"})),define("metaserver/static/js/home/util/file_utils",["require","exports","metaserver/static/js/browse/models"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileFromPartial=void 0;const i={bytes:1024,direct_blockserver_link:"",event_type:0,ext:"",file_id:"",fq_path:"",has_automated_rule:!1,href:"",icon:"",is_cloud_doc:!1,is_dir:!1,is_in_team_folder_tree:!1,is_in_vault_folder:!1,is_symlink:!1,is_locked:!1,is_unmounted:!1,is_versionable:!0,_mount_access_perms:[],ns_id:0,ns_path:"",revision_id:"",sjid:0,sort_key:[""],target_ns:null,type:1};t.getFileFromPartial=function(e){return e&&Object.keys(e).forEach(t=>{void 0===e[t]&&delete e[t]}),new s.File(e?Object.assign(Object.assign({},i),e):i)}})),define("metaserver/static/js/home/util/logging/availability_logger_post_tti",["require","exports","tslib","lodash","metaserver/static/js/home/constants","metaserver/static/js/home/api","metaserver/static/js/home/store","metaserver/static/js/home/util/logging/availability_logger_common"],(function(e,t,s,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logHomeAvailability=void 0,i=s.__importStar(i),t.logHomeAvailability=function({sectionToTTI:e,sectionToIsSkipped:t,sectionToTTData:s,typeToExecutionData:l}){const c={};Object.keys(o.HomeSections).forEach(i=>{const r=o.HomeSections[i];c[r]={tti:e[r],tt_data:s[r],skipped:t[r]}});const d=n.getHomeStore(),m=d.getUser();r.makeRequest({url:"/log/home_availability",type:"POST",dataType:"text",subject_user:m.id,data:{success:i.values(l).every(e=>e.success||!a.isPendingPrefetch(d,e)),metrics_json:JSON.stringify({referrer:document.referrer}),sections_json:JSON.stringify(c),prefetches_json:JSON.stringify(i.mapValues(l,(e,t)=>{const{success:s,homeTiming:i}=e,o=a.HOME_PREFETCH_TYPE_TO_INFO[t].section;return Object.assign(Object.assign({},i),{conditional_loading_preference:d.getSectionLoadingPreference(o),conditional_loading_mode:d.getSectionLoadingMode(o),success:!!s})}))}},{isBackground:!0,delayRequest:!0,shouldAssertResponse:!0})}})),define("metaserver/static/js/modules/clean/react/radio",["require","exports","tslib","classnames","react","react-dom"],(function(e,t,s,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadioGroup=t.RadioItem=t.RadioItemVariant=void 0,i=s.__importDefault(i),o=s.__importDefault(o),r=s.__importStar(r),t.RadioItemVariant={Normal:"normal",Large:"large"};const n=Object.keys(t.RadioItemVariant).map(e=>t.RadioItemVariant[e]);class a extends o.default.Component{constructor(){super(...arguments),this._handleClick=()=>{this._isSelected()||(r.findDOMNode(this.refs.input).focus(),"function"==typeof this.props._radioGroupData.onSelect&&this.props._radioGroupData.onSelect(this.props.value))},this._handleChange=()=>{"function"==typeof this.props._radioGroupData.onSelect&&this.props._radioGroupData.onSelect(this.props.value)},this._getId=()=>this.props._radioGroupData.name+"_"+this.props.value,this._isSelected=()=>this.props._radioGroupData.radioGroupValue===this.props.value}render(){const e=this.props._radioGroupData,s=["c-radio-wrapper",this.props.className],r={"c-radio":!0,"c-radio--selected":this._isSelected()};return Array.from(n).includes(e.variant)&&e.variant!==t.RadioItemVariant.Normal&&(r[`c-radio--${e.variant}`]=!0),o.default.createElement("div",{className:i.default(s),onClick:this._handleClick},o.default.createElement("input",{id:this._getId(),ref:"input",type:"radio",name:e.name,value:this.props.value,checked:this._isSelected(),onChange:this._handleChange}),o.default.createElement("div",{className:i.default(r)},o.default.createElement("div",{className:"c-radio__inner"})),o.default.createElement("label",{className:"c-radio-content",htmlFor:this._getId()},this.props.children))}}t.RadioItem=a,a.displayName="RadioItem";class l extends o.default.Component{constructor(){super(...arguments),this._onRadioItemSelect=e=>{null!=this.props.valueLink&&this.props.valueLink.requestChange(e)}}render(){const e=this.props.name||`radio-${Math.floor(1e9*Math.random())}`,t=o.default.Children.map(this.props.children,t=>"RadioItem"===t.type.displayName?o.default.cloneElement(t,{_radioGroupData:{variant:this.props.variant,name:e,radioGroupValue:this.props.valueLink.value,onSelect:this._onRadioItemSelect}}):t),s={"c-radio-group__legend":!0,"ax-visually-hidden":!this.props.displayLegend},r=["c-radio-group",`align-${this.props.align}`,this.props.className];return o.default.createElement("fieldset",{className:i.default(r)},o.default.createElement("legend",{className:i.default(s)},this.props.legend),t)}}t.RadioGroup=l,l.displayName="RadioGroup",l.defaultProps={className:"null",type:t.RadioItemVariant.Normal,align:"middle",displayLegend:!1}})),define("metaserver/static/js/modules/clean/sharing/wizard/share_a_folder_wizard_modal",["require","exports","tslib","react","metaserver/static/js/components/ui/css","metaserver/static/js/modules/clean/viewer","metaserver/static/js/modules/core/i18n","dig-components/modal","dig-components/buttons","dig-components/controls","spectrum/label/index"],(function(e,t,s,i,o,r,n,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareAFolderWizardModal=void 0,i=s.__importDefault(i);class m extends i.default.Component{constructor(){super(...arguments),this.state={option:"new-folder",open:!0},this.getTitle=e=>n.intl.formatMessage({id:"FSaAWD",defaultMessage:"Share a folder from your {team_name} Dropbox"},{team_name:"work"===e?r.Viewer.get_viewer().team_name:"personal"}),this.title=this.getTitle(this.props.user.role),this.onSubmit=()=>this.props.onSubmit(this.state.option),this.onModalReady=()=>{this.focusOnRadioButton()},this.closeModal=()=>{this.setState({open:!1})},this.renderSpectrumContent=()=>i.default.createElement("form",{className:"shared-folder-wizard__contents"},this._renderHeader(),this.renderSpectrumRadio()),this._renderHeader=()=>i.default.createElement("div",{className:"shared-folder-wizard__header u-mar-bottom-s"},n.intl.formatMessage({id:"uf8ArB",defaultMessage:"What would you like to do?"})),this.renderSpectrumRadio=()=>i.default.createElement("div",{className:"shared-folder-wizard__radio-group"},this.renderRadioOptionWithLabel("new-folder",n.intl.formatMessage({id:"xve3fd",defaultMessage:"I’d like to create and share a new folder"})),this.renderRadioOptionWithLabel("existing-folder",n.intl.formatMessage({id:"sFfjOe",defaultMessage:"I’d like to share an existing folder"}))),this.renderRadioOptionWithLabel=(e,t)=>i.default.createElement("div",{className:"shared-folder-wizard__audience-input u-mar-bottom-xs"},i.default.createElement(d.Label,{htmlFor:e,key:`${e}-label`},i.default.createElement(c.RadioButton,{"aria-checked":this.state.option===e,checked:this.state.option===e,onChange:this.updateOption(e),value:e,id:e}),i.default.createElement("div",{className:`${e}_title u-l-ib u-pad-left-xs`},t))),this.updateOption=e=>()=>this._handleChange(e),this._handleChange=e=>this.setState({option:e})}render(){return i.default.createElement(a.Modal,{open:this.state.open,withCloseButton:"Close",overlayClassName:"shared-folder-wizard__overlay",onRequestClose:this.closeModal,"aria-label":this.title,className:"shared-folder-wizard",title:this.getTitle(this.props.user.role),onAfterOpen:this.onModalReady},i.default.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},i.default.createElement(a.Modal.Title,null,this.title)),i.default.createElement(a.Modal.Body,null,this.renderSpectrumContent()),i.default.createElement(a.Modal.Footer,null,i.default.createElement(l.Button,{variant:"primary",onClick:this.onSubmit},n.intl.formatMessage({id:"TbfCYq",defaultMessage:"Next"}))))}focusOnRadioButton(){const e=document.querySelector("input#new-folder");e&&e.focus()}}m.displayName="ShareAFolderWizardModalNoCss",t.ShareAFolderWizardModal=o.requireCssWithComponent(m,["/static/css/sharing/wizard_modals-vflY6WFPP.css","/static/css/modal-vflk8wghF.css"])})),define("metaserver/static/js/modules/clean/sharing/wizard/share_existing_folder_wizard_modal",["require","exports","tslib","react","metaserver/static/js/components/ui/css","metaserver/static/js/modules/clean/viewer","metaserver/static/js/modules/core/i18n","dig-components/modal","dig-components/buttons","metaserver/static/js/folder_dialog/folder_picker_dig","metaserver/static/js/folder_dialog/api","metaserver/static/js/modules/clean/web_timing_logger"],(function(e,t,s,i,o,r,n,a,l,c,d,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareExistingFolderWizardModal=void 0,i=s.__importDefault(i),m=s.__importStar(m);const u=e=>i.default.createElement("div",{className:"u-l-fr"},i.default.createElement(l.Button,{variant:"primary","data-testid":"next_button",disabled:e.disabled,onClick:e.onSubmit},n.intl.formatMessage({id:"n11jli",defaultMessage:"Next"})));u.displayName="PrimaryButton";class p extends i.default.Component{constructor(){super(...arguments),this.state={open:!0},this.getTitle=e=>{switch(e){case"work":return n.intl.formatMessage({id:"/+wDxa",defaultMessage:"Choose a folder from your {team_name} Dropbox"},{team_name:r.Viewer.get_viewer().team_name});case"personal":return n.intl.formatMessage({id:"Xvzici",defaultMessage:"Choose a folder from your personal Dropbox"})}},this.onModalCloseClick=()=>{this.setState({open:!1})},this.renderSpectrumContent=()=>i.default.createElement("form",{className:"existing-shared-folder-wizard__contents folder-picker-dig-container"},this._renderError(),this._renderFolderPicker()),this._renderError=()=>{if(null!=this.state.folderPath&&(null!=this.state.errorMsg?this.state.errorMsg.length:void 0)>0)return i.default.createElement("div",{className:"text-input-error-wrapper"},i.default.createElement("div",{className:"text-input-error-text u-font-danger"},this.state.errorMsg))},this._setFolderPickerPath=e=>this.setState({folderPath:e,errorMsg:void 0}),this._renderFolderPicker=()=>i.default.createElement(c.FolderPicker,{user:this.props.user,webTimer:m.get_timer(),onFolderSelected:this._setFolderPickerPath,rootName:r.Viewer.get_role_title(this.props.user)||n.intl.formatMessage({id:"mSjmSo",defaultMessage:"Dropbox"}),canSelectReadonly:!1,apiClient:{getFolderContents:d.getFolderContentsAPIv2}}),this.onSubmit=e=>("function"==typeof e.nativeEvent.preventDefault&&e.nativeEvent.preventDefault(),this.props.onSubmit(this.state.folderPath,this._setError)),this.onBack=()=>(this.setState({open:!1}),this.props.onBack&&this.props.onBack()),this._setError=e=>{var t;return this.setState({errorMsg:null===(t=null==e?void 0:e.path)||void 0===t?void 0:t.message_text})},this._isValid=()=>!!this.state.folderPath&&(!this.state.errorMsg&&"/"!==this.state.folderPath)}render(){return i.default.createElement(a.Modal,{onRequestClose:this.onModalCloseClick,overlayClassName:"existing-shared-folder-wizard__overlay","aria-label":n.intl.formatMessage({id:"itH+AR",defaultMessage:"Shared Existing Folder Modal"}),className:"existing-shared-folder-wizard folder-picker-modal",open:this.state.open,withCloseButton:"Close",title:this.getTitle(this.props.user.role)},i.default.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},i.default.createElement(a.Modal.Title,null,this.getTitle(this.props.user.role))),i.default.createElement(a.Modal.Body,{className:"folder-picker-container__fixed-height",hasVerticalSpacing:!1},this.renderSpectrumContent()),i.default.createElement(a.Modal.Footer,null,i.default.createElement(l.Button,{variant:"opacity",onClick:this.onBack},n.intl.formatMessage({id:"mYtVp8",defaultMessage:"Back"})),i.default.createElement(u,{disabled:!this._isValid(),onSubmit:this.onSubmit})))}}p.displayName="ShareExistingFolderWizardModalNoCss",t.ShareExistingFolderWizardModal=o.requireCssWithComponent(p,["/static/css/sharing/wizard_modals-vflY6WFPP.css"])})),define("metaserver/static/js/modules/clean/sharing/wizard/wizard_modals",["require","exports","tslib","react","metaserver/static/js/css/css","metaserver/static/js/account/email","metaserver/static/js/account/email_verify_reasons","metaserver/static/js/modules/clean/analytics","metaserver/static/js/deprecated_ajax/ajax_form_extract_errors","metaserver/static/js/components/ui/modal","metaserver/static/js/modules/clean/sharing/api","spectrum-sharing/utils/sharing_constants","metaserver/static/js/modules/clean/sharing/share_modal_util","metaserver/static/js/modules/clean/sharing/ui_notifications_util","metaserver/static/js/modules/clean/sharing/wizard/share_a_folder_wizard_modal","metaserver/static/js/modules/clean/sharing/wizard/share_existing_folder_wizard_modal","metaserver/static/js/modules/clean/sharing/async_share_modal_util","metaserver/static/js/modules/clean/web_user_action_events","metaserver/static/js/modules/clean/web_user_action_logger","metaserver/static/js/flows/utils/exposure_logger","metaserver/static/js/browse/data/store","metaserver/static/js/browse/data/selectors"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h,_,g,f,v,y,E,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showShareAFolderWizardModal=t.shareExistingFolder=void 0,i=s.__importDefault(i),o=s.__importStar(o);const S=function(e,t,s,i){return new d.SharingApi(e).validate_shareable_existing_sf_path(t,(function(){return g.asyncShowShareModal(e,{fqPath:t,isFolder:!0,exists:!0,origin:m.SHARE_ACTION_ORIGIN_TYPE.WIZARD,modalSessionId:null!=i?i:void 0})}),(function(e){const t=l.extractErrors(e.responseText);return!1===t?void 0:"string"==typeof t?p.sharingNotificationError(t):"function"==typeof s?s(t):void 0})),Promise.resolve(!0)};t.shareExistingFolder=S;function T(e){if(!r.EmailVerification.get_for_user(e).verified_or_show(n.EmailVerificationReasons.SHARE_FOLDER))return;o.require_css("/static/css/scooter/scooter-scoped-vflRoCzLn.css");const t=u.generateModalSessionId();if(a.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_A_FOLDER_WIZARD",{modalSessionId:t}),e.is_cdm_member){const s=E.getStoreForBrowse(),{expFlowsCoreFolderSetupFlow:i}=b.browsePostTTIExperiments(s.getState());i&&y.logExposure({feature:"flows_adoption_core_folder_setup_flow",variant:i}),g.asyncShowNewFolderShareModal({defaultBasePath:e.cdm_tmf_path,modalSessionId:t,user:e})}else(function(e,t){c.Modal.showInstance(i.default.createElement(h.ShareAFolderWizardModal,{user:e,onSubmit:s=>{null!=t&&a.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_A_FOLDER_WIZARD",{target:s,modalSessionId:t});const o=s.slice(0,s.indexOf("-"));if(v.WebUserActionLog.log(e.id,f.WebUserActionLogEvent.SELECT_FOLDER_TYPE,{folder_type:o}),"new-folder"===s){const s=E.getStoreForBrowse(),{expFlowsCoreFolderSetupFlow:i}=b.browsePostTTIExperiments(s.getState());return i&&y.logExposure({feature:"flows_adoption_core_folder_setup_flow",variant:i}),g.asyncShowNewFolderShareModal({defaultBasePath:e.cdm_tmf_path,modalSessionId:t,user:e})}return"existing-folder"===s?(function(e,t,s){return null!=s&&a.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::BEGIN_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:s}),c.Modal.showInstance(i.default.createElement(_.ShareExistingFolderWizardModal,{user:e,onBack:t,onSubmit:function(t,i){return null!=s&&a.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD",{modalSessionId:s}),S(e,t,(function(...t){return null!=s&&a.SharingExperimentsLogger.log(e.id,"SIMPLIFIED_WIZARD_UI::SUBMIT_SHARE_EXISTING_FOLDER_WIZARD_ERROR",{modalSessionId:s}),i(...Array.from(t||[]))}))}}))})(e,()=>T(e),t):void 0}}))})(e,t);return t}t.showShareAFolderWizardModal=T})),define("metaserver/static/js/home/recommended_members/recommended_member_card",["require","exports","tslib","react","metaserver/static/js/modules/core/user_i18n","dig-components/avatar","dig-components/buttons","dig-components/icons","dig-components/icons/src","metaserver/static/js/components/ui/css","metaserver/static/js/modules/core/i18n"],(function(e,t,s,i,o,r,n,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendedMemberCard=t.RecommendedMemberAvatar=void 0,i=s.__importDefault(i),o=s.__importStar(o);t.RecommendedMemberAvatar=({photoUrl:e,name:t})=>{const s=o.getInitials(t);return i.default.createElement(r.Avatar,{size:"large",src:e||"",backgroundColor:r.avatarColorForUserIdentifier(s)},s)};class m extends i.default.PureComponent{constructor(e){super(e)}componentDidMount(){this.props.onRecommendationCardShown()}render(){const{buttonText:e,onButtonClick:s,recommendationReasons:o,email:r,name:c,onDismissClick:m,photoUrl:u}=this.props,p="recommended-member-card";return i.default.createElement("article",{className:p},i.default.createElement("div",{className:`${p}__top-bar-wrapper`},i.default.createElement("div",{className:`${p}__top-bar`},i.default.createElement("div",{className:`${p}__avatar`},i.default.createElement(t.RecommendedMemberAvatar,{name:c,photoUrl:u})),i.default.createElement("div",{className:`${p}__user-context`},i.default.createElement("span",{className:`${p}__title`},c),i.default.createElement("span",{className:`${p}__email`},r)),i.default.createElement(n.IconButton,{variant:"transparent",className:`${p}__dismiss`,onClick:m},i.default.createElement(a.UIIcon,{src:l.CloseLine,"aria-label":d.intl.formatMessage({id:"KaeLBh",defaultMessage:"Dismiss suggestion"})})))),i.default.createElement("div",{className:`${p}__content`},i.default.createElement("ul",{className:`${p}__suggestion-context`},o.map((e,t)=>i.default.createElement("li",{key:t,className:`${p}__text`},e))),i.default.createElement("div",{className:`${p}__invite`},i.default.createElement(n.Button,{"aria-label":e,onClick:s,variant:"outline"},e))))}}m.displayName="RecommendedMemberCard",m.defaultProps={isLoading:!1},t.RecommendedMemberCard=c.requireCssWithComponent(m,["/static/css/dig-components/index.web-vflkNfl3z.css"])})),define("metaserver/static/js/home/recommended_members/recommended_member_components",["require","exports","tslib","react","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/static_urls","metaserver/static/js/modules/clean/react/image","metaserver/static/js/components/ui/section/section_header"],(function(e,t,s,i,o,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendedMembersEmpty=t.RecommendedMembersHeader=void 0,i=s.__importDefault(i);t.RecommendedMembersHeader=({isHidden:e,buttonAction:t})=>i.default.createElement(a.SectionHeader,{title:o.intl.formatMessage({id:"e9fyCS",defaultMessage:"Suggested members"}),ueName:"recommended",isHidden:e,onToggleHidden:t}),t.RecommendedMembersHeader.displayName="RecommendedMembersHeader";t.RecommendedMembersEmpty=()=>i.default.createElement("article",{className:"recommended-members-empty"},i.default.createElement(n.Image,{className:"recommended-members-empty__img",src:r.static_url("/static/images/home/experiments/illustration_1x-vflq5p19x.png"),srcHiRes:r.static_url("/static/images/home/experiments/illustration_2x-vflGzU5Lp.png"),alt:o.intl.formatMessage({id:"yd60sv",defaultMessage:"happy face"})}),i.default.createElement("p",{className:"recommended-members-empty__text"},o.intl.formatMessage({id:"yzPd3d",defaultMessage:"That’s it for now. Thanks!"}))),t.RecommendedMembersEmpty.displayName="RecommendedMembersEmpty"})),define("metaserver/static/js/home/recommended_members/recommended_members_post_tti",["require","exports","tslib","react","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/viewer","metaserver/static/js/home/recommended_members/recommended_member_components","metaserver/static/js/home/recommended_members/recommended_member_card","metaserver/static/js/api_v2/user_client","metaserver/static/js/modules/clean/analytics","metaserver/static/js/home/recommended_members/utils","metaserver/static/js/home/actions_post_tti","metaserver/static/js/loggers/join_flow_logger"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendedMembers=t.initPrefetchRecommendedMembers=t.MIN_CARD_WIDTH=void 0,i=s.__importDefault(i),t.MIN_CARD_WIDTH=350;t.initPrefetchRecommendedMembers=()=>{};class p extends i.default.Component{constructor(e){super(e),this.logOrigin=u.Source.HOME_RECOMMENDED_MEMBERS,this.onInviteSuccess=e=>{this.hideCard(e)},this.onDismissMemberClick=e=>{const t=this.state.recommendedMembers[e];this.hideCard(e);const s=this.getSubjectUser();if(s){(new l.UserApiV2Client).ns("team_experience").rpc("teammate_suggestions/dismiss",{teammate_id:t.user_id},{subjectUserId:s.id})}c.TeamsWebActionsLogger.log("admin_dismiss_recommended_contact",{user_id:t.user_id,team_id:t.team_id,team_type:t.team_type,prediction_id:t.prediction_id,origin:this.logOrigin})},this.toggleModuleVisibility=()=>{const{isHiddenByUser:e}=this.props;m.setSectionVisibilityPostTTI(this.getSubjectUser().id,{".tag":"recommended_members"},e)},this.hideCard=e=>{const{recommendedMembers:t}=this.state,s=t.slice(0,e).concat(t.slice(e+1));this.setState({recommendedMembers:s})},this.renderCards=e=>{const{cardsToRender:t}=this.state,s=e.slice(0,t).map((e,t)=>i.default.createElement(a.RecommendedMemberCard,{key:e.user_id,recommendationReasons:d.getRecommendationContext(e,this.viewer),buttonText:o.intl.formatMessage({id:"bgAvOC",defaultMessage:"Invite to team"}),email:e.email,name:e.display_name,photoUrl:e.photo_url,onDismissClick:()=>{this.onDismissMemberClick(t)},onButtonClick:()=>{this.onInviteClick(t)},onRecommendationCardShown:()=>{c.TeamsWebActionsLogger.log("admin_display_recommended_contact",{user_id:e.user_id,team_id:e.team_id,team_type:e.team_type,prediction_id:e.prediction_id,origin:this.logOrigin})}}));return i.default.createElement("div",{className:"recommended-members__list"},s)},this.checkCardsToRender=()=>{const{containerWidth:e}=this.props;return e<t.MIN_CARD_WIDTH?0:e<2*t.MIN_CARD_WIDTH?1:2},this.validateBrowserSize=()=>{const{cardsToRender:e}=this.state,t=this.checkCardsToRender();e!==t&&this.setState({cardsToRender:t})},this.viewer=r.Viewer.get_viewer(),this.getSubjectUser()&&(this.actionHandler=new d.RecommendedMembersApiActionsHandler(this.viewer.work_user.id)),this.state={recommendedMembers:[],receivedRecommendations:void 0,suggestId:void 0,cardsToRender:this.checkCardsToRender()}}componentDidMount(){this.actionHandler&&(this.actionHandler.teammateSuggestionsList().then(e=>{const t=e.recommended_members.members,s=t.slice(0,2),i=e.suggest_id;this.setState({recommendedMembers:s,receivedRecommendations:t,suggestId:i}),c.TeamsWebActionsLogger.log("admin_recommendations_shown",{user_id:this.viewer.get_uid_by_role("work"),team_id:this.viewer.team_id,num_recommendation:s.length,number_cards:this.state.cardsToRender,suggest_id:i})}),this.validateBrowserSize(),window.addEventListener("resize",this.validateBrowserSize))}componentWillUnmount(){window.removeEventListener("resize",this.validateBrowserSize)}getSubjectUser(){return this.viewer.work_user}onInviteClick(t){const{recommendedMembers:i}=this.state,o=i[t];new Promise((t,s)=>{e(["metaserver/static/js/modules/clean/teams/invite/modals/invite_confirmation_modal"],t,s)}).then(s.__importStar).then(({showInviteConfirmationModal:e})=>{e({emailsToInvite:[o.email],origin:this.logOrigin,onInviteSuccess:()=>this.onInviteSuccess(t)})}),c.TeamsWebActionsLogger.log("admin_invite_recommended_contact",{user_id:o.user_id,team_id:o.team_id,team_type:o.team_type,prediction_id:o.prediction_id,origin:this.logOrigin})}render(){const{recommendedMembers:e,cardsToRender:t,receivedRecommendations:s}=this.state,{isHiddenByUser:o}=this.props;return 0!==t&&s&&0!==s.length?i.default.createElement("div",{className:"recommended-members"},i.default.createElement(n.RecommendedMembersHeader,{isHidden:o,buttonAction:this.toggleModuleVisibility}),o?null:e.length>0?this.renderCards(e):i.default.createElement(n.RecommendedMembersEmpty,null)):null}}t.RecommendedMembers=p,p.displayName="RecommendedMembers"})),define("metaserver/static/js/home/recommended_members/utils",["require","exports","metaserver/static/js/modules/core/i18n","metaserver/static/js/api_v2/user_client"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRecommendationContext=t.RecommendedMembersApiActionsHandler=void 0;t.RecommendedMembersApiActionsHandler=class{constructor(e){this.teammateSuggestionsList=()=>this.apiClient.rpc("teammate_suggestions/list",void 0,{subjectUserId:this.userId}).then(e=>e),this.apiClient=(new i.UserApiV2Client).ns("team_experience"),this.userId=e}},t.getRecommendationContext=function(e,t){const i=[];return e.same_domain&&i.push(s.intl.formatMessage({id:"ZlxnJ/",defaultMessage:"On your same email domain"})),e.known_collaborator_id===t.get_uid_by_role("work")?i.push(s.intl.formatMessage({id:"RNA89X",defaultMessage:"Works with you a lot"})):0!==e.known_collaborator_id&&e.known_collaborator_display_name&&i.push(s.intl.formatMessage({id:"+f7iaX",defaultMessage:"Works with {collaborator} a lot"},{collaborator:e.known_collaborator_display_name})),e.num_team_shared_members>0&&i.push(s.intl.formatMessage({id:"0SGkpt",defaultMessage:"{count, plural, one{Collaborates with 1 person on your team} other{Collaborates with {count} people on your team}}"},{count:e.num_team_shared_members})),e.num_team_shared_folders>0&&i.push(s.intl.formatMessage({id:"SC1JCB",defaultMessage:"{count, plural, one{In 1 shared folder with you} other{In {count} shared folders with you}}"},{count:e.num_team_shared_folders})),i.slice(0,3)}})),define("metaserver/static/js/home/surface_teams_homepage/home_teams",["require","exports","tslib","react","classnames","metaserver/static/js/home/actions_post_tti","metaserver/static/js/home/store","metaserver/static/js/home/surface_teams_homepage/home_teams_frame","metaserver/static/js/teams/ui/team_discovery/view/home_team_card","metaserver/static/js/home/util/show_hide_link","metaserver/static/js/home/surface_teams_homepage/home_teams_util","metaserver/static/js/home/surface_teams_homepage/home_teams_logger"],(function(e,t,s,i,o,r,n,a,l,c,d,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeams=t.initPrefetchHomeTeams=void 0,i=s.__importDefault(i),o=s.__importDefault(o);t.initPrefetchHomeTeams=()=>{};class u extends i.default.Component{constructor(e){super(e),this.onRequestSubmit=e=>{this.setState({requestSubmitting:!0,userSelectedDbxTeamID:e})},this.onAcceptTeamInvite=e=>{this.setState({joiningTeam:!0});const{teamInvitation:t}=this.state;t?this.actionHandler.onAcceptTeamInvite(t):m.HomeTeamsLogger.getJoinStatus(e)===m.TeamJoinStatus.AUTO_JOIN&&(this.actionHandler.onJoinAutoJoinableTeam(e,this.updateJoinableTeams),this.logger.logClickedJoinForAutoJoinableTeam(e.id,this.state.joinableTeams))},this.onTeamDismiss=e=>{this.setState({dismissingTeam:!0});const{teamInvitation:t,joinableTeams:s}=this.state;this.actionHandler.onUserDismissedTeam(e,s,t).then(t=>{t&&(this.logger.logDismissTeam(e.id),this.setState(Object.assign(Object.assign({},t),{dismissingTeam:!1})))})},this.onCancelPendingRequest=e=>{this.setState({cancellingRequest:!0}),this.actionHandler.onCancelPendingRequest(e,()=>{this.logger.logCancelRequestToJoin("manual",e),this.updateJoinableTeams()})},this.joinTeamHandler=e=>{this.actionHandler.requestToJoin(e,this.logger.getExtraForRequestAccess(e)).then(t=>{t&&this.logger.logClickedReqToJoin(t,e),this.updateJoinableTeams()})},this.updateJoinableTeams=()=>this.actionHandler.getJoinableTeamsList().then(e=>{const t={requestSubmitting:!1,cancellingRequest:!1,joiningTeam:!1,dismissingTeam:!1};if(e){const s=e.joinableTeams.find(e=>"waiting_for_approval"===e.joinTeamRequestState[".tag"]),i=Object.assign(Object.assign(Object.assign({},e),t),{userSelectedDbxTeamID:null==s?void 0:s.dbxTeamId});this.setState(i)}else this.setState(t)}),this.onChangeHomeTeamsVisibility=()=>{const e=!this.props.isHiddenByUser;r.setSectionVisibilityPostTTI(this.userId,{".tag":"teams"},!e)},this.onToggleShowHide=()=>{const e=!this.state.showAll;this.setState({showAll:e}),this.logger.logExpanderClicker()};const t=n.getUser();this.userId=t.id,this.userDomain=-1!==t.email.indexOf("@")?t.email.split("@")[1]:void 0,this.role=n.getRole(),this.logger=new m.HomeTeamsLogger(this.userId,this.role),this.actionHandler=new d.HomeTeamsApiActionsHandler(this.userId),this.numberOfTeamsToDisplay=u.getNumberOfTeamsToDisplay(this.props.numberOfTeams),this.state={joinableTeams:[],requestSubmitting:!1,cancellingRequest:!1,joiningTeam:!1,dismissingTeam:!1,showAll:!1,hasLoadedTeams:!1,userSelectedDbxTeamID:void 0,teamInvitation:void 0,windowWidth:window.innerWidth}}componentDidMount(){this.updateJoinableTeams().then(()=>{this.props.showTeamsLoadingState&&!this.props.isHiddenByUser&&this.logger.logExposedToSETOnHomepage(this.state.joinableTeams,this.state.teamInvitation)}),window.addEventListener("resize",e=>{this.setState({windowWidth:window.innerWidth})})}getHomeTeamCard(e){const{teamInvitation:t}=this.state;return void 0===e?null:i.default.createElement("div",{key:e.id},i.default.createElement(l.HomeTeamCard,{key:e.id,userSelectedDbxTeamID:this.state.userSelectedDbxTeamID,onRequestSubmit:()=>this.onRequestSubmit(e.dbxTeamId),requestSubmitting:this.state.requestSubmitting,cancellingRequest:this.state.cancellingRequest,joiningTeam:this.state.joiningTeam,dismissingTeam:this.state.dismissingTeam,userHasMadeSelection:"waiting_for_approval"===e.joinTeamRequestState[".tag"],team:e,joinTeamHandler:()=>this.joinTeamHandler(e),teamInvitation:void 0!==t&&t.team_id===e.id?t:void 0,onAcceptTeamInvite:()=>this.onAcceptTeamInvite(e),onTeamDismiss:()=>this.onTeamDismiss(e),onCancelPendingRequest:()=>this.onCancelPendingRequest(e),isMobile:this.state.windowWidth<u.DEFAULT_MOBILE_WIDTH,userDomain:this.userDomain}))}renderHomeTeamsContainer(e){if(e)return null;if(!this.state.hasLoadedTeams)return i.default.createElement(a.HomeTeamsSpinner,null);if(0===this.state.joinableTeams.length)return i.default.createElement(a.HomeTeamsEmptyState,null);const{teamInvitation:t,joinableTeams:s,userSelectedDbxTeamID:o,requestSubmitting:r}=this.state;if(void 0!==t){const e=s.find(e=>e.id===t.team_id);return this.getHomeTeamCard(e)}if(void 0!==o&&!r){const e=s.find(e=>e.dbxTeamId===o);return this.getHomeTeamCard(e)}let n=0;const l=this.state.joinableTeams.map(e=>((n<this.numberOfTeamsToDisplay||this.state.showAll)&&this.props.showTeamsLoadingState&&!this.props.isHiddenByUser&&this.logger.logTeamExposedToSETOnHomepage(e),n++,this.getHomeTeamCard(e)));return this.state.showAll||this.state.joinableTeams.length<=this.numberOfTeamsToDisplay?i.default.createElement("ul",{className:"home-teams-list"},l):i.default.createElement("ul",{className:"home-teams-list"},l.slice(0,this.numberOfTeamsToDisplay))}render(){var e;if(!this.props.canRenderItems||!this.props.showTeamsLoadingState||!this.props.showTeamsOnHomepageExperiment)return null;const t=(null===(e=this.state.joinableTeams)||void 0===e?void 0:e.length)-this.numberOfTeamsToDisplay,{isHiddenByUser:s}=this.props,{hasLoadedTeams:r,joinableTeams:n,showAll:l,userSelectedDbxTeamID:d,teamInvitation:m,requestSubmitting:u}=this.state,p=(!r||n.length>0)&&(!l||n.length<=this.numberOfTeamsToDisplay)&&(void 0===d||u)&&void 0===m&&!s,h=t>0&&!s&&!l&&(void 0===d||u)&&void 0===m,_=o.default({"home-teams-frame":p,"home-teams-loading-view":!r,"home-teams-no-list-style":!0});return i.default.createElement(a.HomeTeamsFrame,null,i.default.createElement(a.HomeTeamsHeader,{isHiddenByUser:s,buttonAction:this.onChangeHomeTeamsVisibility,ariaControls:"HomeTeamsSectionID"}),i.default.createElement("div",{className:_,id:"HomeTeamsSectionID"},i.default.createElement("div",{key:"teams"},this.renderHomeTeamsContainer(s)),i.default.createElement("div",{key:"showMore"},h?i.default.createElement(c.ShowHideLink,{hiddenItemCount:t,canLoadMore:!1,onClick:this.onToggleShowHide,isExpanded:l}):null)))}}t.HomeTeams=u,u.displayName="HomeSurfaceExistingTeams",u.DEFAULT_NUM_TEAMS_TO_SHOW=2,u.DEFAULT_MOBILE_WIDTH=480,u.getNumberOfTeamsToDisplay=e=>1===e?1:u.DEFAULT_NUM_TEAMS_TO_SHOW})),define("metaserver/static/js/home/surface_teams_homepage/home_teams_frame",["require","exports","tslib","react","dig-components/progress_indicators","dig-components/typography","metaserver/static/js/components/ui/section/header_tooltip","metaserver/static/js/components/ui/section/section_header","metaserver/static/js/modules/core/i18n"],(function(e,t,s,i,o,r,n,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeamsSpinner=t.HomeTeamsEmptyState=t.HomeTeamsFrame=t.HomeTeamsHeader=void 0,i=s.__importDefault(i);t.HomeTeamsHeader=({isHiddenByUser:e,buttonAction:t,ariaControls:s})=>{const o=l.intl.formatMessage({id:"Cjp7Qo",defaultMessage:"People we think you work with have joined one of these teams."}),r=l.intl.formatMessage({id:"b49shP",defaultMessage:"More info"});return i.default.createElement(a.SectionHeader,{title:l.intl.formatMessage({id:"qB+2aM",defaultMessage:"Join a team"}),ueName:"teams",isHidden:e,onToggleHidden:t,ariaControls:s,infoIcon:i.default.createElement(n.HeaderTooltip,{title:o,size:"standard",label:r})})},t.HomeTeamsHeader.displayName="HomeTeamsHeader";t.HomeTeamsFrame=({children:e})=>i.default.createElement("section",{className:"home-access-section"},e),t.HomeTeamsFrame.displayName="HomeTeamsFrame";t.HomeTeamsEmptyState=()=>i.default.createElement(r.Text,{color:"faint",className:"home-access-section__empty",tagName:"p"},l.intl.formatMessage({id:"MeG6h+",defaultMessage:"That's it for now. We'll suggest teams if we think they might be a good match."})),t.HomeTeamsEmptyState.displayName="HomeTeamsEmptyState";t.HomeTeamsSpinner=()=>i.default.createElement(o.Spinner,{size:"small","aria-valuetext":l.intl.formatMessage({id:"ZV8oAs",defaultMessage:"Loading teams you can join"})}),t.HomeTeamsSpinner.displayName="HomeTeamsSpinner"})),define("metaserver/static/js/home/surface_teams_homepage/home_teams_actions",["require","exports","tslib","react","classnames","metaserver/static/js/modules/core/i18n","dig-components/buttons","dig-components/typography","dig-components/hooks"],(function(e,t,s,i,o,r,n,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeamsCardJoinButtons=void 0,i=s.__importDefault(i),o=s.__importDefault(o);t.HomeTeamsCardJoinButtons=e=>{const{onJoinButtonPress:t,onAcceptTeamInvite:s,onCancelPendingRequest:o}=e.actionHandlers,{cancellingRequest:n,joiningTeam:a,requestSubmitting:l}=e.actionStatus,c=e.actionStatus.isActionInProgress,{askToJoinText:u,cancellingText:p,cancelText:h,declinedText:_,getJoinText:g,joiningText:f,requestingText:v}={askToJoinText:r.intl.formatMessage({id:"7w7C+H",defaultMessage:"Ask to join"}),cancellingText:r.intl.formatMessage({id:"Zzad7F",defaultMessage:"Cancelling..."}),cancelText:r.intl.formatMessage({id:"NCBimA",defaultMessage:"Cancel request"}),declinedText:r.intl.formatMessage({id:"9UmkJy",defaultMessage:"Your request to join was declined"}),getJoinText:e=>e?r.intl.formatMessage({id:"xj5uap",defaultMessage:"Join team"}):r.intl.formatMessage({id:"jggo6V",defaultMessage:"Join team now"}),joiningText:r.intl.formatMessage({id:"lEOstJ",defaultMessage:"Joining..."}),requestingText:r.intl.formatMessage({id:"UFHFaL",defaultMessage:"Requesting..."})};if(l&&e.team.dbxTeamId===e.userSelectedDbxTeamID)return i.default.createElement(d,{disabled:c,onClick:t,teamName:e.team.name,ariaControls:v,teamnameId:e.teamnameId,dataTestId:"team-request-button"},v);if(e.teamHasInvitedUser||"can_auto_join"===e.team.joinTeamRequestState[".tag"]){const t=a?f:g(e.isMobile);return i.default.createElement(d,{disabled:c,onClick:s,teamName:e.team.name,ariaControls:t,teamnameId:e.teamnameId,dataTestId:"team-join-button"},t)}switch(e.team.joinTeamRequestState[".tag"]){case"request_rejected_open":case"request_rejected_dismissed":return i.default.createElement(m,null,_);case"waiting_for_approval":const s=n?p:h;return i.default.createElement(d,{variant:"transparent",disabled:c,onClick:o,teamName:e.team.name,ariaControls:s,teamnameId:e.teamnameId,dataTestId:"cancel-request-button"},s);default:return i.default.createElement(d,{disabled:c,onClick:t,teamName:e.team.name,ariaControls:u,teamnameId:e.teamnameId,dataTestId:"ask-join-button"},u)}},t.HomeTeamsCardJoinButtons.displayName="HomeTeamsCardJoinButtons";const c=e=>i.default.createElement("div",{id:"TeamActionsContainer",className:"home-teams-item__actions"},i.default.createElement("div",{className:"home-teams-item__actions-inner"},e.children));c.displayName="HomeTeamsActionItem";const d=e=>{var t;const s=l.useUniqueId({prefix:"homeTeamActionsButton-"});return i.default.createElement(c,null,i.default.createElement(n.Button,{variant:null!==(t=e.variant)&&void 0!==t?t:"outline",onClick:e.onClick,disabled:e.disabled,"aria-labelledby":o.default(s,e.teamnameId),"aria-controls":e.ariaControls,"data-testid":e.dataTestId,id:s},e.children))};d.displayName="HomeTeamsActionButton";const m=e=>i.default.createElement(c,null,i.default.createElement(a.Text,{tagName:"div",color:"faint"},e.children));m.displayName="HomeTeamsActionInfoText"})),define("metaserver/static/js/teams/ui/team_discovery/view/home_team_card",["require","exports","tslib","react","classnames","metaserver/static/js/modules/core/i18n","spectrum/button/index","spectrum/facepile/index","dig-components/badges","dig-components/icons","dig-components/icons/src","dig-components/typography","dig-components/hooks","metaserver/static/js/teams/ui/team_discovery/data/utils","metaserver/static/js/home/surface_teams_homepage/home_teams_util","metaserver/static/js/home/surface_teams_homepage/home_teams_actions","metaserver/static/js/common/uuid"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeamCard=void 0,i=s.__importDefault(i),o=s.__importDefault(o);class f extends i.default.PureComponent{constructor(e){super(e),this.handleJoinButtonPress=()=>{this.props.onRequestSubmit(),this.props.joinTeamHandler()},this.userRequestedToJoinTeam=()=>this.props.userSelectedDbxTeamID===this.props.team.dbxTeamId&&!this.props.requestSubmitting,this.shouldHideDismiss=()=>{const{team:e,teamInvitation:t}=this.props;return"waiting_for_approval"===e.joinTeamRequestState[".tag"]||void 0!==t},this.shouldDisableDismiss=()=>{const{requestSubmitting:e,dismissingTeam:t,cancellingRequest:s,joiningTeam:i}=this.props;return e||t||s||i},this.isRequestDeclined=()=>"request_rejected_open"===this.props.team.joinTeamRequestState[".tag"],this.userCanRequestToJoin=()=>{const{team:e,teamInvitation:t}=this.props,s=e.joinTeamRequestState[".tag"];return!this.userRequestedToJoinTeam()&&void 0===t&&["can_auto_join","approval_required"].includes(s)},this.getTeamActionHandlers=()=>({onJoinButtonPress:this.handleJoinButtonPress,onTeamDismiss:this.props.onTeamDismiss,onCancelPendingRequest:this.props.onCancelPendingRequest,onAcceptTeamInvite:this.props.onAcceptTeamInvite}),this.getTeamActionStatus=()=>new h.TeamActionStatus({requestSubmitting:this.props.requestSubmitting,cancellingRequest:this.props.cancellingRequest,dismissingTeam:this.props.dismissingTeam,joiningTeam:this.props.joiningTeam}),this.getClassNames=()=>{const e=this.userCanRequestToJoin();return{sectionClassNames:o.default({"home-teams-item":!0,"home-teams-item__content":!0,"home-teams-item__approved-stripe":void 0!==this.props.teamInvitation}),teamContentClassNames:o.default({"home-teams-item__team-content":!(this.props.isMobile&&e),"home-teams-item__team-content-mobile":this.props.isMobile&&e}),teamDescriptionContainerClassNames:o.default({"home-teams-item__team-description-container":e}),teamActionsContainerClassNames:o.default({"home-teams-item__team-actions-container":!0,"home-teams-item__team-actions-mobile":this.props.isMobile&&e})}}}render(){const e=this.props.isMobile&&this.isRequestDeclined(),{sectionClassNames:t,teamContentClassNames:s,teamDescriptionContainerClassNames:o,teamActionsContainerClassNames:r}=this.getClassNames(),n=g.generateUUID("team-name-id-");let a;return a=this.userCanRequestToJoin()?i.default.createElement(y,{team:this.props.team,teamnameId:n,showFacepile:this.props.isMobile,showDismissButton:this.props.isMobile,disableDismissButton:this.shouldDisableDismiss(),onDismissClick:this.props.onTeamDismiss,userDomain:this.props.userDomain}):i.default.createElement(T,{team:this.props.team,teamnameId:n,teamInvitation:this.props.teamInvitation,showUserAskedToJoinDescription:this.userRequestedToJoinTeam(),showRequestDeclinedDescription:e,showUserInvitedToTeamDescription:void 0!==this.props.teamInvitation}),i.default.createElement("div",{className:t},i.default.createElement(v,{key:"team-icon"}),i.default.createElement("div",{key:"team-content",className:s},i.default.createElement("div",{key:"team-description",className:o},a),i.default.createElement("div",{key:"team-actions",className:r},i.default.createElement(S,{team:this.props.team,teamnameId:n,userSelectedDbxTeamID:this.props.userSelectedDbxTeamID,teamHasInvitedUser:void 0!==this.props.teamInvitation,isMobile:this.props.isMobile,showFacepile:this.userCanRequestToJoin()&&!this.props.isMobile,showActionButton:!e,hideDismissButton:this.shouldHideDismiss()||this.props.isMobile&&this.userCanRequestToJoin(),disableDismissButton:this.shouldDisableDismiss(),teamActionHandlers:this.getTeamActionHandlers(),teamActionStatus:this.getTeamActionStatus()}))))}}t.HomeTeamCard=f,f.displayName="HomeTeamCard";const v=()=>i.default.createElement("div",null,i.default.createElement("div",{className:"home-teams-item__icon"},i.default.createElement(c.UIIcon,{src:d.TeamLine,size:"standard"})));v.displayName="TeamIcon";const y=e=>i.default.createElement("div",{className:"home-teams-item__team-description"},i.default.createElement(E,{team:e.team,teamnameId:e.teamnameId,showDismissButton:e.showDismissButton,disableDismissButton:e.disableDismissButton,onDismissClick:e.onDismissClick,userDomain:e.userDomain}),e.showFacepile&&i.default.createElement(I,{team:e.team}),i.default.createElement(b,{team:e.team}));y.displayName="TeamSuggestionDescription";const E=e=>{const{getTeamSharesUserDomainText:t}=P();let s=null;e.team.isSameDomain&&e.userDomain&&(s=i.default.createElement("span",{className:"home-teams-item__team-domain-badge"},i.default.createElement(l.AccessoryBadge,null,t(e.userDomain))));let o=null;return e.showDismissButton&&(o=i.default.createElement("span",{className:"home-teams-item__auto-left"},i.default.createElement(j,{onDismissClick:e.onDismissClick,teamnameId:e.teamnameId,hideButton:!1,disableButton:e.disableDismissButton}))),i.default.createElement("div",null,i.default.createElement("span",{className:"home-teams-item__team-name"},i.default.createElement(m.Text,{tagName:"h3",id:e.teamnameId,isBold:!0},e.team.name),o),s)};E.displayName="TeamSuggestionHeader";const b=e=>{const{getLastShareTimeText:t}=P(),s=[],o=p.getSharedContentCountsText(e.team);return o&&s.push(o),e.team.lastShareTimestamp&&s.push(t(e.team.lastShareTimestamp)),0===s.length?null:i.default.createElement("ul",{className:"home-teams-item__team-context-list"},s.map((e,t)=>i.default.createElement(m.Text,{key:t,tagName:"li"},e)))};b.displayName="TeamSuggestionPoints";const S=e=>{const t=!(e.isMobile&&e.hideDismissButton);return i.default.createElement("div",{className:"home-teams-item__avatar-and-actions"},e.showFacepile&&i.default.createElement(I,{team:e.team}),e.showActionButton&&i.default.createElement(_.HomeTeamsCardJoinButtons,{team:e.team,teamnameId:e.teamnameId,userSelectedDbxTeamID:e.userSelectedDbxTeamID,teamHasInvitedUser:e.teamHasInvitedUser,isMobile:e.isMobile,actionStatus:e.teamActionStatus,actionHandlers:e.teamActionHandlers}),t&&i.default.createElement(j,{onDismissClick:e.teamActionHandlers.onTeamDismiss,teamnameId:e.teamnameId,hideButton:e.hideDismissButton,disableButton:e.disableDismissButton}))};S.displayName="TeamActions";const T=e=>{const{getInvitedByText:t,getAskedToJoinText:s,getAdminNamesText:r,requestDeclinedText:n}=P();let a;a=e.showUserInvitedToTeamDescription&&e.teamInvitation?t(e.teamInvitation.inviting_user_name):e.showUserAskedToJoinDescription?s(e.team):e.showRequestDeclinedDescription?n:r(e.team,!1);const l=u.useUniqueId({prefix:"team-description-"});return i.default.createElement("div",{className:"home-teams-item__team-description"},i.default.createElement(m.Text,{tagName:"h3",id:e.teamnameId},e.team.name),i.default.createElement(m.Text,{"aria-labelledby":o.default(e.teamnameId,l),id:l,color:"faint"},a))};T.displayName="TeamShortDescription";const I=e=>{const{getAdminNamesText:t}=P(),s=e.team.members;let o=e.team.membersCount-s.length,r=s.length;o>=1&&(o++,r--);const n=i.default.createElement(a.FacepileMembers,{remainderCount:o>0?o.toString():void 0,remainderTooltipProps:{backgroundColor:"#344063",tooltipContent:i.default.createElement("div",null,`${o} others`)},isRemainderActive:!1,members:s.slice(0,r).map(p.toFacepileMember),avatarSize:24});return i.default.createElement("div",{className:"home-teams-item__facepile-container"},i.default.createElement("span",{className:"home-teams-item__facepile","data-testid":"member-facepile"},n),i.default.createElement("span",{className:"home-teams-item__team-admin"},i.default.createElement(m.Text,{color:"faint"},t(e.team,!0))))};I.displayName="TeamMemberFacepile";const j=e=>{const{dismissButtonLabelText:t}=P(),s=u.useUniqueId({prefix:"dismissButton-"}),r=o.default({"home-teams-item__dismiss-button":!0,"home-teams-item__dismiss-invisible":e.hideButton}),a=o.default({"home-teams-item__actions":!0,"home-teams-item__actions-no-padding":e.hideButton});return i.default.createElement("div",{className:a},i.default.createElement("div",{className:"home-teams-item__actions-inner"},i.default.createElement("div",{className:"home-teams-item__dismiss-container"},i.default.createElement(n.Button,{variant:"styleless",className:r,id:s,onClick:e.onDismissClick,disabled:e.hideButton||e.disableButton,"aria-label":t,"aria-labelledby":o.default(e.teamnameId,s),"data-testid":"team-suggestion-dismiss-button"},i.default.createElement(c.UIIcon,{className:"home-teams__button-background",src:d.CloseLine,size:"standard"})))))};function w(e){const t=new Date(e);return r.intl.formatDate(t,{month:"long",day:"numeric",year:"numeric"})}function P(){return{dismissButtonLabelText:r.intl.formatMessage({id:"1XbVf0",defaultMessage:"Dismiss this team suggestion"}),getAdminNamesText:(e,t)=>p.getAdminNamesStrForTeam(e,t),getAskedToJoinText:e=>e.joinRequestStateDate?r.intl.formatMessage({id:"+4exZC",defaultMessage:"Asked to join on {date}"},{date:w(e.joinRequestStateDate)}):r.intl.formatMessage({id:"ABuPQv",defaultMessage:"Asked to join"}),getInvitedByText:e=>r.intl.formatMessage({id:"As2n1+",defaultMessage:"Invited by {name}"},{name:e}),getLastShareTimeText:e=>p.getLastShareTimeStr(e),getTeamSharesUserDomainText:e=>r.intl.formatMessage({id:"AUEkPL",defaultMessage:"Email match: <span>{emailDomain}</span>"},{span:e=>i.default.createElement("strong",{key:"user-domain"},e),emailDomain:`@${e}`}),requestDeclinedText:r.intl.formatMessage({id:"9UmkJy",defaultMessage:"Your request to join was declined"})}}j.displayName="DismissButton"})),define("metaserver/static/js/home/surface_teams_homepage/home_teams_util",["require","exports","tslib","metaserver/static/js/api_v2/user_client","metaserver/static/js/teams/ui/team_discovery/data/model","metaserver/static/js/modules/core/notify","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/core/uri","metaserver/static/js/teams/ui/team_discovery/data/logger","metaserver/static/js/home/surface_teams_homepage/home_teams_logger","metaserver/static/js/modules/clean/history_singleton"],(function(e,t,s,i,o,r,n,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeamsApiActionsHandler=t.TeamActionStatus=void 0;t.TeamActionStatus=class{constructor({cancellingRequest:e=!1,dismissingTeam:t=!1,joiningTeam:s=!1,requestSubmitting:i=!1}={}){this.cancellingRequest=e,this.dismissingTeam=t,this.joiningTeam=s,this.requestSubmitting=i}get isActionInProgress(){return this.cancellingRequest||this.dismissingTeam||this.joiningTeam||this.requestSubmitting}};class m{constructor(e){this.requestToJoin=(e,t)=>this.apiClient.rpc("joinable_teams/join",{team_id:e.id,dbx_team_id:e.dbxTeamId,extra:t,source:c.HomeTeamsSource},{subjectUserId:this.userId}).then(e=>("request_sent"===e.result[".tag"]||"can_join"===e.result[".tag"]?r.Notify.success(o.JoinApiRetReasonToLabel("request_sent")):r.Notify.error(m.DEFAULT_ERROR_CONTACT_ADMIN),e.result[".tag"])).catch(e=>{r.Notify.error(m.DEFAULT_ERROR_CONTACT_ADMIN)}),this.getJoinableTeamsList=()=>s.__awaiter(this,void 0,void 0,(function*(){return this.apiClient.rpc("joinable_teams/list",{include_user_dismissed_teams:!1,include_user_collab_teams:!0},{subjectUserId:this.userId}).then(e=>({joinableTeams:e.values.map(o.toJoinableTeam),teamInvitation:e.team_invite,hasLoadedTeams:!0})).catch(e=>{r.Notify.error(m.DEFAULT_ERROR_REFRESH_PAGE)})})),this.apiClient=(new i.UserApiV2Client).ns("team_discovery"),this.userId=e}onAcceptTeamInvite(e){const t=new a.URI({path:"/"}).toString(),s={signup_key:e.signup_key,cont:t};d.browserRedirectWrapper(new a.URI({path:"/team/join",query:s}))}onJoinAutoJoinableTeam(e,t){this.apiClient.rpc("joinable_teams/join",{team_id:e.id,dbx_team_id:e.dbxTeamId},{subjectUserId:this.userId}).then(e=>{"can_join"===e.result[".tag"]?d.browserRedirectWrapper(e.result.url):t()})}onUserDismissedTeam(e,t,s){return this.apiClient.rpc("joinable_teams/dismiss",{team_id:e.id,dbx_team_id:e.dbxTeamId},{subjectUserId:this.userId}).then(()=>(this.apiClient.rpc("joinable_teams/list",{include_user_dismissed_teams:!1,include_user_collab_teams:!0},{subjectUserId:this.userId}),{joinableTeams:t.filter(t=>t!==e),teamInvitation:e.id===(null==s?void 0:s.team_id)?void 0:s})).catch(e=>{r.Notify.error(m.DEFAULT_ERROR_REFRESH_PAGE)})}onCancelPendingRequest(e,t){return s.__awaiter(this,void 0,void 0,(function*(){try{yield this.apiClient.rpc("joinable_teams/cancel_join",{team_id:e.id,source:l.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage},{subjectUserId:this.userId}),t()}catch(e){r.Notify.error(m.DEFAULT_ERROR_REFRESH_PAGE)}}))}}t.HomeTeamsApiActionsHandler=m,m.DEFAULT_ERROR_REFRESH_PAGE=n.intl.formatMessage({id:"tbMyDV",defaultMessage:"Something went wrong with the request, please refresh the page"}),m.DEFAULT_ERROR_CONTACT_ADMIN=n.intl.formatMessage({id:"td9Mz6",defaultMessage:"Something went wrong with the request, contact the admin"})})),define("metaserver/static/js/home/surface_teams_homepage/home_teams_logger",["require","exports","metaserver/static/js/modules/clean/analytics","metaserver/static/js/teams/ui/team_discovery/data/logger"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HomeTeamsLogger=t.HomeTeamsSource=t.TeamJoinStatus=void 0;var o;(function(e){e.DENIED="denied",e.APPROVED="approved",e.PENDING="pending",e.DEFAULT="default",e.AUTO_JOIN="can_auto_join"})(o=t.TeamJoinStatus||(t.TeamJoinStatus={})),t.HomeTeamsSource="home";class r{constructor(e,t){this.userId=e,this.role=t}static getJoinStatus(e){switch(e.joinTeamRequestState[".tag"]){case"waiting_for_approval":return o.PENDING;case"request_rejected_open":case"request_rejected_dismissed":return o.DENIED;case"request_approved":return o.APPROVED;case"can_auto_join":return o.AUTO_JOIN;default:return o.DEFAULT}}logExposedToSETOnHomepage(e,t){let i=0,n=0,a=0,l=0;for(const s of e)if((null==t?void 0:t.team_id)===s.id)l++;else{switch(r.getJoinStatus(s)){case o.PENDING:i++;break;case o.DENIED:n++;break;case o.AUTO_JOIN:l++;break;default:a++}}s.TeamsWebActionsLogger.log("exposed_to_set_on_home_page",{num_of_teams:e.length,num_of_pending_teams:i,num_of_denied_teams:n,num_of_approved_teams:l,num_of_default_teams:a},()=>{},this.userId)}logExpanderClicker(){s.TeamsWebActionsLogger.log("clicked_set_on_home_expander",{},()=>{},this.userId)}logTeamExposedToSETOnHomepage(e){s.TeamsWebActionsLogger.log("exposed_to_set_on_home_team_card",{team_id:e.id,join_status:r.getJoinStatus(e),num_team_members:e.membersCount})}logClickedReqToJoin(e,o){s.TeamsWebActionsLogger.log("clicked_req_to_join",{reason:e,account_role:this.role,team_id:o.id,origin:i.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource,join_state:r.getJoinStatus(o),url:"/h",user_plan_type:"basic"},()=>{},this.userId)}getExtraForRequestAccess(e){return{num_team_members:e.membersCount.toString(),user_id:this.userId.toString(),origin:i.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource,team_id:e.id.toString(),url:"/h"}}logClickedJoinForAutoJoinableTeam(e,t){let i=0,n=0;for(const e of t){const t=r.getJoinStatus(e);t===o.AUTO_JOIN?n++:t===o.DEFAULT&&i++}s.TeamsWebActionsLogger.log("clicked_join",{account_role:this.role,team_id:e,url:"/h",num_ask_to_join:i,num_auto_join:n},()=>{},this.userId)}logCancelRequestToJoin(e,o){s.TeamsWebActionsLogger.log("cancel_request_to_join",{reason:e,num_team_members:o.membersCount,origin:i.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource,team_id:o.id},()=>{},this.userId)}logDismissTeam(e){s.TeamsWebActionsLogger.log("dismiss_team",{team_id:e,origin:i.TeamJoinRequestOrigin.SurfaceExistingTeamHomepage,source:t.HomeTeamsSource},()=>{},this.userId)}}t.HomeTeamsLogger=r})),define("metaserver/static/js/modules/clean/upsell/home_inline_location",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/typography","typescript/component_libraries/retrieval-components/src/collapsable-section/index","metaserver/static/js/modules/core/browser","metaserver/static/js/modules/core/i18n","metaserver/static/js/api_v2/user_client","metaserver/static/js/components/ui/section/section_header","metaserver/static/js/modules/core/persistence/storage","metaserver/static/js/modules/clean/upsell/prompt_event_emitter"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=t.HomeInlineContentPromptUI=t.HomeInlineContentPrompt=t.initPrefetchHomeInlineContentPrompt=void 0,i=s.__importDefault(i),o=s.__importDefault(o),l=s.__importStar(l);t.initPrefetchHomeInlineContentPrompt=()=>{};class h extends o.default.PureComponent{constructor(e){super(e),this.state={promptData:null}}listenForPromptData(){p.promptBufferedEventEmitter.on(p.Events.ON_HOME_INLINE_CONTENT_LOADED,e=>{this.setState({promptData:e})})}componentDidMount(){this.listenForPromptData()}render(){const{canRenderItems:e,isOnBrowse:t}=this.props,{promptData:s}=this.state;return e&&s?o.default.createElement(_,Object.assign({isOnBrowse:t},s)):null}}t.HomeInlineContentPrompt=h,h.displayName="HomeInlineContentPrompt";class _ extends o.default.Component{constructor(t){super(t),this.confirmPrompt=e=>{this.callStateManager(t=>{t.onConfirm(e)});const{campaign:t}=this.props,{content:s}=t;l.redirect(s.confirmUrl)},this.dismissPrompt=e=>{this.callStateManager(t=>{t.onDismiss(e)})},this.toggleSectionHidden=()=>{this.setState(e=>{const t=!e.promptBodyHidden,{subjectUser:s}=this.props;return t?u.UserLocalStorage.set(s,this.localStorageItemName,1):u.UserLocalStorage.delete(s,this.localStorageItemName),{promptBodyHidden:t}})};const{subjectUser:i,campaign:o}=t;this.localStorageItemName=`prompt_home_inline_content_hidden_${o.campaignId}`,this.state={isConfirmed:!1,isDismissed:!1,isShown:!1,promptBodyHidden:null!==u.UserLocalStorage.get(i,this.localStorageItemName),renderPrevented:!t.isPreview},this.stateManagerOnload=[],t.isPreview||new Promise((t,s)=>{e(["metaserver/static/js/prompt/ui/campaign_state_manager"],t,s)}).then(s.__importStar).then(e=>{this.stateManager=new e.CampaignStateManager(this);for(const e of this.stateManagerOnload)e(this.stateManager)})}preventRenderUntilSafe(e){var t;return s.__awaiter(this,void 0,void 0,(function*(){const s=(new d.UserApiV2Client).ns("team_discovery"),i=yield s.rpc("joinable_teams/list",{member_to_fetch_limit:1},{subjectUserId:e});if(!!(null===(t=null==i?void 0:i.values)||void 0===t?void 0:t.length))return;const{isOnBrowse:o}=this.props,r=o?".maestro-app-content":".home-access-sections";if(!!document.querySelector(`${r}:hover`)){const e=document.querySelector(r),t=()=>{!!!document.querySelector(`${r}:hover`)&&this.state.renderPrevented&&(this.setState({renderPrevented:!1}),e.removeEventListener("mouseout",t))};e.addEventListener("mouseout",t)}else this.setState({renderPrevented:!1})}))}callStateManager(e){this.props.isPreview||(this.stateManager?e(this.stateManager):this.stateManagerOnload.push(e))}componentDidUpdate(e,t){t.renderPrevented&&!this.state.renderPrevented&&this.callStateManager(e=>{e.onShow()})}componentDidMount(){this.props.isPreview||this.preventRenderUntilSafe(this.props.subjectUser),this.state.renderPrevented||this.callStateManager(e=>{e.onShow()})}render(){const{campaign:e,isOnBrowse:t}=this.props,{content:s}=e,{isDismissed:i,promptBodyHidden:a,renderPrevented:l}=this.state;let c=null;if(!a){const e=s.showDismissButton?o.default.createElement(r.Button,{variant:"transparent",onClick:this.dismissPrompt},s.dismissText):null;c=o.default.createElement(o.default.Fragment,null,o.default.createElement(n.Text,{tagName:"p",className:"home-inline-content-prompt__content"},s.text),o.default.createElement("div",{className:"home-inline-content-prompt__cta"},o.default.createElement(r.Button,{variant:"outline",onClick:this.confirmPrompt},s.confirmText),e))}return o.default.createElement(g,{visible:!l&&!i,isOnBrowse:!!t,title:s.titleText,promptBodyHidden:a,onToggleBodyHidden:this.toggleSectionHidden},t?null:o.default.createElement(m.SectionHeader,{title:s.titleText,ueName:"prompt",isHidden:a,onToggleHidden:this.toggleSectionHidden}),c)}}t.HomeInlineContentPromptUI=_,_.displayName="HomeInlineContentPromptUI";const g=e=>{const{children:t,visible:s,isOnBrowse:r,title:n,promptBodyHidden:l,onToggleBodyHidden:d}=e;return r?o.default.createElement("div",{className:i.default("prompt-inline-content",{"prompt-inline-content__removed":!s})},o.default.createElement(a.CollapsableSection,{title:n,isOpen:!l,onHeaderClick:d,strings:{buttonClose:c.intl.formatMessage({id:"D8K+9v",defaultMessage:"Hide"}),buttonOpen:c.intl.formatMessage({id:"pDnAQ5",defaultMessage:"Show"})},containerClassName:"home-access-section__inline_prompt"},t)):o.default.createElement("section",{className:i.default({"prompt-inline-content":!0,"home-access-section":!0,"home-access-section__content":!0,"home-access-section__inline_prompt":!0,"home-access-section__removed":!s,"prompt-inline-content__removed":!s})},t)};g.displayName="PromptFrame",g.displayName="PromptFrame";t.RootComponent=e=>o.default.createElement(h,Object.assign({},e))})),define("metaserver/static/js/modules/clean/react/tree_view",["require","exports","tslib","classnames","immutable","react","react-dom","lodash","metaserver/static/js/icon/folder_icon","metaserver/static/js/spectrum-content-icon-compatibility/index","jquery","metaserver/static/js/deprecated_ajax/ajax_as_promised_jquery","metaserver/static/js/modules/clean/em_string","metaserver/static/js/modules/clean/filepath/filepath","ts-key-enum","metaserver/static/js/components/ui/css","metaserver/static/js/modules/clean/react/sprite","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/core/notify","metaserver/static/js/modules/clean/react/tree_item","metaserver/static/js/modules/clean/react/tree"],(function(e,t,s,i,o,r,n,a,l,c,d,m,u,p,h,_,g,f,v,y,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserFolderTreeView=t.AdminFolderTreeView=t.PinnedFolderTreeView=t.FolderTreeView=t.RootIcon=t.TreeView=t.TreeItemView=t.INDENT_SIZE_PX=t.MAX_LABEL_LENGTH=void 0,i=s.__importDefault(i),o=s.__importStar(o),r=s.__importDefault(r),n=s.__importStar(n),a=s.__importStar(a),d=s.__importDefault(d),m=s.__importStar(m),t.MAX_LABEL_LENGTH=20,t.INDENT_SIZE_PX=15;class b extends r.default.Component{render(){return r.default.createElement("ul",{className:"tree-view__group",role:"group"},this.props.children)}}b.displayName="TreeGroupView";class S extends r.default.Component{constructor(){super(...arguments),this.handleClick=e=>{if(e.preventDefault(),e.stopPropagation(),this.props.item.disabled)return;const t=n.findDOMNode(this.refs.expandButton);t&&t.contains(e.target)||this.props.onClick&&this.props.onClick(this.props.item)},this.handleExpandClick=e=>{e.preventDefault(),this.props.onExpandButtonClick&&this.props.onExpandButtonClick(this.props.item,!this.props.isExpanded)}}renderExpandButton(){return r.default.createElement("div",{className:"tree-view__expand-button",onClick:this.handleExpandClick,ref:"expandButton",role:"button"},r.default.createElement(g.Sprite,{group:"web",name:this.props.isExpanded?"bullet_minus":"bullet_plus",alt:this.props.isExpanded?f.intl.formatMessage({id:"nPGI06",defaultMessage:"Collapse"}):f.intl.formatMessage({id:"mGnlBs",defaultMessage:"Expand"})}))}renderIcon(){const{item:e}=this.props,{icon:t,disabled:s}=e;return r.default.createElement("div",{className:"tree-view__icon-wrapper"},r.default.createElement(c.IconContent,{className:"tree-view__item-icon",name:l.convertLegacyFolderIconToSpectrum(t,"small"),disabled:s,height:19,width:19}))}render(){const e=!this.props.canExpand,s=i.default({"tree-view__item":!0,"tree-view__item--leaf":e}),o=this.props.canExpand&&!this.props.showAsHeader;return r.default.createElement("li",{key:this.props.item.key,id:this.props.id,className:s,onClick:this.handleClick,role:"treeitem","aria-disabled":this.props.item.disabled,"aria-label":this.props.item.label,"aria-level":this.props.level+1,"aria-selected":!!this.props.isSelected||void 0,"aria-expanded":o?this.props.isExpanded:void 0},r.default.createElement("span",{className:i.default({"tree-view__item-row":!0,"tree-view__item-row--disabled":this.props.item.disabled}),style:{paddingLeft:this.props.showAsHeader?0:this.props.level*t.INDENT_SIZE_PX}},this.props.showAsHeader||e?void 0:this.renderExpandButton(),this.props.item.icon?this.renderIcon():void 0,this.props.item.label?r.default.createElement("span",{className:"tree-view__item-label"},u.Emstring.em_snippet(this.props.item.label,t.MAX_LABEL_LENGTH)):void 0),this.props.children)}}t.TreeItemView=S,S.defaultProps={isSelected:!1,isExpanded:!1,canExpand:!1,level:0,onClick:a.noop,onExpandButtonClick:a.noop,showAsHeader:!1},S.displayName="TreeItemView";class T extends r.default.Component{renderIcon(){return this.props.item.icon?r.default.createElement(g.Sprite,{className:"tree-view__header-icon",group:"web",name:this.props.item.icon,alt:""}):null}render(){return r.default.createElement("div",{className:"tree-view__item-row"},this.renderIcon(),r.default.createElement("h3",{className:"tree-view__header",id:this.props.id},this.props.item.label))}}T.displayName="TreeHeaderView";class I extends r.default.Component{constructor(){super(...arguments),this.state={selectedItemKey:null,expandedItemKeys:o.Set([this.props.tree.rootItem.key]),showFocused:!1},this.selectItem=e=>{this.setState({selectedItemKey:null!=e&&e.key?e.key:null}),this.props.onItemSelected(e)},this.handleExpandButtonClick=(e,t)=>{this.setState({expandedItemKeys:this.setItemExpanded(e.key,t)}),this.props.onItemExpanded(e,t)},this.handleKeyDown=e=>{switch(e.key){case h.Key.ArrowUp:this.advanceSelection(!0)&&e.preventDefault();break;case h.Key.ArrowDown:this.advanceSelection(!1)&&e.preventDefault();break;case h.Key.ArrowRight:if(null!=this.state.selectedItemKey){const t=this.props.tree.items.get(this.state.selectedItemKey);this.canItemExpand(t)&&(this.handleExpandButtonClick(t,!0),e.preventDefault())}break;case h.Key.ArrowLeft:if(this.state.selectedItemKey){const t=this.props.tree.items.get(this.state.selectedItemKey);this.canItemExpand(t)&&(this.handleExpandButtonClick(t,!1),e.preventDefault())}}},this.handleOnFocus=()=>this.setState({showFocused:!0}),this.handleOnBlur=()=>this.setState({showFocused:!1})}componentDidMount(){d.default(n.findDOMNode(this)).on({keydown:this.handleKeyDown})}UNSAFE_componentWillReceiveProps(e){e.resetSelectedItem&&e.resetSelectedItem!==this.props.resetSelectedItem&&this.setState({selectedItemKey:null})}componentWillUnmount(){d.default(n.findDOMNode(this)).off("keydown")}componentDidUpdate(e,t){if(this.state.selectedItemKey&&this.state.selectedItemKey!==t.selectedItemKey){const e=d.default(n.findDOMNode(this)),t=e.find('[aria-selected="true"]').eq(0);t.length&&this.scrollElementIntoViewIfNeeded(t,e)}}scrollElementIntoViewIfNeeded(e,t){const s=t.scrollTop(),i=s+e.position().top;if(i-s<0)return void t.scrollTop(i);const o=t.innerHeight(),r=s+o,n=e.innerHeight();i+n>r&&t.scrollTop(i-o+n)}hasSelectableRootItem(){const{rootStyle:e}=this.props;return e===y.RootStyle.TreeItem||e===y.RootStyle.HeaderItem}getHTMLIdPrefix(){return this.HTMLIdPrefix||(this.HTMLIdPrefix=`tree-view-${Math.floor(16777215*Math.random()).toString(16)}`)}getLastLeafOf(e){const t=this.props.tree.getChildItems(e);return this.state.expandedItemKeys.contains(e.key)&&null!=t&&t.size>0?this.getLastLeafOf(t.last()):e}getPrevItem(e){if(!e)return null;const t=this.props.tree.getParentItem(e);if(!t)return null;const s=this.props.tree.getChildItems(t),i=s.indexOf(e);if(i>0)return this.getLastLeafOf(s.get(i-1));if(0===i){return t===this.props.tree.rootItem&&!this.hasSelectableRootItem()?null:t}return null}getNextItem(e,t=!0){if(!e)return null;const s=this.state.expandedItemKeys.contains(e.key)&&this.props.tree.isParent(e);if(t&&s)return this.props.tree.getChildItems(e).first();const i=this.props.tree.getParentItem(e);if(!i)return null;const o=this.props.tree.getChildItems(i),r=o.size-1,n=o.indexOf(e);return n===r?this.getNextItem(i,!1):0<=n&&n<r&&o.get(n+1)||null}advanceSelection(e=!1){if(!this.state.selectedItemKey){let e;if(this.hasSelectableRootItem())e=this.props.tree.rootItem;else{const t=this.props.tree.getChildItems(this.props.tree.rootItem);e=t?t.first():null}return this.selectItem(e),!0}const t=this.props.tree.items.get(this.state.selectedItemKey),s=e?this.getPrevItem(t):this.getNextItem(t);return!!s&&(this.selectItem(s),!0)}getValidHTMLIdForItem(e){return`${this.getHTMLIdPrefix()}${e.key}`.replace(/\s+/g,"_")}setItemExpanded(e,t){return t?this.state.expandedItemKeys.add(e):this.state.expandedItemKeys.delete(e)}canItemExpand(e){return e&&(e.canExpand||this.props.tree.isParent(e))}renderSingleItem(e,t,s,i={}){const o=Object.assign({id:this.getValidHTMLIdForItem(e),key:e.key,item:e,isSelected:this.state.selectedItemKey===e.key,isExpanded:this.state.expandedItemKeys.contains(e.key)||e.forceExpanded,canExpand:this.canItemExpand(e)&&!e.forceExpanded,level:t,onClick:this.selectItem,onExpandButtonClick:this.handleExpandButtonClick},i),n=this.props.treeItemView;return r.default.createElement(n,Object.assign({},o),s)}renderItemAndDescendants(e,t){let s;const i=this.state.expandedItemKeys.contains(e.key)||e.forceExpanded;return this.props.tree.isParent(e)&&i&&(s=this.renderChildrenOfItemAsGroup(e,t+1)),this.renderSingleItem(e,t,s)}renderChildrenOfItemAsGroup(e,t){if(!e||!this.props.tree.isParent(e))return null;const s=this.props.tree.getChildItems(e).map(e=>this.renderItemAndDescendants(e,t));return r.default.createElement(b,null,s.toJS())}render(){let e,t,s;const{rootItem:o}=this.props.tree;if(this.props.rootStyle===y.RootStyle.TreeItem)t=r.default.createElement(b,null,this.renderItemAndDescendants(o,0));else if(this.props.rootStyle===y.RootStyle.HeaderItem)e=this.getValidHTMLIdForItem(o),t=r.default.createElement(b,null,this.renderSingleItem(o,0,null,{showAsHeader:!0,id:e}),this.renderChildrenOfItemAsGroup(o,0));else if(this.props.rootStyle===y.RootStyle.StaticHeader)e=this.getValidHTMLIdForItem(o),t=r.default.createElement(b,null,r.default.createElement(T,{item:o,id:e}),this.renderChildrenOfItemAsGroup(o,0));else{if(this.props.rootStyle!==y.RootStyle.None)throw new Error(`Unknown root style: ${this.props.rootStyle}`);t=this.renderChildrenOfItemAsGroup(this.props.tree.rootItem,0)}if(this.state.selectedItemKey){const e=this.props.tree.items.get(this.state.selectedItemKey);s=this.getValidHTMLIdForItem(e)}return r.default.createElement("div",{role:"tree",tabIndex:0,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,className:i.default("tree-view","ax-focusable",{"is-focused":this.state.showFocused}),"aria-labelledby":e||void 0,"aria-activedescendant":s},t,this.props.children)}}var j;I.defaultProps={rootStyle:y.RootStyle.None,onItemSelected:e=>{},onItemExpanded:(e,t)=>{},treeItemView:S},I.displayName="TreeViewWithoutCSS",t.TreeView=_.requireCssWithComponent(I,["/static/css/react/tree_view-vfltE0_vb.css","/static/css/accessibility-vfliGZNRm.css"]),(function(e){e.BRIEFCASE="s_briefcase",e.HOUSE="s_house",e.DROPBOX="dropbox"})(j=t.RootIcon||(t.RootIcon={}));const w=e=>new y.FolderTreeItem({key:e.path,label:p.filename(e.path),canExpand:e.has_subdirs,icon:e.icon,disabled:e.read_only},e.contained_ns);class P extends r.default.Component{constructor(){super(...arguments),this._pendingAjaxRequest=null,this._pendingAjaxRequestAbortController=null,this.state={showLoadingScreen:!1,tree:E.Tree.createWithRootItem(new y.TreeItem({key:"/",icon:this.props.rootIcon,label:this.props.treeRootName}))},this.asyncFetchSubFoldersForItem=e=>{var t;const s=e===this.state.tree.rootItem;s&&this.setState({showLoadingScreen:!0}),this._pendingAjaxRequest&&(null===(t=this._pendingAjaxRequestAbortController)||void 0===t||t.abort()),this._pendingAjaxRequestAbortController=new AbortController,this._pendingAjaxRequest=this.props.mkAjaxRequest(e.key,this._pendingAjaxRequestAbortController.signal),Promise.resolve(this._pendingAjaxRequest).then(t=>{const s=this.parseFolderList(t),i=this.state.tree.setChildItems(e,s);this.setState({tree:i})}).catch(this.props.handleError).then(()=>{if(null==this._pendingAjaxRequest)return;this._pendingAjaxRequest=null,s&&(this.props.isLoadingAdditionalData||this.setState({showLoadingScreen:!1}));const e=n.findDOMNode(this.refs.treeView);e&&e.focus()})},this.handleItemSelected=e=>{null!==e&&(e instanceof y.FolderTreeItem?this.props.onFolderSelected(e.key,e.folderNsId,e.icon):this.props.onFolderSelected(e.key,void 0,e.icon))},this.handleExpandButtonClick=(e,t)=>{t&&!this.state.tree.isParent(e)&&this.asyncFetchSubFoldersForItem(e)},this.renderLoadingMessage=()=>r.default.createElement("span",{className:"tree-view__loading-label"},f.intl.formatMessage({id:"9fef95",defaultMessage:"Loading your folders…"}))}componentDidMount(){this.asyncFetchSubFoldersForItem(this.state.tree.rootItem)}UNSAFE_componentWillReceiveProps(e){e.isLoadingAdditionalData||e.isLoadingAdditionalData===this.props.isLoadingAdditionalData||this.setState({showLoadingScreen:!1})}componentWillUnmount(){var e;this._pendingAjaxRequest&&(null===(e=this._pendingAjaxRequestAbortController)||void 0===e||e.abort(),this._pendingAjaxRequest=null)}parseFolderList(e){return e.map(w)}render(){const e=this.props.isRootSelectable?y.RootStyle.HeaderItem:y.RootStyle.StaticHeader;return r.default.createElement(t.TreeView,{ref:"treeView",tree:this.state.tree,rootStyle:e,onItemSelected:this.handleItemSelected,onItemExpanded:this.handleExpandButtonClick,resetSelectedItem:this.props.resetSelectedItem},this.state.showLoadingScreen?this.renderLoadingMessage():void 0)}}P.defaultProps={onFolderSelected:(e,t,s)=>{},handleError(e){v.Notify.error(f.intl.formatMessage({id:"dFFA0Z",defaultMessage:"An error occurred while trying to load your folder."}))}},P.displayName="AbstractFolderTreeView";class O extends P{}t.FolderTreeView=O;class A extends P{parseFolderList(e){let t=-1;const s=e.map((e,s)=>{const i=e.path;return this.props.pinnedFolder&&i===this.props.pinnedFolder&&(t=s),w(e)});if(-1!==t){const e=s[t];s.splice(t,1),s.unshift(e)}return s}}t.PinnedFolderTreeView=A,t.AdminFolderTreeView=function(e){const t=e.mkAjaxRequest||((t,s)=>(function(e,t,s,i){const o={ns_id:s,ns_path:t,hide_tmfs:!0};return m.WebRequestOref({url:"/browse_util/tree_view_team_folder_contents",type:"POST",subject_user:e,data:o,dataType:"json",signal:i})})(e.userId,t,e.rootNSID,s));return r.default.createElement(O,Object.assign({},e,{rootIcon:j.DROPBOX,mkAjaxRequest:t}))},t.UserFolderTreeView=function(e){const t=e.mkAjaxRequest||((t,s)=>(function(e,t,s){const i={folder:t};return m.WebRequestOref({url:"/browse_util/tree_view_folders",type:"POST",subject_user:e,data:i,dataType:"json",signal:s})})(e.user.id,t,s)),s=e.forceRootSelectable||"edit"===e.user.user_root_permissions,i=e.is_paired?e.user.is_team?j.BRIEFCASE:j.HOUSE:j.DROPBOX,o=Object.assign(Object.assign({},e),{mkAjaxRequest:t,isRootSelectable:s,rootIcon:i});if(e.user.is_cdm_member){const t=e.user.cdm_tmf_path;return r.default.createElement(A,Object.assign({},o,{pinnedFolder:t}))}return r.default.createElement(O,Object.assign({},o))}})),define("metaserver/static/js/dropbox/proto/edison_starred/edison_starred",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/per_node_metadata/api_v2_meta","metaserver/static/js/dropbox/proto/js_init_data/home_web/home_access_web"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.edison_starred=void 0;const o=(i=s.__importStar(i)).Reader,r=i.Writer,n=i.util,a=i.roots.default||(i.roots.default={});var l;t.default=a,t.edison_starred=a.edison_starred=((l=a.edison_starred||{}).EdisonStarredItemDetails=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.fqPath="",e.prototype.targetNsId=0,e.prototype.isTeamMemberFolder=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.fqPath&&Object.hasOwnProperty.call(e,"fqPath")&&t.uint32(10).string(e.fqPath),null!=e.targetNsId&&Object.hasOwnProperty.call(e,"targetNsId")&&t.uint32(16).uint64(e.targetNsId),null!=e.isTeamMemberFolder&&Object.hasOwnProperty.call(e,"isTeamMemberFolder")&&t.uint32(24).bool(e.isTeamMemberFolder),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.edison_starred.EdisonStarredItemDetails;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.fqPath=e.string();break;case 2:i.targetNsId=e.uint64();break;case 3:i.isTeamMemberFolder=e.bool();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_starred.EdisonStarredItemDetails"},e})(l.EdisonStarredItemDetails||{}),l.EdisonStarredItem=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.details=null,e.prototype.title="",e.prototype.url="",e.prototype.displayType="",e.prototype.idType="",e.prototype.resourceId="",e.prototype.isMounted=!1,e.prototype.perNodeMetadata=null,e.prototype.icon="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.details&&Object.hasOwnProperty.call(e,"details")&&a.edison_starred.EdisonStarredItemDetails.encode(e.details,t.uint32(10).fork()).ldelim(),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(18).string(e.title),null!=e.url&&Object.hasOwnProperty.call(e,"url")&&t.uint32(26).string(e.url),null!=e.displayType&&Object.hasOwnProperty.call(e,"displayType")&&t.uint32(34).string(e.displayType),null!=e.idType&&Object.hasOwnProperty.call(e,"idType")&&t.uint32(42).string(e.idType),null!=e.resourceId&&Object.hasOwnProperty.call(e,"resourceId")&&t.uint32(50).string(e.resourceId),null!=e.isMounted&&Object.hasOwnProperty.call(e,"isMounted")&&t.uint32(56).bool(e.isMounted),null!=e.perNodeMetadata&&Object.hasOwnProperty.call(e,"perNodeMetadata")&&a.per_node_metadata.PerNodeMetadataEntity.encode(e.perNodeMetadata,t.uint32(66).fork()).ldelim(),null!=e.icon&&Object.hasOwnProperty.call(e,"icon")&&t.uint32(74).string(e.icon),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.edison_starred.EdisonStarredItem;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.details=a.edison_starred.EdisonStarredItemDetails.decode(e,e.uint32());break;case 2:i.title=e.string();break;case 3:i.url=e.string();break;case 4:i.displayType=e.string();break;case 5:i.idType=e.string();break;case 6:i.resourceId=e.string();break;case 7:i.isMounted=e.bool();break;case 8:i.perNodeMetadata=a.per_node_metadata.PerNodeMetadataEntity.decode(e,e.uint32());break;case 9:i.icon=e.string();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_starred.EdisonStarredItem"},e})(l.EdisonStarredItem||{}),l.EdisonStarredData=(function(e){function e(e){if(this.items=[],e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.status="",e.prototype.items=n.emptyArray,e.prototype.hasMore=!1,e.prototype.jsonData="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=r.create()),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(10).string(e.status),null!=e.items&&e.items.length)for(let s=0;s<e.items.length;++s)a.edison_starred.EdisonStarredItem.encode(e.items[s],t.uint32(18).fork()).ldelim();return null!=e.hasMore&&Object.hasOwnProperty.call(e,"hasMore")&&t.uint32(24).bool(e.hasMore),null!=e.jsonData&&Object.hasOwnProperty.call(e,"jsonData")&&t.uint32(34).string(e.jsonData),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.edison_starred.EdisonStarredData;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.status=e.string();break;case 2:i.items&&i.items.length||(i.items=[]),i.items.push(a.edison_starred.EdisonStarredItem.decode(e,e.uint32()));break;case 3:i.hasMore=e.bool();break;case 4:i.jsonData=e.string();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_starred.EdisonStarredData"},e})(l.EdisonStarredData||{}),l.EdisonStarredArguments=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.limit=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(8).uint32(e.limit),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.edison_starred.EdisonStarredArguments;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.limit=e.uint32();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_starred.EdisonStarredArguments"},e})(l.EdisonStarredArguments||{}),l.EdisonStarredEmptyArguments=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.edison_starred.EdisonStarredEmptyArguments;for(;e.pos<s;){let t=e.uint32();e.skipType(7&t)}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_starred.EdisonStarredEmptyArguments"},e})(l.EdisonStarredEmptyArguments||{}),l.EdisonStarredPropsPrefetchArg=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.encodedUrl="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.encodedUrl&&Object.hasOwnProperty.call(e,"encodedUrl")&&t.uint32(10).string(e.encodedUrl),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.edison_starred.EdisonStarredPropsPrefetchArg;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.encodedUrl=e.string();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_starred.EdisonStarredPropsPrefetchArg"},e})(l.EdisonStarredPropsPrefetchArg||{}),l.EdisonStarredPropsPrefetchResults=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.initialRole="",e.prototype.preTtiProps=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.initialRole&&Object.hasOwnProperty.call(e,"initialRole")&&t.uint32(18).string(e.initialRole),null!=e.preTtiProps&&Object.hasOwnProperty.call(e,"preTtiProps")&&a.home_web.PreTTIGateProps.encode(e.preTtiProps,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.edison_starred.EdisonStarredPropsPrefetchResults;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 2:i.initialRole=e.string();break;case 3:i.preTtiProps=a.home_web.PreTTIGateProps.decode(e,e.uint32());break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_starred.EdisonStarredPropsPrefetchResults"},e})(l.EdisonStarredPropsPrefetchResults||{}),l.EdisonStarredPostTtiPrefetchArg=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.edison_starred.EdisonStarredPostTtiPrefetchArg;for(;e.pos<s;){let t=e.uint32();e.skipType(7&t)}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_starred.EdisonStarredPostTtiPrefetchArg"},e})(l.EdisonStarredPostTtiPrefetchArg||{}),l.EdisonStarredPostTtiPrefetchResults=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.jsonData="",e.prototype.error="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.jsonData&&Object.hasOwnProperty.call(e,"jsonData")&&t.uint32(10).string(e.jsonData),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(18).string(e.error),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.edison_starred.EdisonStarredPostTtiPrefetchResults;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.jsonData=e.string();break;case 2:i.error=e.string();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_starred.EdisonStarredPostTtiPrefetchResults"},e})(l.EdisonStarredPostTtiPrefetchResults||{}),l.EdisonStarredLegacyPrefetchResults=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.jsonData="",e.prototype.error="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.jsonData&&Object.hasOwnProperty.call(e,"jsonData")&&t.uint32(18).string(e.jsonData),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(26).string(e.error),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.edison_starred.EdisonStarredLegacyPrefetchResults;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 2:i.jsonData=e.string();break;case 3:i.error=e.string();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_starred.EdisonStarredLegacyPrefetchResults"},e})(l.EdisonStarredLegacyPrefetchResults||{}),l)})),define("metaserver/static/js/dropbox/proto/edison_recent/edison_recent",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/js_init_data/home_web/home_access_web"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.edison_recent=void 0;const o=(i=s.__importStar(i)).Reader,r=i.Writer,n=(i.util,i.roots.default||(i.roots.default={}));var a;t.default=n,t.edison_recent=n.edison_recent=((a=n.edison_recent||{}).EdisonRecentsPrefetchArg=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.numActivities=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.numActivities&&Object.hasOwnProperty.call(e,"numActivities")&&t.uint32(8).int32(e.numActivities),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new n.edison_recent.EdisonRecentsPrefetchArg;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.numActivities=e.int32();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_recent.EdisonRecentsPrefetchArg"},e})(a.EdisonRecentsPrefetchArg||{}),a.EdisonRecentsPostTTIPrefetchArg=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new n.edison_recent.EdisonRecentsPostTTIPrefetchArg;for(;e.pos<s;){let t=e.uint32();e.skipType(7&t)}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_recent.EdisonRecentsPostTTIPrefetchArg"},e})(a.EdisonRecentsPostTTIPrefetchArg||{}),a.EdisonRecentsPropsPrefetchArg=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.UrlPath="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.UrlPath&&Object.hasOwnProperty.call(e,"UrlPath")&&t.uint32(10).string(e.UrlPath),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new n.edison_recent.EdisonRecentsPropsPrefetchArg;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.UrlPath=e.string();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_recent.EdisonRecentsPropsPrefetchArg"},e})(a.EdisonRecentsPropsPrefetchArg||{}),a.EdisonRecentsPrefetchResults=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.jsonData="",e.prototype.error="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.jsonData&&Object.hasOwnProperty.call(e,"jsonData")&&t.uint32(18).string(e.jsonData),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(26).string(e.error),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new n.edison_recent.EdisonRecentsPrefetchResults;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 2:i.jsonData=e.string();break;case 3:i.error=e.string();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_recent.EdisonRecentsPrefetchResults"},e})(a.EdisonRecentsPrefetchResults||{}),a.EdisonRecentsPostTTIPrefetchResults=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.jsonData="",e.prototype.error="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.jsonData&&Object.hasOwnProperty.call(e,"jsonData")&&t.uint32(10).string(e.jsonData),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(18).string(e.error),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new n.edison_recent.EdisonRecentsPostTTIPrefetchResults;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.jsonData=e.string();break;case 2:i.error=e.string();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_recent.EdisonRecentsPostTTIPrefetchResults"},e})(a.EdisonRecentsPostTTIPrefetchResults||{}),a.EdisonRecentsPropsPrefetchResults=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.initialRole="",e.prototype.preTtiProps=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.initialRole&&Object.hasOwnProperty.call(e,"initialRole")&&t.uint32(10).string(e.initialRole),null!=e.preTtiProps&&Object.hasOwnProperty.call(e,"preTtiProps")&&n.home_web.PreTTIGateProps.encode(e.preTtiProps,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new n.edison_recent.EdisonRecentsPropsPrefetchResults;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.initialRole=e.string();break;case 3:i.preTtiProps=n.home_web.PreTTIGateProps.decode(e,e.uint32());break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/edison_recent.EdisonRecentsPropsPrefetchResults"},e})(a.EdisonRecentsPropsPrefetchResults||{}),a)})),define("metaserver/static/js/dropbox/proto/per_node_metadata/api_v2_meta",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/per_node_metadata/link_node","metaserver/static/js/google/protobuf/wrappers","metaserver/static/js/dropbox/proto/rust/extensions"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.per_node_metadata=void 0;const o=(i=s.__importStar(i)).Reader,r=i.Writer,n=(i.util,i.roots.default||(i.roots.default={}));var a;t.default=n,t.per_node_metadata=n.per_node_metadata=((a=n.per_node_metadata||{}).BypassBehaviors=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.isVault=null,e.prototype.isDeviceFolder=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.isVault&&Object.hasOwnProperty.call(e,"isVault")&&n.google.protobuf.BoolValue.encode(e.isVault,t.uint32(10).fork()).ldelim(),null!=e.isDeviceFolder&&Object.hasOwnProperty.call(e,"isDeviceFolder")&&n.google.protobuf.BoolValue.encode(e.isDeviceFolder,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new n.per_node_metadata.BypassBehaviors;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.isVault=n.google.protobuf.BoolValue.decode(e,e.uint32());break;case 2:i.isDeviceFolder=n.google.protobuf.BoolValue.decode(e,e.uint32());break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/per_node_metadata.BypassBehaviors"},e})(a.BypassBehaviors||{}),a.DeviceInfoEntity=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.deviceId="",e.prototype.userId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.deviceId&&Object.hasOwnProperty.call(e,"deviceId")&&t.uint32(10).string(e.deviceId),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(16).int64(e.userId),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new n.per_node_metadata.DeviceInfoEntity;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.deviceId=e.string();break;case 2:i.userId=e.int64();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/per_node_metadata.DeviceInfoEntity"},e})(a.DeviceInfoEntity||{}),a.PerNodeMetadataEntity=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.bypassBehaviors=null,e.prototype.suppressDelete=null,e.prototype.suppressMove=null,e.prototype.suppressNsPartition=null,e.prototype.suppressSharedLink=null,e.prototype.linkNode=null,e.prototype.hideExtension=null,e.prototype.suppressRemoteActions=null,e.prototype.deviceInfo=null,e.prototype.suppressShare=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.bypassBehaviors&&Object.hasOwnProperty.call(e,"bypassBehaviors")&&n.per_node_metadata.BypassBehaviors.encode(e.bypassBehaviors,t.uint32(10).fork()).ldelim(),null!=e.suppressDelete&&Object.hasOwnProperty.call(e,"suppressDelete")&&n.google.protobuf.BoolValue.encode(e.suppressDelete,t.uint32(18).fork()).ldelim(),null!=e.suppressMove&&Object.hasOwnProperty.call(e,"suppressMove")&&n.google.protobuf.BoolValue.encode(e.suppressMove,t.uint32(26).fork()).ldelim(),null!=e.suppressShare&&Object.hasOwnProperty.call(e,"suppressShare")&&n.google.protobuf.BoolValue.encode(e.suppressShare,t.uint32(42).fork()).ldelim(),null!=e.linkNode&&Object.hasOwnProperty.call(e,"linkNode")&&n.per_node_metadata.LinkNodeEntity.encode(e.linkNode,t.uint32(50).fork()).ldelim(),null!=e.suppressNsPartition&&Object.hasOwnProperty.call(e,"suppressNsPartition")&&n.google.protobuf.BoolValue.encode(e.suppressNsPartition,t.uint32(58).fork()).ldelim(),null!=e.suppressSharedLink&&Object.hasOwnProperty.call(e,"suppressSharedLink")&&n.google.protobuf.BoolValue.encode(e.suppressSharedLink,t.uint32(66).fork()).ldelim(),null!=e.hideExtension&&Object.hasOwnProperty.call(e,"hideExtension")&&n.google.protobuf.BoolValue.encode(e.hideExtension,t.uint32(82).fork()).ldelim(),null!=e.suppressRemoteActions&&Object.hasOwnProperty.call(e,"suppressRemoteActions")&&n.google.protobuf.BoolValue.encode(e.suppressRemoteActions,t.uint32(90).fork()).ldelim(),null!=e.deviceInfo&&Object.hasOwnProperty.call(e,"deviceInfo")&&n.per_node_metadata.DeviceInfoEntity.encode(e.deviceInfo,t.uint32(98).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new n.per_node_metadata.PerNodeMetadataEntity;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.bypassBehaviors=n.per_node_metadata.BypassBehaviors.decode(e,e.uint32());break;case 2:i.suppressDelete=n.google.protobuf.BoolValue.decode(e,e.uint32());break;case 3:i.suppressMove=n.google.protobuf.BoolValue.decode(e,e.uint32());break;case 7:i.suppressNsPartition=n.google.protobuf.BoolValue.decode(e,e.uint32());break;case 8:i.suppressSharedLink=n.google.protobuf.BoolValue.decode(e,e.uint32());break;case 6:i.linkNode=n.per_node_metadata.LinkNodeEntity.decode(e,e.uint32());break;case 10:i.hideExtension=n.google.protobuf.BoolValue.decode(e,e.uint32());break;case 11:i.suppressRemoteActions=n.google.protobuf.BoolValue.decode(e,e.uint32());break;case 12:i.deviceInfo=n.per_node_metadata.DeviceInfoEntity.decode(e,e.uint32());break;case 5:i.suppressShare=n.google.protobuf.BoolValue.decode(e,e.uint32());break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/per_node_metadata.PerNodeMetadataEntity"},e})(a.PerNodeMetadataEntity||{}),a.LinkNodeAction=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_ACTION"]=0,t[e[1]="DEVICE_FOLDER_PRE_SETUP"]=1,t[e[2]="LIFE_VAULT_PRE_SETUP"]=2,t[e[3]="LIFE_VAULT_POST_SETUP"]=3,t[e[4]="PASSWORDS_PRE_SETUP"]=4,t[e[5]="PASSWORDS_POST_SETUP"]=5,t})(),a)})),define("metaserver/static/js/dropbox/proto/per_node_metadata/link_node",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/rust/extensions"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.per_node_metadata=void 0;const o=(i=s.__importStar(i)).Reader,r=i.Writer,n=(i.util,i.roots.default||(i.roots.default={}));var a;t.default=n,t.per_node_metadata=n.per_node_metadata=((a=n.per_node_metadata||{}).LinkNodeAction=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_ACTION"]=0,t[e[1]="DEVICE_FOLDER_PRE_SETUP"]=1,t[e[2]="LIFE_VAULT_PRE_SETUP"]=2,t[e[3]="LIFE_VAULT_POST_SETUP"]=3,t[e[4]="PASSWORDS_PRE_SETUP"]=4,t[e[5]="PASSWORDS_POST_SETUP"]=5,t})(),a.LinkNodeEntity=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.action=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(8).int32(e.action),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new n.per_node_metadata.LinkNodeEntity;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.action=e.int32();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/per_node_metadata.LinkNodeEntity"},e})(a.LinkNodeEntity||{}),a)})),define("metaserver/static/js/dropbox/proto/rust/extensions",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/google/protobuf/descriptor"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.rust=void 0;(i=s.__importStar(i)).Reader,i.Writer,i.util;const o=i.roots.default||(i.roots.default={});t.default=o,t.rust=o.rust=o.rust||{}})),define("metaserver/static/js/google/protobuf/wrappers",["require","exports","tslib","protobufjs/minimal"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.google=void 0;const o=(i=s.__importStar(i)).Reader,r=i.Writer,n=i.util,a=i.roots.default||(i.roots.default={});var l,c;t.default=a,t.google=a.google=((l=a.google||{}).protobuf=((c=l.protobuf||{}).DoubleValue=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(9).double(e.value),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.google.protobuf.DoubleValue;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.value=e.double();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.DoubleValue"},e})(c.DoubleValue||{}),c.FloatValue=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(13).float(e.value),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.google.protobuf.FloatValue;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.value=e.float();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.FloatValue"},e})(c.FloatValue||{}),c.Int64Value=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(8).int64(e.value),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.google.protobuf.Int64Value;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.value=e.int64();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.Int64Value"},e})(c.Int64Value||{}),c.UInt64Value=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(8).uint64(e.value),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.google.protobuf.UInt64Value;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.value=e.uint64();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.UInt64Value"},e})(c.UInt64Value||{}),c.Int32Value=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(8).int32(e.value),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.google.protobuf.Int32Value;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.value=e.int32();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.Int32Value"},e})(c.Int32Value||{}),c.UInt32Value=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(8).uint32(e.value),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.google.protobuf.UInt32Value;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.value=e.uint32();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.UInt32Value"},e})(c.UInt32Value||{}),c.BoolValue=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.value=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(8).bool(e.value),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.google.protobuf.BoolValue;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.value=e.bool();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.BoolValue"},e})(c.BoolValue||{}),c.StringValue=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(10).string(e.value),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.google.protobuf.StringValue;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.value=e.string();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.StringValue"},e})(c.StringValue||{}),c.BytesValue=(function(e){function e(e){if(e)for(let t=Object.keys(e),s=0;s<t.length;++s)null!=e[t[s]]&&(this[t[s]]=e[t[s]])}return e.prototype.value=n.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=r.create()),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(10).bytes(e.value),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let s=void 0===t?e.len:e.pos+t,i=new a.google.protobuf.BytesValue;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:i.value=e.bytes();break;default:e.skipType(7&t)}}return i},e.getTypeUrl=function(){return"type.googleapis.com/google.protobuf.BytesValue"},e})(c.BytesValue||{}),c),l)}));
//# sourceMappingURL=pkg-home-post-tti.min.js-vflSSLjBR.map