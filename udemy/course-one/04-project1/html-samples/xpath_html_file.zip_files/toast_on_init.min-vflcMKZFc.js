define(["require","exports","tslib","metaserver/static/js/modules/core/notify","metaserver/static/js/modules/core/html","metaserver/static/js/modules/core/cookies","metaserver/static/js/security/csrf_hmac","metaserver/static/js/modules/clean/csrf"],(function(e,t,o,s,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeToastCookie=t.showToastFromCookie=void 0;function c(e,t){return o.__awaiter(this,void 0,void 0,(function*(){const o=yield n.readHmacCookieToken(e,t);if(null==o)return null;if(o.startsWith("er:"))return[!0,o.substring(3)];if(o.startsWith("ok:"))return[!1,o.substring(3)];throw new Error("unrecognized format of message in toast cookie")}))}t.showToastFromCookie=function(){var t;return o.__awaiter(this,void 0,void 0,(function*(){const n=r.Cookies.read("toast");if(n){const u=yield c(n,null!==(t=a.readCsrfToken())&&void 0!==t?t:void 0);if(null!=u){const[t,n]=u,{default:a}=yield new Promise((t,o)=>{e(["dompurify"],t,o)}).then(o.__importStar),c=a.sanitize(n),d=document.getElementById("flash");null!=d&&(d.innerHTML=c,d.style.display="block"),setTimeout(()=>r.Cookies.delete("toast"),2e3),t?s.Notify.error(new i.HTML(c),10):s.Notify.success(new i.HTML(c),10)}}}))},t.decodeToastCookie=c}));
//# sourceMappingURL=toast_on_init.min.js-vflFChc9y.map