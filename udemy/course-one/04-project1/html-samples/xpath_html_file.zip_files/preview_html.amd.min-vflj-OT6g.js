define(["require","exports","tslib","react","classnames","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/css/preview-html.module.css","typescript/libraries/file-viewer/src/css/preview-core.module.css","typescript/libraries/file-viewer/src/preview_html/types","typescript/libraries/file-viewer/src/libraries/frame_messenger/html_frame_messenger_host","typescript/libraries/file-viewer/src/core/data/actions","typescript/libraries/file-viewer/src/hooks/useStabilizedCallback","typescript/libraries/file-viewer/src/plugins/types","typescript/libraries/file-viewer/src/toolbar/toolbar","typescript/libraries/file-viewer/src/core/utils/paths","ts-keycode-enum"],(function(e,r,i,t,a,s,l,n,c,o,p,d,u,v,f,_){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PreviewHTML=void 0,t=i.__importStar(t),a=i.__importDefault(a),l=i.__importStar(l),n=i.__importStar(n);const w={[_.Key.RightArrow]:{altKey:!0,ctrlKey:!0,metaKey:!0},[_.Key.LeftArrow]:{altKey:!0,ctrlKey:!0,metaKey:!0}},m=[".xlsx"];r.PreviewHTML=e=>{const{dispatch:r,fileViewerUiData:i,fileConfig:_,rootArchiveFileInformation:b,filePreviewUiData:C,fileMetadata:M,toolbarPlugins:y,snackbarManagerPluginInstance:I,isRawHtml:T,onSetPreviewLoaded:E,iframeSrc:g,iframeSandbox:S}=e,O=null!=g?g:e.previewMetadata&&e.previewMetadata.preview_url,L=e.fileMetadata&&e.fileMetadata.file_name,D=t.useRef(),R=r=>{var i;if((e=>c.ACTIONS_FROM_CHILD_IFRAME.includes(e.action))(r))switch(r.action){case c.FROM_CHILD_ACTIONS.FAILED:e.onRenderFailed();break;case c.FROM_CHILD_ACTIONS.VIEWER_READY:e.onInteractive(),e.onRenderSucceeded();break;case c.FROM_CHILD_ACTIONS.KEYDOWN_KEYS:null===(i=D.current)||void 0===i||i.postMessageToChildren(c.TO_CHILD_ACTIONS.SEND_KEYDOWN_KEYS,{keycodes:w});break;case c.FROM_CHILD_ACTIONS.KEYDOWN:const t=new KeyboardEvent("keydown",r.parameters);document.dispatchEvent(t);break;case c.FROM_CHILD_ACTIONS.ACTIVE_MOUSE:window.dispatchEvent(new MouseEvent("mousemove"))}},H=t.useRef(null);t.useEffect(()=>{M&&(null===H.current||H.current!==M.file_name)&&m.includes(f.getFileExtension(M.file_name))&&(r(p.triggerDynamicRoutingModalCheck()),H.current=M.file_name)},[r,M]),t.useEffect(()=>{if(!T)return D.current=new o.HTMLFrameMessengerHost([]),D.current.configureChildMessaging("iframe.previewhtml",R,c.ACTIONS_FROM_CHILD_IFRAME),D.current.startListening(),D.current.postMessageToChildren(c.TO_CHILD_ACTIONS.SEND_KEYDOWN_KEYS,{keycodes:[]}),()=>{var e;null===(e=D.current)||void 0===e||e.stopListening()}},[]),t.useEffect(()=>{null==E||E()},[E]);const N=d.useStabilizedCallback(()=>{e.onRenderFailed()}),h=d.useStabilizedCallback(()=>{T&&(e.onInteractive(),e.onRenderSucceeded())}),A=d.useStabilizedCallback(()=>{var e;null===(e=D.current)||void 0===e||e.postMessageToChildren(c.TO_CHILD_ACTIONS.PRINT,{context:s.UserActionContext.Toolbar})}),P=null!=S?S:(null==_?void 0:_.enable_print)?"allow-modals allow-scripts":"allow-scripts";return t.createElement("div",{className:a.default(l.app,n.app,{[l.ios]:!1})},t.createElement("iframe",{title:L,onError:N,name:"preview-content",src:O,sandbox:P,className:a.default("previewhtml",l.previewContent),onLoad:h}),t.createElement(v.ConfigurableToolbar,{rootArchiveFileInformation:b,filePreviewUi:C,fileViewerUi:i,onPrint:A,previewType:T?u.PreviewType.RawHTML:u.PreviewType.HTML,plugins:y,snackbarManagerPluginInstance:I}))},r.PreviewHTML.displayName="PreviewHTML",r.PreviewHTML.displayName="PreviewHTML"}));
//# sourceMappingURL=preview_html.amd.min.js-vflMeR880.map