define(["require","exports","tslib","metaserver/static/js/modules/core/exception_info","metaserver/static/js/modules/core/xhr"],(function(e,t,r,o,i){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0}),t.sendExceptionReport=void 0,(function(e){e.Reported="reported",e.ForceReported="force",e.Duplicate="duplicate",e.Ignored="ignored"})(c||(c={}));function s(t,o){return r.__awaiter(this,void 0,void 0,(function*(){try{const{getMetricsReporter:i}=yield new Promise((t,r)=>{e(["metaserver/static/js/metrics/index"],t,r)}).then(r.__importStar),c=i().createCounter({ns:"js_exception",name:"count"},{which:t,severity:o||"undefined"});c.increment(),c.record()}catch(e){0}}))}let n=0;let a=void 0;t.sendExceptionReport=function(e){if(e.reported)return void s(c.Duplicate,e.severity);if(a&&!e.force)return void s(c.Ignored,e.severity);if(!e.stack_frames){const[t,r]=o.collectExceptionStack(e);e.stack_frames=t.reverse(),e.context_tb=r.reverse()}var t;e.tags=o.collectExceptionTags(e),e.excExtra=o.collectExceptionExtra(e),t=e.excExtra,n+=1,t.exception_number=n,window.DB_FRAME_BUST&&(e.severity=o.SEVERITY.USER_ERROR);const r={e:e.message,loc:window.location.href,ref:document.referrer,stack:JSON.stringify(e.stack_frames),context_tb:JSON.stringify(e.context_tb),tags:JSON.stringify(e.tags),exc_extra:JSON.stringify(e.excExtra||{}),sev:e.severity||""};i.sendXhr("/jse",r),a&&e.force?s(c.ForceReported,e.severity):s(c.Reported,e.severity),a=e.message,e.reported=!0}}));
//# sourceMappingURL=exception_reporter.min.js-vflhBG475.map