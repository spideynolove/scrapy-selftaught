define("metaserver/static/js/modules/clean/react/path_filter_button",["require","exports","tslib","react","spectrum/dropdown_button/index","metaserver/static/js/modules/clean/react/title_bubble","metaserver/static/js/modules/clean/em_string","metaserver/static/js/modules/clean/filepath/filepath","dig-components/tooltips","metaserver/static/js/modules/clean/react/sticky_position","dig-components/buttons","dig-components/chips"],(function(e,t,r,a,s,i,o,n,d,c,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PathFilterButton=void 0,a=r.__importDefault(a),n=r.__importStar(n);t.PathFilterButton=({path:e,defaultText:t,dropdownClasses:r,disabled:p,onClick:S,useDigComponents:m,id:_,label:h,useButtonComponent:g})=>{const f=e&&!n.paths_are_equal(e,"/")?o.Emstring.em_snippet(n.filename(e),10,.6):null;if(m){const s=g?a.default.createElement(l.Button,{variant:"outline",className:r,disabled:p,onClick:S,id:_,"aria-labelledby":`${h} ${_}`,withDropdownIcon:!0},f||t):a.default.createElement(u.FilterChip,{className:r,disabled:p,onClick:S,id:_,"aria-labelledby":`${h} ${_}`,isSelected:!!f},f||t);return e&&f?a.default.createElement(d.Tooltip,{title:e,placement:"bottom"},s):s}const v=a.default.createElement(s.DropdownButton,{className:r,disabled:p,onClick:S,id:_,"aria-labelledby":`${h} ${_}`},f||t);return f?a.default.createElement(i.TitleBubble,{content:e,position:c.StickyPosition.BOTTOM},v):v}})),define("metaserver/static/js/starred/store",["require","exports","tslib","lodash","metaserver/static/js/flux/dispatcher","metaserver/static/js/flux/flux_store","metaserver/static/js/starred/constants","metaserver/static/js/home/starred/constants","metaserver/static/js/starred/id_type_pair"],(function(e,t,r,a,s,i,o,n,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredStore=t._StarredStoreClass=void 0,a=r.__importStar(a);class c extends i.FluxStore{constructor(){super(s.Dispatcher),this.idsToLoadingState={},this.idsToStarred={}}getLoadingStates(){return this.idsToLoadingState}hasIdTypePair(e){return this.idsToLoadingState.hasOwnProperty(d.idTypePairToString(e))}getLoadingState(e){return this.idsToLoadingState[d.idTypePairToString(e)]}getIsStarred(e){return this.idsToStarred[d.idTypePairToString(e)]}getAllStarredPairStrings(){return Object.keys(a.pickBy(this.idsToStarred,e=>e))}getIsLoading(e){return this.getLoadingState(e)===o.StarredLoadingState.LOADING}onLoading(e){const t={};e.forEach(e=>t[d.idTypePairToString(e)]=o.StarredLoadingState.LOADING),this.idsToLoadingState=Object.assign(Object.assign({},this.idsToLoadingState),t)}onSetStatus(e=[]){const t={},r={};e.forEach(e=>{const a=d.idTypePairToString(e.idTypePair);t[a]=o.StarredLoadingState.LOAD_SUCCESS,r[a]=e.starred}),this.idsToLoadingState=Object.assign(Object.assign({},this.idsToLoadingState),t),this.idsToStarred=Object.assign(Object.assign({},this.idsToStarred),r)}onLoadFailure(e){const t={};e.forEach(e=>{const r=d.idTypePairToString(e),a=this.idsToLoadingState[r];void 0!==a&&a!==o.StarredLoadingState.LOADING||(t[r]=o.StarredLoadingState.LOAD_FAILED)}),this.idsToLoadingState=Object.assign(Object.assign({},this.idsToLoadingState),t)}__onDispatch(e){const t=e.action;switch(t.type){case o.StarredActionTypes.LOADING:this.onLoading(t.idTypePairs),this.__emitChange();break;case o.StarredActionTypes.SET_STATUS:case n.StarredResourceActionTypes.LOAD_SUCCESS:this.onSetStatus(t.starredStatuses),this.__emitChange();break;case o.StarredActionTypes.LOAD_FAILURE:this.onLoadFailure(t.idTypePairs),this.__emitChange();break;default:return}}}t._StarredStoreClass=c,t.StarredStore=new c})),define("metaserver/static/js/starred/redux/store",["require","exports","metaserver/static/js/redux/namespaces","metaserver/static/js/redux/store","metaserver/static/js/starred/redux/slice"],(function(e,t,r,a,s){"use strict";let i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForStarred=void 0;t.getStoreForStarred=()=>(i||(i=a.getStoreAndRegisterReducers({[r.STARRED_NAMESPACE_KEY]:s.reducer})),i)})),define("metaserver/static/js/home/starred/starred_item_list",["require","exports","tslib","react","react-dom","metaserver/static/js/home/post_tti/api","metaserver/static/js/home/starred/constants","metaserver/static/js/home/starred/starred_empty_state","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/util/show_hide_link","metaserver/static/js/home/starred/starred_table","metaserver/static/js/home/starred/starred_files_table","metaserver/static/js/files_page/actionBar/lazy_files_page_action_bar"],(function(e,t,r,a,s,i,o,n,d,c,l,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredItemList=void 0,a=r.__importDefault(a),s=r.__importDefault(s);class S extends a.default.PureComponent{constructor(e){super(e),this.toggleShowAll=()=>r.__awaiter(this,void 0,void 0,(function*(){const e=!this.state.showAll;if(d.homeActivityLogger.logClickShowAll("starred",e),this.setState({showAll:e}),e&&this.props.hasMore){const{loadAllStarredItems:e}=yield i.waitForHomeTTI();e()}const t=s.default.findDOMNode(this.refs.lastUnhiddenStar);if(t){const e=t.querySelector("a");e&&e.focus()}})),this._LazyFilesActionBar=p.LazyFilesActionBar(e=>this.setState({actionBarHeight:e})),this.state={showAll:e.showAll,actionBarHeight:0}}render(){const{itemModels:e,useFilesActionTable:t,useStarredActionBar:r}=this.props,{showAll:s,actionBarHeight:i}=this.state,d=Math.max(e.length-o.INITIAL_STARRED_ITEMS_LIMIT,0),p=d&&!s?e.slice(0,o.INITIAL_STARRED_ITEMS_LIMIT):e,m=r?{height:`calc(100% - ${i}px)`,overflow:"auto"}:{};let _=a.default.createElement(n.StarredEmptyState,null);return p.length&&(_=t?a.default.createElement(u.StarredFilesTable,{items:p}):a.default.createElement(l.StarredTable,{items:p,withSelection:!1})),a.default.createElement("div",{className:"starred",id:S.displayName},r&&a.default.createElement(this._LazyFilesActionBar,{isEnabled:!0,uploadActionEnabled:!0,createActionProps:{showSharedFolderCreate:!0,showAutomatedFolderCreate:!0,showPaperCreate:!0,showBinderCreate:!0,showGoogleCreate:!0}}),a.default.createElement("div",{className:"starred-container",style:m},_,!this.props.showAll&&d?a.default.createElement(c.ShowHideLink,{onClick:this.toggleShowAll,isExpanded:s,hiddenItemCount:d,canLoadMore:!1}):null))}}t.StarredItemList=S,S.displayName="StarredItemList"})),define("metaserver/static/js/home/starred/starred_resource_store",["require","exports","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/constants","metaserver/static/js/home/starred/constants","metaserver/static/js/starred/constants","metaserver/static/js/home/starred/actions","metaserver/static/js/starred/store","metaserver/static/js/home/util/logging/availability_logger","metaserver/static/js/flux/flux_store","metaserver/static/js/home/post_tti/api"],(function(e,t,r,a,s,i,o,n,d,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStarredResourceStore=t.PrivateStarredResourceStoreClass=void 0;class u extends c.FluxStore{constructor(e){super(r.Dispatcher),this.orderedIds=[],this.itemsById={},this.loadingState=a.LoadingStates.LOADING,this.hasMore=!0,this.hasLoadedInitial=!1,this.hasLoadedAll=!1,this.isPaperUser=!0,e?o.StarredActions.handleEdisonStarredData(l.waitForHomeTTI,s.StarredResourceActionTypes.LOADING_INITIAL,e):d.getHomeAvailabilityLogger().handlePrefetch(a.HomePrefetchTypes.RETRIEVE_STARRED,e=>o.StarredActions.handleRetrieveStarredPayload(l.waitForHomeTTI,s.StarredResourceActionTypes.LOADING_INITIAL,e))}getStarredStore(){return n.StarredStore}clearPresentableItemsCache(){this.presentableItemsCache=null}getItems(){return this.presentableItemsCache||(this.presentableItemsCache=this.orderedIds.map(e=>this.itemsById[e]).filter(e=>{const t={id:e.resourceId,type:e.idType},r=this.getStarredStore().getLoadingState(t),a=this.getStarredStore().getIsStarred(t);return r===i.StarredLoadingState.LOADING||a})),this.presentableItemsCache}getItem(e){return this.itemsById[e]}getLoadingState(){return this.loadingState}getHasMore(){return this.hasMore}getHasLoadedInitial(){return this.hasLoadedInitial}getHasLoadedAll(){return this.hasLoadedAll}getIsPaperUser(){return this.isPaperUser}onItemsLoading(){this.loadingState=a.LoadingStates.LOADING}onItemsLoadSuccess(e,t){e.forEach(e=>{this.itemsById[e.resourceId]=e}),this.loadingState=a.LoadingStates.SUCCESS,this.orderedIds=e.map(e=>e.resourceId),this.hasMore=t,e.length&&this.clearPresentableItemsCache()}onItemsLoadFailure(e){this.loadingState=a.LoadingStates.FAILURE,e&&e===s.NOT_PAPER_USER_ERROR&&(this.isPaperUser=!1)}onItemsLoadComplete(e,t){e!==s.StarredLoadingTypes.INITIAL&&t||(this.hasLoadedInitial=!0),e!==s.StarredLoadingTypes.ALL&&t||(this.hasLoadedAll=!0)}onStatusChange(){l.waitForHomeTTI().then(({loadAllStarredItems:e})=>e()),this.clearPresentableItemsCache()}__onDispatch(e){const t=e.action;switch(t.type){case s.StarredResourceActionTypes.LOADING_INITIAL:case s.StarredResourceActionTypes.LOADING_ALL:this.onItemsLoading(),this.__emitChange();break;case s.StarredResourceActionTypes.LOAD_SUCCESS:this.onItemsLoadSuccess(t.items,t.hasMore),this.onItemsLoadComplete(t.loadingType,t.hasMore),this.__emitChange();break;case s.StarredResourceActionTypes.LOAD_FAILURE:this.onItemsLoadFailure(t.error),this.onItemsLoadComplete(t.loadingType,!0),this.__emitChange();break;case i.StarredActionTypes.LOADING:this.clearPresentableItemsCache(),this.__emitChange();break;case i.StarredActionTypes.SET_STATUS:this.onStatusChange(),this.__emitChange()}}}t.PrivateStarredResourceStoreClass=u;let p=null;t.getStarredResourceStore=function(e){return null===p&&(p=new u(e)),p}})),define("metaserver/static/js/home/starred/starred_view",["require","exports","tslib","react","react-redux","metaserver/static/js/files_page/data/store","metaserver/static/js/files_page/data/action_creators","metaserver/static/js/home/constants","metaserver/static/js/home/starred/constants","metaserver/static/js/home/starred/starred_item_list","metaserver/static/js/home/starred/starred_layout","metaserver/static/js/home/store","metaserver/static/js/home/starred/starred_resource_store","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/util/logging/timing_component","metaserver/static/js/home/util/logging/timing_logger","metaserver/static/js/starred/redux/store"],(function(e,t,r,a,s,i,o,n,d,c,l,u,p,S,m,_,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredView=t.StarViewWithFilesPage=void 0,a=r.__importDefault(a);class g extends a.default.PureComponent{constructor(e){super(e),this.onStoreUpdate=()=>this.setState(this.getStateFromStore()),this.removeStoreListener=p.getStarredResourceStore().addListener(this.onStoreUpdate),this.state=Object.assign({showAll:!1},this.getStateFromStore())}getStateFromStore(){const e=p.getStarredResourceStore(),t=e.getLoadingState(),r=e.getItems(),a=e.getHasMore(),s=e.getHasLoadedInitial();if(t===n.LoadingStates.SUCCESS){if(_.homeTimingLogger.logTTData(n.HomeSections.STARRED)){const e=r.length>d.INITIAL_STARRED_ITEMS_LIMIT;S.homeActivityLogger.logStarredShown(r.length,e,a)}}return{itemModels:r,hasLoadedInitial:s,hasMore:a,canShowSpinner:t===n.LoadingStates.LOADING&&!e.getHasLoadedAll()}}componentWillUnmount(){this.removeStoreListener&&this.removeStoreListener()}render(){const{canRenderItems:e,isHiddenByUser:r,useFilesActionTable:s}=this.props;return a.default.createElement(t.StarViewWithFilesPage,null,a.default.createElement(a.default.Fragment,null,e?a.default.createElement(l.StarredLayout,Object.assign({isHiddenByUser:r,showHeader:!0,starredComponent:c.StarredItemList,useStarredActionBar:!1,useFilesActionTable:s},this.state)):null))}}g.displayName="StarredView";t.StarViewWithFilesPage=({children:e})=>{const t=a.default.useMemo(()=>{h.getStoreForStarred();const e=i.getStoreForFilesPage();return e.dispatch(o.appInit({user:u.getUser()})),e},[]);return a.default.createElement(s.Provider,{store:t},e)},t.StarViewWithFilesPage.displayName="StarViewWithFilesPage",t.StarredView=m.timingComponent(g,n.HomeSections.STARRED)})),define("metaserver/static/js/home/starred/starred_layout",["require","exports","tslib","react","react-redux","metaserver/static/js/home/actions","metaserver/static/js/home/constants","metaserver/static/js/components/ui/section/section_header","metaserver/static/js/home/store","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/modules/core/i18n","metaserver/static/js/starred/redux/selectors","metaserver/static/js/starred/redux/slice","metaserver/static/js/modules/constants/web_experience_constants"],(function(e,t,r,a,s,i,o,n,d,c,l,u,p,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredLayout=t.StarredLayoutClass=t.STARRED_HEADER_TITLE=void 0,a=r.__importStar(a),t.STARRED_HEADER_TITLE=l.intl.formatMessage({id:"Nd85dl",defaultMessage:"Starred"});class m extends a.default.PureComponent{constructor(){super(...arguments),this.onChangeVisibility=()=>{const e=this.props.isHiddenByUser;i.HomeActions.setSectionVisibility(d.getUserId(),{".tag":"starred"},e),c.homeActivityLogger.logShowHideSection(o.HomeSections.STARRED,!e)}}render(){const e=this.props,{isHiddenByUser:s,showHeader:i,starredComponent:o}=e,d=r.__rest(e,["isHiddenByUser","showHeader","starredComponent"]),c=o;return a.default.createElement("section",{className:"home-access-section"},i&&a.default.createElement(n.SectionHeader,{title:t.STARRED_HEADER_TITLE,ueName:"starred",isHidden:s,onToggleHidden:this.onChangeVisibility,ariaControls:c.displayName}),!s&&a.default.createElement(c,Object.assign({},d)))}}t.StarredLayoutClass=m,m.displayName="StarredLayoutClass";const _=({isHiddenByUser:e,starredComponent:r,showHeader:l,showAll:S,useStarredActionBar:m,useFilesActionTable:_})=>{const h=a.useCallback(()=>{const t=e;i.HomeActions.setSectionVisibility(d.getUserId(),{".tag":"starred"},t),c.homeActivityLogger.logShowHideSection(o.HomeSections.STARRED,!t)},[e]),g=s.useDispatch();a.useEffect(()=>{g(p.getAllStarred());const e=()=>{"visible"===document.visibilityState&&g(p.getAllStarred())};return document.addEventListener("visibilitychange",e,!1),function(){document.removeEventListener("visibilitychange",e)}},[]);const f=s.useSelector(u.getStarredItems),v=s.useSelector(u.getHasMore),y=r;return a.default.createElement("section",{className:"home-access-section"},l&&a.default.createElement(n.SectionHeader,{title:t.STARRED_HEADER_TITLE,ueName:"starred",isHidden:e,onToggleHidden:h,ariaControls:y.displayName}),!e&&a.default.createElement(y,{itemModels:f,hasMore:v,showAll:S,useStarredActionBar:m,useFilesActionTable:_}))};_.displayName="StarredLayoutRedux",t.StarredLayout=S.STARRED_STORE_REDUX?_:m})),define("metaserver/static/js/home/recents/recent_activity_starred",["require","exports","tslib","lodash","metaserver/static/js/starred/id_type_pair"],(function(e,t,r,a,s){"use strict";function i(e){return e.resource_id&&e.id_type?{id:e.resource_id,type:e.id_type}:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getIdTypePairFromRecentItem=t.getIdTypePairsByRecentActivityItems=t.getIdTypePair=void 0,a=r.__importStar(a),t.getIdTypePair=i,t.getIdTypePairsByRecentActivityItems=function(e){const t={};return e.forEach(e=>{const r=i(e);r&&(t[s.idTypePairToString(r)]=r)}),a.values(t)},t.getIdTypePairFromRecentItem=function(e){return e.resourceId&&e.idType?{id:e.resourceId,type:e.idType}:null}})),define("metaserver/static/js/search/logger",["require","exports","metaserver/static/js/modules/clean/analytics","metaserver/static/js/search/api_helpers","metaserver/static/js/pap/analytics_client","metaserver/static/js/dropbox/proto/pap_events/search/shown_search_query_history","metaserver/static/js/dropbox/proto/pap_events/search/fail_search_result_preview","metaserver/static/js/dropbox/proto/pap_events/search/finish_search_result_preview","metaserver/static/js/dropbox/proto/pap_events/search/preview_search_result","metaserver/static/js/pap/util"],(function(e,t,r,a,s,i,o,n,d,c){"use strict";function l(e,t){const r=e;return Object.assign(Object.assign({},t),{file_nsid:r.ns_id,file_sjid:r.sjid,match_type:r.match_type||void 0})}Object.defineProperty(t,"__esModule",{value:!0}),t.logHoverPreviewFailed=t.logHoverPreviewCompleted=t.logHoverPreviewStarted=t.logRecentHistoryDisplayed=t.SearchLogResultType=void 0,(function(e){e.SHARED_DOC="shared_doc",e.SHARED_CLOUD_DOC="shared_cloud_doc"})(t.SearchLogResultType||(t.SearchLogResultType={})),t.logRecentHistoryDisplayed=function({searchSessionId:e,user:t,history:o}){const n=a.getCurrentTimezoneOffset(),d=o.map(e=>e.rawQuery).reduce((e,t,r)=>(e[r]=t,e),{}),c=JSON.stringify(d),l={search_session_id:e,recent_history_map:c,timezone_offset:n,viewport:"dropdown-view"};r.SearchClientActivityLogger.log("recent_history_displayed",t.id,l),s.logEvent(i.pap_events.search.Shown_SearchQueryHistory.create({actionSurface:"search",recentHistoryMap:c}))},t.logHoverPreviewStarted=function({searchSessionId:e,result:t,user:i,previewRequestId:o,viewport:n="dropdown-view"}){const c=l(t,{search_session_id:e,preview_request_id:o,timezone_offset:a.getCurrentTimezoneOffset(),viewport:n});r.SearchClientActivityLogger.log("preview_started",i.id,c),s.logEvent(d.pap_events.search.Preview_SearchResult.create({actionSurface:"search",nsId:c.file_nsid,sjId:c.file_sjid,matchType:c.match_type}))},t.logHoverPreviewCompleted=function({searchSessionId:e,result:t,user:i,previewRequestId:o,viewport:d="dropdown-view",latency:u,displayed:p}){var S;const m=a.getCurrentTimezoneOffset(),_={search_session_id:e,preview_request_id:o,timezone_offset:m,viewport:d,latency:u,displayed:p?"true":"false"};r.SearchClientActivityLogger.log("preview_completed",i.id,l(t,_));const h=n.pap_events.search.Finish_SearchResultPreview.Viewport.UNKNOWN_VIEWPORT;let g=d;g=g.replace(/-/g,"_").toUpperCase();const f=null!==(S=c.getEnumValueForString(`${g}_VIEWPORT`,n.pap_events.search.Finish_SearchResultPreview.Viewport))&&void 0!==S?S:h;s.logEvent(n.pap_events.search.Finish_SearchResultPreview.create({searchSessionId:e,previewRequestId:o,timezoneOffset:m,viewport:f,latency:u,previewDisplayed:p}))},t.logHoverPreviewFailed=function({searchSessionId:e,result:t,user:i,previewRequestId:n,viewport:d="dropdown-view",failureType:u}){var p;const S=a.getCurrentTimezoneOffset(),m={search_session_id:e,preview_request_id:n,timezone_offset:S,viewport:d,failure_type:u};r.SearchClientActivityLogger.log("preview_failed",i.id,l(t,m));const _=o.pap_events.search.Fail_SearchResultPreview.Viewport.UNKNOWN_VIEWPORT;let h=d;h=h.replace(/-/g,"_").toUpperCase();const g=null!==(p=c.getEnumValueForString(`${h}_VIEWPORT`,o.pap_events.search.Fail_SearchResultPreview.Viewport))&&void 0!==p?p:_;s.logEvent(o.pap_events.search.Fail_SearchResultPreview.create({searchSessionId:e,previewRequestId:n,timezoneOffset:S,viewport:g,failureType:u}))}})),define("metaserver/static/js/dropbox/proto/pap_events/search/shown_search_query_history",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;const s=(a=r.__importStar(a)).Reader,i=a.Writer,o=(a.util,a.roots.default||(a.roots.default={}));var n,d;t.default=o,t.pap_events=o.pap_events=((n=o.pap_events||{}).search=((d=n.search||{}).Shown_SearchQueryHistory=(function(e){function e(e){if(e)for(let t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.recentHistoryMap="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.actionSurface&&Object.hasOwnProperty.call(e,"actionSurface")&&t.uint32(10).string(e.actionSurface),null!=e.recentHistoryMap&&Object.hasOwnProperty.call(e,"recentHistoryMap")&&t.uint32(18).string(e.recentHistoryMap),null!=e.eventClass&&Object.hasOwnProperty.call(e,"eventClass")&&t.uint32(8808).int32(e.eventClass),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));let r=void 0===t?e.len:e.pos+t,a=new o.pap_events.search.Shown_SearchQueryHistory;for(;e.pos<r;){let t=e.uint32();switch(t>>>3){case 1:a.actionSurface=e.string();break;case 1101:a.eventClass=e.int32();break;case 2:a.recentHistoryMap=e.string();break;default:e.skipType(7&t)}}return a},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.search.Shown_SearchQueryHistory"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="SEARCH"]=0,t})(),e})(d.Shown_SearchQueryHistory||{}),d),n)})),define("metaserver/static/js/dropbox/proto/pap_events/search/fail_search_result_preview",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;const s=(a=r.__importStar(a)).Reader,i=a.Writer,o=(a.util,a.roots.default||(a.roots.default={}));var n,d;t.default=o,t.pap_events=o.pap_events=((n=o.pap_events||{}).search=((d=n.search||{}).Fail_SearchResultPreview=(function(e){function e(e){if(e)for(let t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.searchSessionId="",e.prototype.previewRequestId="",e.prototype.timezoneOffset=0,e.prototype.viewport=0,e.prototype.failureType="",e.prototype.nsId=0,e.prototype.sjId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.actionSurface&&Object.hasOwnProperty.call(e,"actionSurface")&&t.uint32(10).string(e.actionSurface),null!=e.searchSessionId&&Object.hasOwnProperty.call(e,"searchSessionId")&&t.uint32(18).string(e.searchSessionId),null!=e.previewRequestId&&Object.hasOwnProperty.call(e,"previewRequestId")&&t.uint32(26).string(e.previewRequestId),null!=e.timezoneOffset&&Object.hasOwnProperty.call(e,"timezoneOffset")&&t.uint32(32).int64(e.timezoneOffset),null!=e.viewport&&Object.hasOwnProperty.call(e,"viewport")&&t.uint32(40).int32(e.viewport),null!=e.failureType&&Object.hasOwnProperty.call(e,"failureType")&&t.uint32(50).string(e.failureType),null!=e.nsId&&Object.hasOwnProperty.call(e,"nsId")&&t.uint32(56).int64(e.nsId),null!=e.sjId&&Object.hasOwnProperty.call(e,"sjId")&&t.uint32(64).int64(e.sjId),null!=e.eventClass&&Object.hasOwnProperty.call(e,"eventClass")&&t.uint32(8808).int32(e.eventClass),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));let r=void 0===t?e.len:e.pos+t,a=new o.pap_events.search.Fail_SearchResultPreview;for(;e.pos<r;){let t=e.uint32();switch(t>>>3){case 1:a.actionSurface=e.string();break;case 1101:a.eventClass=e.int32();break;case 2:a.searchSessionId=e.string();break;case 3:a.previewRequestId=e.string();break;case 4:a.timezoneOffset=e.int64();break;case 5:a.viewport=e.int32();break;case 6:a.failureType=e.string();break;case 7:a.nsId=e.int64();break;case 8:a.sjId=e.int64();break;default:e.skipType(7&t)}}return a},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.search.Fail_SearchResultPreview"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="SEARCH"]=0,t})(),e.Viewport=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_VIEWPORT"]=0,t[e[1]="DROPDOWN_VIEW_VIEWPORT"]=1,t[e[2]="TOP_MENU_DROPDOWN_VIEW_VIEWPORT"]=2,t[e[3]="FULL_VIEW_VIEWPORT"]=3,t[e[4]="RIGHT_RAIL_VIEWPORT"]=4,t})(),e})(d.Fail_SearchResultPreview||{}),d),n)})),define("metaserver/static/js/dropbox/proto/pap_events/search/finish_search_result_preview",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;const s=(a=r.__importStar(a)).Reader,i=a.Writer,o=(a.util,a.roots.default||(a.roots.default={}));var n,d;t.default=o,t.pap_events=o.pap_events=((n=o.pap_events||{}).search=((d=n.search||{}).Finish_SearchResultPreview=(function(e){function e(e){if(e)for(let t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.searchSessionId="",e.prototype.previewRequestId="",e.prototype.timezoneOffset=0,e.prototype.viewport=0,e.prototype.latency=0,e.prototype.previewDisplayed=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.actionSurface&&Object.hasOwnProperty.call(e,"actionSurface")&&t.uint32(10).string(e.actionSurface),null!=e.searchSessionId&&Object.hasOwnProperty.call(e,"searchSessionId")&&t.uint32(18).string(e.searchSessionId),null!=e.previewRequestId&&Object.hasOwnProperty.call(e,"previewRequestId")&&t.uint32(26).string(e.previewRequestId),null!=e.timezoneOffset&&Object.hasOwnProperty.call(e,"timezoneOffset")&&t.uint32(32).int64(e.timezoneOffset),null!=e.viewport&&Object.hasOwnProperty.call(e,"viewport")&&t.uint32(40).int32(e.viewport),null!=e.latency&&Object.hasOwnProperty.call(e,"latency")&&t.uint32(48).int64(e.latency),null!=e.previewDisplayed&&Object.hasOwnProperty.call(e,"previewDisplayed")&&t.uint32(56).bool(e.previewDisplayed),null!=e.eventClass&&Object.hasOwnProperty.call(e,"eventClass")&&t.uint32(8808).int32(e.eventClass),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));let r=void 0===t?e.len:e.pos+t,a=new o.pap_events.search.Finish_SearchResultPreview;for(;e.pos<r;){let t=e.uint32();switch(t>>>3){case 1:a.actionSurface=e.string();break;case 1101:a.eventClass=e.int32();break;case 2:a.searchSessionId=e.string();break;case 3:a.previewRequestId=e.string();break;case 4:a.timezoneOffset=e.int64();break;case 5:a.viewport=e.int32();break;case 6:a.latency=e.int64();break;case 7:a.previewDisplayed=e.bool();break;default:e.skipType(7&t)}}return a},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.search.Finish_SearchResultPreview"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="SEARCH"]=0,t})(),e.Viewport=(function(){const e={},t=Object.create(e);return t[e[0]="UNKNOWN_VIEWPORT"]=0,t[e[1]="DROPDOWN_VIEW_VIEWPORT"]=1,t[e[2]="TOP_MENU_DROPDOWN_VIEW_VIEWPORT"]=2,t[e[3]="FULL_VIEW_VIEWPORT"]=3,t[e[4]="RIGHT_RAIL_VIEWPORT"]=4,t})(),e})(d.Finish_SearchResultPreview||{}),d),n)})),define("metaserver/static/js/dropbox/proto/pap_events/search/preview_search_result",["require","exports","tslib","protobufjs/minimal","metaserver/static/js/dropbox/proto/pap_events/predefined_event"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.pap_events=void 0;const s=(a=r.__importStar(a)).Reader,i=a.Writer,o=(a.util,a.roots.default||(a.roots.default={}));var n,d;t.default=o,t.pap_events=o.pap_events=((n=o.pap_events||{}).search=((d=n.search||{}).Preview_SearchResult=(function(e){function e(e){if(e)for(let t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.actionSurface="",e.prototype.eventClass=0,e.prototype.nsId=0,e.prototype.sjId=0,e.prototype.matchType="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.actionSurface&&Object.hasOwnProperty.call(e,"actionSurface")&&t.uint32(10).string(e.actionSurface),null!=e.nsId&&Object.hasOwnProperty.call(e,"nsId")&&t.uint32(16).int64(e.nsId),null!=e.sjId&&Object.hasOwnProperty.call(e,"sjId")&&t.uint32(24).int64(e.sjId),null!=e.matchType&&Object.hasOwnProperty.call(e,"matchType")&&t.uint32(34).string(e.matchType),null!=e.eventClass&&Object.hasOwnProperty.call(e,"eventClass")&&t.uint32(8808).int32(e.eventClass),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));let r=void 0===t?e.len:e.pos+t,a=new o.pap_events.search.Preview_SearchResult;for(;e.pos<r;){let t=e.uint32();switch(t>>>3){case 1:a.actionSurface=e.string();break;case 1101:a.eventClass=e.int32();break;case 2:a.nsId=e.int64();break;case 3:a.sjId=e.int64();break;case 4:a.matchType=e.string();break;default:e.skipType(7&t)}}return a},e.getTypeUrl=function(){return"type.googleapis.com/pap_events.search.Preview_SearchResult"},e.EventClass=(function(){const e={},t=Object.create(e);return t[e[0]="SEARCH"]=0,t})(),e})(d.Preview_SearchResult||{}),d),n)})),define("metaserver/static/js/starred/browse_update",["require","exports","metaserver/static/js/starred/actions","metaserver/static/js/starred/id_type_pair","metaserver/static/js/starred/store"],(function(e,t,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkForMissingStarredData=void 0,t.checkForMissingStarredData=function({items:e,isNonUserRelativeContext:t,user:i}){if(!t){const t=e.map(a.idTypePairFromStarrableItem).filter(e=>!(!e.id||s.StarredStore.hasIdTypePair(e)));t.length&&r.StarredActions.fetchStatuses(i.role,t)}}})),define("typescript/component_libraries/files_components/src/table/columns/file_name_column",["require","exports","tslib","react","typescript/component_libraries/files_components/src/icons/file_icon","dig-components/combinations","react-intl","dig-components/typography"],(function(e,t,r,a,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNameColumn=t.getLabelIDFromRowIndex=t.FileNameCell=void 0,a=r.__importStar(a);function d(e){return`files-table-label-${e}`}t.FileNameCell=({file:e,labelID:t,subTitle:r=""})=>{const o=e.url?a.createElement(n.Link,{id:t,"data-testid":"files-filename",href:e.url},e.title):a.createElement("span",{id:t,"data-testid":"files-filename"},e.title);return a.createElement(a.Fragment,null,a.createElement(i.LabelGroup,{withLeftAccessory:a.createElement(s.FileIcon,{file:e}),withText:o,withSubtext:r}))},t.FileNameCell.displayName="FileNameCell",t.getLabelIDFromRowIndex=d,t.FileNameColumn={id:"filename",Header:()=>a.createElement(a.Fragment,null,a.createElement("div",{style:{width:"48px"}})," ",o.useIntl().formatMessage(c)),Cell:({row:e})=>a.createElement(t.FileNameCell,{file:e.original,labelID:d(e.index)}),accessor:e=>e.title,width:300};const c=o.defineMessage({id:"A2npVi",defaultMessage:"Name"})})),define("typescript/component_libraries/files_components/src/table/plugins/starring",["require","exports","tslib","react","react-redux","typescript/component_libraries/files_components/src/buttons/star_button","typescript/component_libraries/files_components/src/table/columns/file_name_column"],(function(e,t,r,a,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UseStarring=void 0,a=r.__importStar(a);t.UseStarring=({columns:e})=>{e.push(n)},t.UseStarring.pluginName="UseStarring";const n=e=>e.map(e=>{if(e.id!==o.FileNameColumn.id)return e;const t=e.Cell;return t&&"function"==typeof t?Object.assign(Object.assign({},e),{Cell:e=>{const r=e.row.original,s=d(r),n=c(r);return a.createElement(a.Fragment,null,t(e),a.createElement(i.StarButton,{isStarred:!!r.isStarred,isDisabled:!r.isStarrable,tabIndex:0,onClick:s,onKeyPress:n,ariaLabelledBy:o.getLabelIDFromRowIndex(e.row.index)}))}}):e}),d=e=>{const t=s.useDispatch();return a.useCallback(r=>{r.preventDefault(),r.stopPropagation(),e.performStarAction(!e.isStarred,t)},[e])},c=e=>{const t=s.useDispatch();return a.useCallback(r=>{"Enter"===r.key&&(r.preventDefault(),r.stopPropagation(),e.performStarAction(!e.isStarred,t))},[e])}})),define("metaserver/static/js/home/starred/starred_table",["require","exports","tslib","react","dig-experimental/managed_table/index","typescript/component_libraries/files_components/src/table/columns/file_name_column","typescript/component_libraries/files_components/src/table/plugins/starring","metaserver/static/js/components/ui/css","metaserver/static/js/home/starred/starred_to_ikea"],(function(e,t,r,a,s,i,o,n,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredTable=void 0,a=r.__importStar(a);const c=s.createManagedTable(o.UseStarring,s.useHoverActions,s.useLinkBehavior,s.useKeyboarding),l=e=>{var{data:t,columns:i}=e,n=r.__rest(e,["data","columns"]);const d=s.useManagedTable({columns:i,data:t},o.UseStarring,s.useHoverActions,s.useLinkBehavior,s.useKeyboarding,s.useFlexLayout,s.useRowSelect);return a.createElement(s.UnmanagedTable,Object.assign({instance:d},n))},u=[i.FileNameColumn],p=[s.rowSelectionColumn,i.FileNameColumn],S=({items:e,withSelection:t=!1})=>{const r=a.useMemo(()=>e.map(d.starredToIkea),[e]);return t?a.createElement(l,{isSelectable:!0,showHeader:!1,columns:p,data:r}):a.createElement(c,{isSelectable:!0,showHeader:!1,columns:u,data:r})};S.displayName="StarredTableNoCss",t.StarredTable=n.requireCssWithComponent(S,["/static/js/dig-experimental/index.web-vfl_m6TBk.css"])})),define("metaserver/static/js/home/starred/starred_to_ikea",["require","exports","tslib","react","classnames","dig-components/hooks","metaserver/static/js/home/constants","metaserver/static/js/starred/id_type_pair","metaserver/static/js/starred/actions","metaserver/static/js/home/store","metaserver/static/js/modules/core/i18n","dig-components/buttons","metaserver/static/js/home/post_tti/api","metaserver/static/js/modules/clean/navigation","metaserver/static/js/modules/clean/filepath/filepath","metaserver/static/js/home/util/paper_utils","spectrum-sharing/utils/sharing_constants","metaserver/static/js/home/util/logging/activity_logger","metaserver/static/js/home/starred/starred_uri_interface","metaserver/static/js/edison/ui/router_utils","metaserver/static/js/modules/clean/history_singleton","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/starred/redux/slice","typescript/component_libraries/files_components/src/table/columns/file_name_column"],(function(e,t,r,a,s,i,o,n,d,c,l,u,p,S,m,_,h,g,f,v,y,T,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.starredToIkea=void 0,a=r.__importStar(a),s=r.__importDefault(s);t.starredToIkea=(e,t)=>{var r;const s=Object.assign(Object.assign({},e),{index:t}),i=null===(r=e.details)||void 0===r?void 0:r.fqPath;return{uniqueKey:n.idTypePairToString({type:e.idType,id:e.resourceId}),title:e.title,extension:m.file_extension(i||""),isFolder:f.isFolder(e),isStarred:!0,isStarrable:!0,url:f.href_for_file(c.getUser(),e),renderHoverActions:()=>a.createElement(E,{item:s,index:t}),performOpenAction:e=>O(s,e),performStarAction:(e,t)=>L(s,e,t),icon:e.icon,ariaLabelledBy:b.getLabelIDFromRowIndex(t)}};const E=({item:e,index:t})=>{const r=i.useUniqueId({prefix:"starred__action-item-"});return a.createElement(u.Button,{id:r,onClick:()=>A(e),onKeyPress:t=>j(t,e),variant:"opacity","aria-labelledby":s.default(r,b.getLabelIDFromRowIndex(t))},l.intl.formatMessage({id:"At94iP",defaultMessage:"Share"}))};E.displayName="StarredHoverActions";const A=e=>{if(e.displayType===o.PAPER_DOCUMENT_RESOURCE_TYPE)return void _.sharePaperDoc(e.url,()=>w(e));w(e);const t=f.isFolder(e)?e.details.targetNsId:null,r=e.details.fqPath;p.waitForHomeTTI().then(a=>{a.asyncShowShareModal(c.getUser(),{fqPath:r,isFolder:f.isFolder(e),origin:h.SHARE_ACTION_ORIGIN_TYPE.STARRED,targetNsId:t})})},j=(e,t)=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),A(t))},L=(e,t,r)=>T.STARRED_STORE_REDUX?(r(I.updateStarredStatus({id:e.resourceId,idType:e.idType,newStatus:t,itemName:e.title,showSnackbar:!0})),Promise.resolve()):d.StarredActions.updateWithSnackbar(c.getUser().role,e.resourceId,e.idType,t,e.title),O=(e,t)=>{if(o.DisplayTypeToResourceType[e.displayType]!==o.FILE_RESOURCE_TYPE||t){const{host:r,pathname:a}=new URL(e.url);!t&&window.location.host===r&&v.shouldUseReactRouter(a)?(P(e),y.getBrowserHistory().push(a)):S.logAndNavigate(e.url,()=>P(e),t?S.NavigationMethod.NEW_TAB:S.NavigationMethod.REDIRECT)}else p.waitForHomeTTI().then(t=>t.openInFileViewer(n.idTypePairToString({type:e.idType,id:e.resourceId}),()=>P(e)))},R=e=>[e.resourceId,o.DisplayTypeToResourceType[e.displayType],e.index],w=e=>g.homeActivityLogger.logClickStarOverflowShare(...R(e)),P=e=>g.homeActivityLogger.logOpenStarredItem(...R(e))})),define("metaserver/static/js/home/util/paper_utils",["require","exports","metaserver/static/js/modules/clean/navigation"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharePaperDoc=void 0,t.sharePaperDoc=function(e,t){r.logAndNavigate(`${e}?openSharing=1`,t)}})),define("metaserver/static/js/home/starred/actions",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/home/starred/constants","metaserver/static/js/home/starred/models/starred_item","metaserver/static/js/starred/model","metaserver/static/js/home/starred/models/starred_item","metaserver/static/js/modules/core/exception","metaserver/static/js/modules/core/exception"],(function(e,t,r,a,s,i,o,n,d,c){"use strict";function l(e,t){return a.Dispatcher.dispatch({type:s.StarredResourceActionTypes.LOAD_FAILURE,error:t,loadingType:e}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.StarredActions=t.onRetrieveStarredError=void 0,c=r.__importStar(c),t.onRetrieveStarredError=l;class u{static handleRetrieveStarredPayload(e,t,r){if("success"!==r.status)throw l(t,r.status);{if(!r.items||void 0===r.has_more)throw d.reportStack("Home starred items request returned success without items or hasMore",{severity:d.SEVERITY.NONCRITICAL}),l(t,new Error("Invalid server response for Starred getItems"));const n=r.items.map(i.starredItemFromJson),c=o.statusResultsToStarredStatuses(n.map(i.starredItemModelToStarredStatus));a.Dispatcher.dispatch({type:s.StarredResourceActionTypes.LOAD_SUCCESS,hasMore:r.has_more,items:n,starredStatuses:c,loadingType:t}),e().then(({getStarredStatusMetadata:e})=>e(c))}}static handleEdisonStarredData(e,t,r){if(r.jsonData){let t;t=JSON.parse(r.jsonData),u.handleRetrieveStarredPayload(e,s.StarredLoadingTypes.ALL,t)}else if("success"===r.status){const i=n.edisonStarredDataToStarredStatus(r);a.Dispatcher.dispatch({type:s.StarredResourceActionTypes.LOAD_SUCCESS,hasMore:Boolean(r.hasMore),items:r.items,starredStatuses:i,loadingType:t}),e().then(({getStarredStatusMetadata:e})=>e(i))}else{const e=new Error("EdisonStarredPrefetchFailure");c.reportException({err:e,severity:c.SEVERITY.CRITICAL,exc_extra:{starredData:JSON.stringify(r)}}),a.Dispatcher.dispatch({type:s.StarredResourceActionTypes.LOAD_FAILURE,loadError:e,loadingType:t})}}}t.StarredActions=u})),define("metaserver/static/js/home/starred/starred_uri_interface",["require","exports","metaserver/static/js/home/constants","metaserver/static/js/modules/clean/browse_uri_interface"],(function(e,t,r,a){"use strict";function s(e){return r.DisplayTypeToResourceType[e.displayType]===r.FOLDER_RESOURCE_TYPE}Object.defineProperty(t,"__esModule",{value:!0}),t.isFolder=t.href_for_file=void 0,t.href_for_file=function(e,t,r={}){var i;if(s(t))return t.url;const o=null===(i=t.details)||void 0===i?void 0:i.fqPath;return o?a.preview_uri_for_fq_path(e,o,r).toString():t.url},t.isFolder=s})),define("typescript/component_libraries/files_components/src/buttons/star_button",["require","exports","tslib","react","classnames","react-intl","dig-components/hooks","dig-components/tooltips","dig-components/buttons","dig-components/icons","dig-components/icons/src"],(function(e,t,r,a,s,i,o,n,d,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarButton=void 0,a=r.__importStar(a),s=r.__importDefault(s);t.StarButton=({isStarred:e,onClick:t,onKeyPress:r,isDisabled:p,tabIndex:S=-1,showTooltip:m=!0,ariaLabelledBy:_})=>{const h=o.useUniqueId({prefix:"star-button-"}),g=i.useIntl(),f=u(g,e,p);let v=a.createElement(d.IconButton,{variant:"transparent",role:"button","aria-pressed":e,"aria-label":f,onClick:t,onKeyPress:r,disabled:p,tabIndex:S,"data-testid":"star__toggle",id:h,"aria-labelledby":s.default(h,_)},a.createElement(c.UIIcon,{src:e?l.StarFill:l.StarLine}));return m&&(v=a.createElement(n.Tooltip,{title:f,placement:"top"},v)),v},t.StarButton.displayName="StarButton";const u=(e,t,r)=>r?t?e.formatMessage({id:"d/rfbV",defaultMessage:"Starred"}):void 0:t?e.formatMessage({id:"U3Qbdz",defaultMessage:"Remove from Starred"}):e.formatMessage({id:"QY29C7",defaultMessage:"Add to Starred"})})),define("metaserver/static/js/starred/redux/slice",["require","exports","tslib","@reduxjs/toolkit","metaserver/static/js/starred/api","metaserver/static/js/redux/namespaces","metaserver/static/js/starred/redux/types","metaserver/static/js/starred/redux/selectors","metaserver/static/js/starred/redux/initialState","metaserver/static/js/starred/utils","metaserver/static/js/home/starred/api_post_tti","metaserver/static/js/home/store","metaserver/static/js/modules/core/exception","metaserver/static/js/home/starred/constants","metaserver/static/js/home/resource_id_types"],(function(e,t,r,a,s,i,o,n,d,c,l,u,p,S,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredActions=t.reducer=t.getAllStarred=t.updateStarredStatus=t.fetchMissingStarredStatuses=void 0,p=r.__importStar(p),t.fetchMissingStarredStatuses=a.createAsyncThunk(`${i.STARRED_NAMESPACE_KEY}/getStarredStatus`,(e,{getState:a,dispatch:i})=>r.__awaiter(void 0,void 0,void 0,(function*(){const r=u.getRole(),d=n.getStarredState(a());if(!d)return[];const c=e.filter(({id:e})=>{var t;return(null===(t=d.starredStates[e])||void 0===t?void 0:t.loadingState)!==o.StarredLoadingStateEnum.LOADING});return 0===c.length?[]:(i(t.StarredActions.setLoadingStates(c)),yield s.fetchStatuses(r,c))}))),t.updateStarredStatus=a.createAsyncThunk(`${i.STARRED_NAMESPACE_KEY}/updateStarredStatus`,({id:e,newStatus:a,idType:i=m.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID},{getState:o,dispatch:d})=>r.__awaiter(void 0,void 0,void 0,(function*(){const r=n.getHasLoadedInitial(o()),c=yield s.update(u.getRole(),e,i,a);return r&&!0===a&&d(t.getAllStarred()),c}))),t.getAllStarred=a.createAsyncThunk(`${i.STARRED_NAMESPACE_KEY}/getAllStarred`,()=>r.__awaiter(void 0,void 0,void 0,(function*(){const e=yield l.retrieveStarred(S.LOAD_ALL_ITEMS_COUNT);return"success"===e.status&&e.items?e:(p.reportStack("Failed to fetch starred files",{severity:p.SEVERITY.CRITICAL,exc_extra:e,silent:!0}),Promise.reject(new Error("Failed to fetch starred files")))})));const _=e=>{var{resource_id:t,id_type:a,display_type:s}=e,i=e.details,{fq_path:o}=i,n=r.__rest(i,["fq_path"]),d=r.__rest(e,["resource_id","id_type","display_type","details"]);return Object.assign({resourceId:t,idType:a,displayType:s,details:Object.assign({fqPath:o},n)},d)},h=e=>{e.starredFilesMetadata.items.forEach(({resourceId:t})=>{e.starredStates[t]={isStarred:!0,loadingState:o.StarredLoadingStateEnum.LOAD_SUCCESS}})},g=a.createSlice({name:i.STARRED_NAMESPACE_KEY,initialState:d.starredInitialState,reducers:{clear:()=>d.starredInitialState,setStarredStatus:(e,t)=>{e.starredStates[t.payload.id]={loadingState:o.StarredLoadingStateEnum.LOAD_SUCCESS,isStarred:t.payload.isStarred}},setLoadingStates:(e,t)=>{t.payload.forEach(({id:t})=>{void 0===e.starredStates[t]?e.starredStates[t]={loadingState:o.StarredLoadingStateEnum.LOADING}:e.starredStates[t].loadingState=o.StarredLoadingStateEnum.LOADING})},setStarredMetadata:(e,t)=>{const r=t.payload;"success"===r.status?(e.starredFilesMetadata={items:r.items.map(_),loadingState:o.StarredLoadingStateEnum.LOAD_SUCCESS,hasMore:r.hasMore,hasLoadedInitial:!0},h(e)):e.starredFilesMetadata.loadingState=o.StarredLoadingStateEnum.LOAD_FAILED}},extraReducers:e=>{e.addCase(t.fetchMissingStarredStatuses.fulfilled,(e,t)=>{t.payload.forEach(({id:t,is_starred:r})=>{e.starredStates[t]={loadingState:o.StarredLoadingStateEnum.LOAD_SUCCESS,isStarred:r}})}).addCase(t.fetchMissingStarredStatuses.rejected,(e,t)=>{t.meta.arg.forEach(({id:r})=>{var a,s;e.starredStates[r]={loadingState:o.StarredLoadingStateEnum.LOAD_FAILED,error:null!==(s=null===(a=null==t?void 0:t.error)||void 0===a?void 0:a.message)&&void 0!==s?s:"error fetching starred starred data"}})}).addCase(t.updateStarredStatus.fulfilled,(e,t)=>{const{id:r}=t.meta.arg,a=e.starredStates[r];if(a.loadingState===o.StarredLoadingStateEnum.LOAD_SUCCESS&&(a.isStarred=t.meta.arg.newStatus,t.meta.arg.showSnackbar)){const{itemName:e,newStatus:r}=t.meta.arg;c.displayStarSnackbar({itemName:e,isStarred:r,success:!0})}}).addCase(t.updateStarredStatus.rejected,(e,t)=>{if(t.meta.arg.showSnackbar){const{itemName:e,newStatus:r}=t.meta.arg;c.displayStarSnackbar({itemName:e,isStarred:r,success:!1})}}).addCase(t.getAllStarred.pending,e=>{e.starredFilesMetadata.loadingState=o.StarredLoadingStateEnum.LOADING}).addCase(t.getAllStarred.fulfilled,(e,t)=>{e.starredFilesMetadata.loadingState=o.StarredLoadingStateEnum.LOAD_SUCCESS,t.payload.items&&(e.starredFilesMetadata.items=t.payload.items.map(_),h(e),e.starredFilesMetadata.hasLoadedInitial=!0)}).addCase(t.getAllStarred.rejected,e=>{e.starredFilesMetadata.loadingState=o.StarredLoadingStateEnum.LOAD_FAILED})}});t.reducer=g.reducer,t.StarredActions=g.actions})),define("metaserver/static/js/starred/api",["require","exports","metaserver/static/js/deprecated_ajax/ajax_jquery"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.update=t.fetchStatuses=void 0;const a=(e,t,a)=>new Promise((s,i)=>{(a?r.SilentBackgroundRequest:r.WebRequest)({url:e,type:"POST",dataType:"json",data:t,success:s,error:(e,t,r)=>i(Error(`error: ${r}, status: ${t}`))})});t.fetchStatuses=(e,t)=>a("/starred/get_status",{role:e,resources_json:JSON.stringify(t)},!0);t.update=(e,t,r,s)=>a("/starred/update",{role:e,resource_id:t,id_type:r,is_starred:s},!0)})),define("metaserver/static/js/home/starred/api_post_tti",["require","exports","tslib","metaserver/static/js/home/api","metaserver/static/js/home/store"],(function(e,t,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveStarred=void 0,t.retrieveStarred=function(e){return r.__awaiter(this,void 0,void 0,(function*(){return yield a.makeRequest({url:"/home_feed/retrieve_starred",type:"POST",data:{role:s.getRole(),limit:e}})}))}})),define("metaserver/static/js/starred/redux/initialState",["require","exports","metaserver/static/js/starred/redux/types"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.starredInitialState=void 0,t.starredInitialState={starredStates:{},starredFilesMetadata:{loadingState:r.StarredLoadingStateEnum.NOT_STARTED,items:[],hasMore:!0,hasLoadedInitial:!1}}})),define("metaserver/static/js/home/starred/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INITIAL_STARRED_ITEMS_LIMIT=t.LOAD_ALL_ITEMS_COUNT=t.StarredLoadingTypes=t.StarredLoggingTypes=t.NOT_PAPER_USER_ERROR=t.StarredResourceActionTypes=void 0,t.StarredResourceActionTypes={LOADING_INITIAL:"HOME_STARRED_LOADING_INITIAL",LOADING_ALL:"HOME_STARRED_LOADING_ALL",LOAD_SUCCESS:"HOME_STARRED_LOAD_SUCCESS",LOAD_FAILURE:"HOME_STARRED_LOAD_FAILURE",HIDE_EMPTY_SECTION:"HOME_STARRED_HIDE_EMPTY_SECTION"},t.NOT_PAPER_USER_ERROR="not_paper_user",t.StarredLoggingTypes={CLICK_STAR:"click_star",CLICK_UNSTAR:"click_unstar"},t.StarredLoadingTypes={INITIAL:"INITIAL",ALL:"ALL"},t.LOAD_ALL_ITEMS_COUNT=1e3,t.INITIAL_STARRED_ITEMS_LIMIT=5})),define("metaserver/static/js/starred/model",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.statusResultsToStarredStatuses=void 0,t.statusResultsToStarredStatuses=function(e){return e.map(e=>{const{id:t,type:r,is_starred:a,canonical_id:s,canonical_id_type:i}=e,o={idTypePair:{id:t,type:r},starred:a};return s&&i&&(o.canonicalIdTypePair={id:s,type:i}),o})}})),define("metaserver/static/js/starred/redux/selectors",["require","exports","@reduxjs/toolkit","metaserver/static/js/redux/namespaces","metaserver/static/js/redux/selectors","metaserver/static/js/starred/redux/initialState","metaserver/static/js/starred/redux/types"],(function(e,t,r,a,s,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isStarred=t.getHasLoadedInitial=t.getHasMore=t.getStarredItems=t.getMetadataLoadingState=t.getFileMetadata=t.getIsStarred=t.getStarredFileIds=t.getStarredBoolObject=t.getFileStarredData=t.getStarredStatuses=t.getStarredState=void 0;t.getStarredState=e=>s.getStateAtNamespace(e,a.STARRED_NAMESPACE_KEY)||i.starredInitialState;t.getStarredStatuses=e=>t.getStarredState(e).starredStates;t.getFileStarredData=(e,r)=>t.getStarredStatuses(e)[r],t.getStarredBoolObject=r.createSelector(t.getStarredStatuses,e=>e,(e,r)=>Object.keys(e).reduce((e,a)=>(e[a]=t.getIsStarred(r,a),e),{})),t.getStarredFileIds=r.createSelector(t.getStarredBoolObject,e=>Object.keys(e).filter(t=>e[t]));t.getIsStarred=(e,r)=>{const a=t.getFileStarredData(e,r);return(null==a?void 0:a.loadingState)===o.StarredLoadingStateEnum.LOAD_SUCCESS&&a.isStarred};t.getFileMetadata=e=>t.getStarredState(e).starredFilesMetadata;t.getMetadataLoadingState=e=>t.getFileMetadata(e).loadingState,t.getStarredItems=r.createSelector(t.getFileMetadata,t.getStarredStatuses,(e,r)=>e.items.filter(({resourceId:e})=>t.isStarred(r[e])));t.getHasMore=e=>t.getFileMetadata(e).hasMore;t.getHasLoadedInitial=e=>t.getFileMetadata(e).hasLoadedInitial;t.isStarred=e=>{var t;return(e.loadingState===o.StarredLoadingStateEnum.LOAD_SUCCESS||e.loadingState===o.StarredLoadingStateEnum.LOADING)&&(null!==(t=e.isStarred)&&void 0!==t&&t)}})),define("metaserver/static/js/starred/utils",["require","exports","metaserver/static/js/modules/core/i18n","metaserver/static/js/modules/clean/react/snackbar"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayStarSnackbar=void 0;t.displayStarSnackbar=({itemName:e,isStarred:t,success:s})=>{if(s){let s;s=e?t?r.intl.formatMessage({id:"m96IvY",defaultMessage:"Starred {itemName}."},{itemName:e}):r.intl.formatMessage({id:"Yn2gx1",defaultMessage:"Unstarred {itemName}."},{itemName:e}):t?r.intl.formatMessage({id:"IxGSEU",defaultMessage:"Starred."},{itemName:e}):r.intl.formatMessage({id:"RZWOu0",defaultMessage:"Unstarred."},{itemName:e}),a.Snackbar.complete(s,"star-action")}else{let s;s=e?t?r.intl.formatMessage({id:"5O9Xva",defaultMessage:"There was a problem starring {item_name}"},{item_name:e}):r.intl.formatMessage({id:"CvW0nU",defaultMessage:"There was a problem unstarring {item_name}"},{item_name:e}):t?r.intl.formatMessage({id:"jouX9E",defaultMessage:"There was a problem starring your selection"}):r.intl.formatMessage({id:"TkdYlT",defaultMessage:"There was a problem unstarring your selection"}),a.Snackbar.fail(s,"star-action")}}})),define("metaserver/static/js/home/starred/models/starred_item",["require","exports","metaserver/static/js/home/constants"],(function(e,t,r){"use strict";function a(e,t){const a=r.DisplayTypeToResourceType[e];if(a===r.FILE_RESOURCE_TYPE){return{fqPath:t.fq_path}}if(a===r.FOLDER_RESOURCE_TYPE){const e=t;return{fqPath:e.fq_path,targetNsId:e.target_ns_id,isTeamMemberFolder:e.is_team_member_folder}}return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.starredItemModelToStarredStatus=t.edisonStarredDataToStarredStatus=t.detailsFromJson=t.starredItemFromJson=void 0,t.starredItemFromJson=function(e){return{title:e.title,resourceId:e.resource_id,idType:e.id_type,displayType:e.display_type,url:e.url,isMounted:e.is_mounted,perNodeMetadata:e.per_node_metadata,details:a(e.display_type,e.details),icon:e.icon}},t.detailsFromJson=a,t.edisonStarredDataToStarredStatus=function(e){return e.items.map(e=>({idTypePair:{id:e.resourceId,type:e.idType},starred:!0}))},t.starredItemModelToStarredStatus=function(e){return{id:e.resourceId,type:e.idType,is_starred:!0}}})),define("metaserver/static/js/starred/redux/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredLoadingStateEnum=void 0,(function(e){e.NOT_STARTED="NOT_STARTED",e.LOADING="LOADING",e.LOAD_SUCCESS="LOAD_SUCCESS",e.LOAD_FAILED="LOAD_FAILED"})(t.StarredLoadingStateEnum||(t.StarredLoadingStateEnum={}))})),define("metaserver/static/js/starred/actions",["require","exports","tslib","metaserver/static/js/flux/dispatcher","metaserver/static/js/starred/api","metaserver/static/js/starred/constants","metaserver/static/js/starred/model","metaserver/static/js/starred/utils"],(function(e,t,r,a,s,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredActions=void 0,s=r.__importStar(s);class d{static setStarredStatus(e,t){a.Dispatcher.dispatch({type:i.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:e,starred:t}]})}static fetchStatuses(e,t,r=!1){return r||d.markAsLoading(t),s.fetchStatuses(e,t).then(e=>{a.Dispatcher.dispatch({type:i.StarredActionTypes.SET_STATUS,starredStatuses:o.statusResultsToStarredStatuses(e)})}).catch(e=>(a.Dispatcher.dispatch({type:i.StarredActionTypes.LOAD_FAILURE,idTypePairs:t}),Promise.reject(e)))}static markAsLoading(e){a.Dispatcher.dispatch({type:i.StarredActionTypes.LOADING,idTypePairs:e})}static update(e,t,r,o){const n={id:t,type:r};let d;a.Dispatcher.dispatch({type:i.StarredActionTypes.LOADING,idTypePairs:[n]});const c=s.update(e,t,r,o);return c.then(()=>d=o).catch(e=>{throw d=!o,e}).finally(()=>{a.Dispatcher.dispatch({type:i.StarredActionTypes.SET_STATUS,starredStatuses:[{idTypePair:{id:t,type:r},starred:d}]})}),c}static updateWithSnackbar(e,t,r,a,s){return d.update(e,t,r,a).then(()=>{n.displayStarSnackbar({itemName:s,isStarred:a,success:!0})}).catch(e=>{n.displayStarSnackbar({itemName:s,isStarred:a,success:!1})})}}t.StarredActions=d})),define("metaserver/static/js/home/starred/starred_files_table",["require","exports","tslib","react","metaserver/static/js/home/starred/starred_to_ikea","typescript/component_libraries/files_components/src/files-table/files-table"],(function(e,t,r,a,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredFilesTable=void 0,a=r.__importStar(a);t.StarredFilesTable=({items:e})=>{const t=a.useMemo(()=>e.map(s.starredToIkea),[e]);return a.createElement(i.FilesTable,{items:t,hasRowSelection:!0})},t.StarredFilesTable.displayName="StarredFilesTable"}));
//# sourceMappingURL=pkg-starred.min.js-vflpI6nTi.map