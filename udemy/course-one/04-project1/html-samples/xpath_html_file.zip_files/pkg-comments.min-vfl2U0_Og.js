define("typescript/component_libraries/files_components/src/blades/comments/data/uuid",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.v4=void 0;const n=(()=>{let e,t;const n=[];for(e=0,t=e;e<=255;e++,t=e)n.push((t+256).toString(16).substr(1));return n})();function a(e){return e.map(e=>n[e]).join("")}t.v4=function(){const e=(function(){const e=new Uint8Array(16);return window.crypto&&window.crypto.getRandomValues(e),e})();e[6]=15&e[6]|64,e[8]=63&e[8]|128;const t=Array.prototype.slice.call(e);return[t.slice(0,4),t.slice(4,6),t.slice(6,8),t.slice(8,10),t.slice(10,16)].map(a).join("-")}})),define("typescript/component_libraries/files_components/src/blades/comments/component/meatball_menu",["require","exports","tslib","react","dig-components/icons/src","dig-components/icons","dig-components/badges","dig-components/buttons","dig-components/menu","react-redux","react-intl","typescript/component_libraries/files_components/src/blades/comments/data/actions","typescript/component_libraries/files_components/src/blades/comments/data/selectors","typescript/component_libraries/files_components/src/blades/comments/data/transform","typescript/libraries/api_v2/redux/comments2","typescript/component_libraries/files_components/src/blades/comments/data/types","typescript/component_libraries/flows/src/components/approval-forms/index"],(function(e,t,n,a,r,o,s,i,c,d,l,m,u,p,f,b,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommentsMeatball=void 0,a=n.__importStar(a);const v=l.defineMessage({id:"U75RtN",defaultMessage:"Hide resolved comments"}),A=l.defineMessage({id:"fKXJUR",defaultMessage:"Show resolved comments"}),_=l.defineMessage({id:"w904jy",defaultMessage:"Unsubscribe"}),h=l.defineMessage({id:"cnLKs9",defaultMessage:"Subscribe"}),y=l.defineMessage({id:"/XlCxM",defaultMessage:"Disable comments"}),C=l.defineMessage({id:"bppWf8",defaultMessage:"Enable comments"}),O=l.defineMessage({id:"mmoAzk",defaultMessage:"Auto-enable section commenting"}),T=l.defineMessage({id:"qfiUHj",defaultMessage:"Disable section commenting"});t.CommentsMeatball=a.default.memo(({className:e,fileId:t,sharedLinkURL:n,size:M,approvalVariant:I,approvalCopyVariant:S,approvalsLogger:E,dragSectionAnnotationEnabled:j})=>{const w=d.useDispatch(),R=l.useIntl(),D=p.createStreamFromFileOrSharedLink(t,n),U=b.createCommentFileIdentifier(t,n),L=d.useSelector(e=>e.showResolvedComments),k=d.useSelector(e=>{var t;return null===(t=e.permissions[U])||void 0===t?void 0:t.can_enable_commenting}),F=d.useSelector(e=>u.areCommentsEnabled(e,U)),N=d.useSelector(e=>{var t;return null===(t=e.permissions[U])||void 0===t?void 0:t.can_subscribe}),x=d.useSelector(e=>u.isUserSubscribed(e,U)),V=d.useSelector(e=>u.isSingularlyAnnotating(e)),[P,q]=a.default.useState({showResolvedComments:L,inSingleAnnotatingMode:V}),B=a.useCallback(()=>{w(m.updateShowResolvedComments(!L))},[w,L]),H=a.useCallback(()=>w(f.subscribeAction({arg:{stream:D}})),[w,D]),z=a.useCallback(()=>w(f.unsubscribeAction({arg:{stream:D}})),[w,D]),W=a.useCallback(()=>w(f.enableCommentingAction({arg:{stream:D}})),[w,D]),K=a.useCallback(()=>w(f.disableCommentingAction({arg:{stream:D}})),[w,D]),Y=a.useCallback(()=>{E&&E(),w(g.setApprovalForm({[U]:{activeForm:"request",threadId:void 0}}))},[w,U,E]),G=a.useCallback(()=>{w(V?m.updateAnnotationMode(b.SectionAnnotationMode.continuous):m.updateAnnotationMode(b.SectionAnnotationMode.single))},[w,V]),J=a.default.useCallback(({isOpen:e})=>{e&&q({inSingleAnnotatingMode:V,showResolvedComments:L})},[V,L]);return F||k?a.default.createElement(c.Menu.Wrapper,{className:e,onToggle:J},({getContentProps:e,getTriggerProps:t})=>a.default.createElement(a.default.Fragment,null,a.default.createElement(i.IconButton,Object.assign({variant:"transparent"},t(),{size:M,"aria-label":R.formatMessage({id:"OD3YF0",defaultMessage:"Other actions"})}),a.default.createElement(o.UIIcon,{src:r.MoreHorizontalLine,size:M})),a.default.createElement(c.Menu.Content,Object.assign({},e()),a.default.createElement(c.Menu.Segment,null,a.default.createElement(c.Menu.ActionItem,{value:P.showResolvedComments?"hide-resolve-comments":"show-resolve-comments",onClick:B,disabled:!F},P.showResolvedComments?R.formatMessage(v):R.formatMessage(A)),N?a.default.createElement(c.Menu.ActionItem,{value:x?"unsubscribe":"subscribe",onClick:x?z:H,disabled:!F},x?R.formatMessage(_):R.formatMessage(h)):null,k?a.default.createElement(c.Menu.ActionItem,{value:x?"enableComments":"disableComments",onClick:F?K:W},F?R.formatMessage(y):R.formatMessage(C)):null,g.isApprovalEnabled(I)&&a.default.createElement(c.Menu.ActionItem,{value:"requestApproval",onClick:Y,withTitle:a.default.createElement(a.default.Fragment,null,R.formatMessage(g.approvalCopyExperimentString(S)),a.default.createElement(s.AccessoryBadge,{style:{marginLeft:4}},R.formatMessage({id:"VgsgAq",defaultMessage:"New"})))}),j&&a.default.createElement(c.Menu.ActionItem,{onClick:G,disabled:!F},P.inSingleAnnotatingMode?R.formatMessage(O):R.formatMessage(T)))))):null}),t.CommentsMeatball.displayName="CommentsMeatball"})),define("typescript/component_libraries/files_components/src/blades/comments/data/transform",["require","exports","typescript/component_libraries/files_components/src/blades/comments/data/uuid"],(function(e,t,n){"use strict";function a(e){return{type:{".tag":"file"},identifier:{".tag":"file_path_or_id",file_path_or_id:e}}}function r(e){return{type:{".tag":"file"},identifier:{".tag":"shared_link_details",url:e}}}Object.defineProperty(t,"__esModule",{value:!0}),t.createStreamFromFileOrSharedLink=t.createStreamFromSharedLink=t.createStreamFromFileId=t.newCommentFromICommentContent=t.accountToCommentStreamUser=void 0,t.accountToCommentStreamUser=function(e){return{id:e.account_id,name:{display:e.name.display_name,initials:e.name.abbreviated_name,public:e.name.display_name},photoUrl:e.profile_photo_url}},t.newCommentFromICommentContent=function({content:e,threadId:t,author:a}){const r=new Date;return{id:n.v4(),timestamp:r,threadId:t,author:a,content:e,userPermissions:{canDelete:!1,canEdit:!1},revisionInfo:{isCurrent:!0,timestamp:r}}},t.createStreamFromFileId=a,t.createStreamFromSharedLink=r,t.createStreamFromFileOrSharedLink=function(e,t){return t?r(t):a(e)}})),define("typescript/component_libraries/files_components/src/blades/comments/data/logging_middleware",["require","exports","typescript/libraries/api_v2/redux/comments2","typescript/component_libraries/files_components/src/blades/comments/data/actions"],(function(e,t,n,a){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.createCommentsBladeLoggingMiddleware=t.CommentsEventName=void 0,(r=t.CommentsEventName||(t.CommentsEventName={})).ADD_COMMENT="add_comment",r.DELETE_COMMENT="delete_comment",r.REPLY_COMMENT="reply_comment",r.EDIT_COMMENT="edit_comment",r.SUBSCRIBE_COMMENTS="subscribe_comments",r.UNSUBSCRIBE_COMMENTS="unsubscribe_comments",r.DISABLE_COMMENTS="disable_comments",r.ENABLE_COMMENTS="enable_comments",r.SHOW_RESOLVED_COMMENTS="show_resolved_comments",r.HIDE_RESOLVED_COMMENTS="hide_resolved_comments",r.SORT_COMMENTS="sort_comments";const o=e=>{if(!e)return!1;if("document"===e.type&&"rectangle"===e.regionType&&1===e.regions.length){const t=e.regions[0];if(0===t.x&&0===t.y&&1===t.height&&1===t.width)return!1}return!0};t.createCommentsBladeLoggingMiddleware=e=>({})=>r=>s=>{var i;switch(s.type){case n.Action.AddCommentResult:const r=Boolean(s.payload.arg.thread_id);e({event:r?t.CommentsEventName.REPLY_COMMENT:t.CommentsEventName.ADD_COMMENT,extra:{hasAnnotation:String(o(null===(i=s.meta)||void 0===i?void 0:i.annotation))}});break;case n.Action.DeleteCommentResult:e({event:t.CommentsEventName.DELETE_COMMENT});break;case n.Action.EditCommentResult:e({event:t.CommentsEventName.EDIT_COMMENT});break;case n.Action.UnsubscribeResult:e({event:t.CommentsEventName.UNSUBSCRIBE_COMMENTS});break;case n.Action.SubscribeResult:e({event:t.CommentsEventName.SUBSCRIBE_COMMENTS});break;case n.Action.DisableCommentingResult:e({event:t.CommentsEventName.DISABLE_COMMENTS});break;case n.Action.EnableCommentingResult:e({event:t.CommentsEventName.ENABLE_COMMENTS});break;case a.Action.UpdateShowResolvedComments:e({event:s.payload.showResolvedComments?t.CommentsEventName.SHOW_RESOLVED_COMMENTS:t.CommentsEventName.HIDE_RESOLVED_COMMENTS});break;case a.Action.SortComments:e({event:t.CommentsEventName.SORT_COMMENTS})}return r(s)}})),define("typescript/component_libraries/files_components/src/blades/comments/data/bolt_middleware",["require","exports","typescript/component_libraries/files_components/src/blades/comments/data/actions","typescript/libraries/api_v2/redux/comments2"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.middleware=void 0;t.middleware=function(e){return({dispatch:t,getState:r})=>(e.onSignal(e=>{e.updatedChannels.filter(e=>"comments2"===e.channelId.appId).map(e=>{const n=r().boltInfo.boltUniqueIdToStream[e.channelId.uniqueId];n&&t(a.listCommentsAction({arg:{include_permissions:!0,stream:n}}))})}),t=>a=>{switch(a.type){case n.Action.BoltSubscribe:e.subscribe(a.payload.map(e=>({channelId:{appId:e.app_id,uniqueId:e.unique_id},revisionInfo:{revision:+e.revision,token:e.token}})));break;case n.Action.BoltUnsubscribe:e.unsubscribe(a.payload.map(e=>({channelId:{appId:e.app_id,uniqueId:e.unique_id},revisionInfo:{revision:+e.revision,token:e.token}})))}return t(a)})}})),define("typescript/libraries/comments2/src/mentions/middleware",["require","exports","tslib","typescript/libraries/comments2/src/mentions/actions"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.middleware=void 0,t.middleware=function(e){return t=>t=>r=>n.__awaiter(this,void 0,void 0,(function*(){let n=t(r);if(r.type===a.MentionsAction.SearchContacts){let o;const s=e();try{o=a.searchContactsResult({query:r.payload,result:(yield s.search(r.payload))[r.payload]})}catch(e){return n}n=t(o)}else r.type===a.MentionsAction.WarmContacts&&e();return n}))}})),define("typescript/libraries/comments2/src/mentions/actions",["require","exports"],(function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.searchContactsResult=t.searchContacts=t.warmContacts=t.MentionsAction=void 0,(n=t.MentionsAction||(t.MentionsAction={})).WarmContacts="@@contacts/warm",n.SearchContacts="@@contacts/search",n.SearchContactsResult="@@contacts/searchResult",t.warmContacts=function(e){return{type:t.MentionsAction.WarmContacts,payload:e}},t.searchContacts=function(e){return{type:t.MentionsAction.SearchContacts,payload:e}},t.searchContactsResult=function(e){return{type:t.MentionsAction.SearchContactsResult,payload:e}}})),define("typescript/component_libraries/files_components/src/blades/comments/data/actions",["require","exports"],(function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.updateAnnotationMode=t.updateShowResolvedComments=t.resolveNavigationToActiveThreadAnnotation=t.focusEditor=t.editorDidFocus=t.deleteAndCommitThread=t.deleteAndCommitComment=t.editAndCommitComment=t.addAndCommitComment=t.sortComments=t.cancelAnnotating=t.confirmDraftAnnotation=t.startAnnotating=t.clearDraftAnnotation=t.updateDraftAnnotation=t.focusThread=t.hoverThread=t.boltUnsubscribe=t.boltSubscribe=t.deactivateAllThreads=t.activateInitialThread=t.activateThread=t.Action=void 0,(n=t.Action||(t.Action={})).ActivateThread="@@comments/activateThread",n.ActivateInitialThread="@@comments/activateInitialThread",n.DeactivateAllThreads="@@comments/deactivateThread",n.FocusThread="@@comments/focusThread",n.HoverThread="@@comments/hoverThread",n.BoltSubscribe="@@comments/bolt/subscribe",n.BoltUnsubscribe="@@comments/bolt/unsubscribe",n.UpdateDraftAnnotation="@@comments/updateDraftAnnotation",n.ClearDraftAnnotation="@@comments/clearDraftAnnotation",n.FocusEditor="@@comments/focusEditor",n.EditorDidFocus="@@comments/editorDidFocus",n.ResolveNavigationToActiveThreadAnnotation="@@comments/resolveNavigationToActiveThreadAnnotation",n.UpdateShowResolvedComments="@@comments/updateShowResolvedComments",n.UpdateAnnotationMode="@@comments/UpdateCurrentAnnotationMode",n.StartAnnotating="@@comments/startAnnotating",n.ConfirmDraftAnnotation="@@comments/confirmDraftAnnotation",n.CancelAnnotating="@@comments/cancelAnnotating",n.AddAndCommitComment="@@comments/addAndCommitComment",n.EditAndCommitComment="@@comments/editAndCommitComment",n.DeleteAndCommitComment="@@comments/deleteAndCommitComment",n.DeleteAndCommitThread="@@comments/deleteAndCommitThread",n.SortComments="@@comments/sortComments",t.activateThread=function(e){return{type:t.Action.ActivateThread,payload:e}},t.activateInitialThread=function(e){return{type:t.Action.ActivateInitialThread,payload:e}},t.deactivateAllThreads=function(e){return{type:t.Action.DeactivateAllThreads,payload:e}},t.boltSubscribe=function(e){return{type:t.Action.BoltSubscribe,payload:e}},t.boltUnsubscribe=function(e){return{type:t.Action.BoltUnsubscribe,payload:e}},t.hoverThread=function(e,n){return{type:t.Action.HoverThread,payload:{fileViewerId:e,threadId:n}}},t.focusThread=function(e,n){return{type:t.Action.FocusThread,payload:{fileViewerId:e,threadId:n}}},t.updateDraftAnnotation=function(e,n){return{type:t.Action.UpdateDraftAnnotation,payload:{fileViewerId:e,annotation:n}}},t.clearDraftAnnotation=function(e){return{type:t.Action.ClearDraftAnnotation,payload:{fileViewerId:e}}},t.startAnnotating=function(e,n){return{type:t.Action.StartAnnotating,payload:{fileViewerId:e,accessible:n}}},t.confirmDraftAnnotation=function(e){return{type:t.Action.ConfirmDraftAnnotation,payload:{fileViewerId:e}}},t.cancelAnnotating=function(e){return{type:t.Action.CancelAnnotating,payload:{fileViewerId:e}}},t.sortComments=function(){return{type:t.Action.SortComments,payload:{}}},t.addAndCommitComment=function(e,n,a,r){return{type:t.Action.AddAndCommitComment,payload:{author:e,content:a,fileIdentifier:n,threadId:r}}},t.editAndCommitComment=function(e,n,a,r,o){return{type:t.Action.EditAndCommitComment,payload:{author:e,content:o,fileIdentifier:n,threadId:a,commentId:r}}},t.deleteAndCommitComment=function(e,n,a,r){return{type:t.Action.DeleteAndCommitComment,payload:{author:e,fileIdentifier:n,threadId:a,commentId:r}}},t.deleteAndCommitThread=function(e,n,a){return{type:t.Action.DeleteAndCommitThread,payload:{author:e,fileIdentifier:n,threadId:a}}},t.editorDidFocus=function(e){return{type:t.Action.EditorDidFocus,payload:{fileViewerId:e}}},t.focusEditor=function(e){return{type:t.Action.FocusEditor,payload:{fileViewerId:e}}},t.resolveNavigationToActiveThreadAnnotation=function(e){return{type:t.Action.ResolveNavigationToActiveThreadAnnotation,payload:{fileViewerId:e}}},t.updateShowResolvedComments=function(e){return{type:t.Action.UpdateShowResolvedComments,payload:{showResolvedComments:e}}},t.updateAnnotationMode=function(e){return{type:t.Action.UpdateAnnotationMode,payload:{updatedAnnotationMode:e}}}})),define("typescript/component_libraries/files_components/src/blades/comments/data/read_thread_middleware",["require","exports","tslib","typescript/libraries/api_v2/redux/comments2","typescript/component_libraries/files_components/src/blades/comments/data/actions","typescript/component_libraries/files_components/src/blades/comments/data/transform","typescript/component_libraries/files_components/src/blades/comments/data/types"],(function(e,t,n,a,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMiddleware=void 0;t.createMiddleware=()=>({dispatch:e,getState:t})=>i=>c=>n.__awaiter(void 0,void 0,void 0,(function*(){const n=i(c);if(c.type===r.Action.ActivateThread||c.type===r.Action.ActivateInitialThread){const{threadId:r,fileId:i,sharedLinkURL:d}=c.payload,l=t().threads[s.createCommentFileIdentifier(i,d)];if(null==l)return n;const m=l[r];if(m&&!m.read&&!m.readonly){const t=o.createStreamFromFileOrSharedLink(i,d);e(a.markThreadReadAction({arg:{id:m.id,stream:t}}))}}return n}))})),define("typescript/component_libraries/files_components/src/blades/comments/data/reducer",["require","exports","typescript/component_libraries/files_components/src/blades/comments/data/actions","typescript/libraries/comments2/src/mentions/index","typescript/libraries/comments2/src/transforms/index","typescript/component_libraries/files_components/src/blades/comments/data/transform","redux","typescript/component_libraries/files_components/src/blades/comments/data/types","typescript/libraries/api_v2/redux/comments2","typescript/libraries/api_v2/redux/media_addon","typescript/component_libraries/flows/src/components/approval-forms/reducer","typescript/component_libraries/files_components/src/blades/comments/data/uuid"],(function(e,t,n,a,r,o,s,i,c,d,l,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducer=t.reducers=t.DEFAULT_STATE=t.Status=void 0;var u;(u=t.Status||(t.Status={}))[u.Disabled=0]="Disabled",u[u.ReadOnly=1]="ReadOnly",u[u.FullyEnabled=2]="FullyEnabled",t.DEFAULT_STATE={threads:{},supportedEnhancements:{},boltInfo:{fileIdentifierToBoltMap:{},boltUniqueIdToStream:{}},activeThreadID:{},focusedThreadID:{},hoverThreadID:{},mentionsSearchResult:{currentQuery:"",result:[]},draftAnnotation:{},annotationState:null,permissions:{},editorFocusRequest:{},pendingNavigationToActiveThreadAnnotation:{},status:{},thirdPartySource:{},mediaAddonFeatures:null,subscriptionStatus:{},enableCommentStatus:{},showResolvedComments:!1,approvalFormStatus:{},annotationMode:i.SectionAnnotationMode.single};const p=e=>{const{payload:{arg:{stream:t}}}=e;return f(t)};function f(e){return"file_path_or_id"===e.identifier[".tag"]?e.identifier.file_path_or_id:"shared_link_details"===e.identifier[".tag"]?e.identifier.url:void 0}function b(e){const{stream:t,id:n}=e.payload.arg;return"file_path_or_id"===t.identifier[".tag"]?{fileIdOrUrl:t.identifier.file_path_or_id,threadId:n}:"shared_link_details"===t.identifier[".tag"]?{fileIdOrUrl:t.identifier.url,threadId:n}:{}}function g(e){var t;const{payload:{arg:{id:n,stream:{identifier:a}}}}=e,r=null===(t=e.meta)||void 0===t?void 0:t.threadId;return"file_path_or_id"===a[".tag"]?{fileIdOrUrl:a.file_path_or_id,commentId:n,threadId:r}:"shared_link_details"===a[".tag"]?{fileIdOrUrl:a.url,commentId:n,threadId:r}:{}}function v(e,t,n,a){return Object.assign(Object.assign({},e),{[t]:n,pending:{action:a,originalValue:e[t],pendingValue:n}})}function A(e,t,n,a,r){const{comments:o}=e,s=o.findIndex(e=>e.id===t),i=o[s];if(!i)return e;const c=Object.assign(Object.assign({},i),{[n]:a}),d=[...o];return d.splice(s,1,c),v(e,"comments",d,r)}function _(e,t,n){return Object.assign(Object.assign({},e),{[t]:n?e.pending.originalValue:e[t],pending:void 0})}t.reducers={boltInfo:(e=t.DEFAULT_STATE.boltInfo,n)=>{if(n.type===c.Action.ListCommentsResult){const{payload:{arg:t,result:a}}=n,r=f(t.stream);if(r&&a)return{fileIdentifierToBoltMap:Object.assign(Object.assign({},e.fileIdentifierToBoltMap),{[r]:a.bolt_info}),boltUniqueIdToStream:Object.assign(Object.assign({},e.boltUniqueIdToStream),{[a.bolt_info.unique_id]:t.stream})}}return e},threads:(e=t.DEFAULT_STATE.threads,a)=>{const r=!!a.error;switch(a.type){case c.Action.AddComment:return h(e,a);case c.Action.AddCommentResult:return y(e,a,r);case c.Action.MarkThreadRead:case c.Action.MarkThreadUnread:return C(e,a);case c.Action.MarkThreadReadResult:case c.Action.MarkThreadUnreadResult:return O(e,a,r);case c.Action.ResolveThread:case c.Action.UnresolveThread:return T(e,a);case c.Action.ResolveThreadResult:case c.Action.UnresolveThreadResult:return M(e,a,r);case c.Action.EditComment:return I(e,a);case c.Action.EditCommentResult:return S(e,a,r);case c.Action.DeleteComment:return E(e,a);case c.Action.DeleteCommentResult:return j(e,a,r);case c.Action.ListCommentsResult:case c.Action.LoggedOutListCommentsResult:return w(e,a);case n.Action.AddAndCommitComment:return L(e,a);case n.Action.EditAndCommitComment:return U(e,a);case n.Action.DeleteAndCommitComment:return k(e,a);case n.Action.DeleteAndCommitThread:return F(e,a);default:return e}},supportedEnhancements:(e={},t)=>{var n;if(t.type===c.Action.ListCommentsResult){const{payload:{arg:a,result:r}}=t,o=f(a.stream);if(null!=o&&null!=r)return Object.assign(Object.assign({},e),{[o]:null!==(n=r.supported_enhancements)&&void 0!==n?n:{}})}return e},activeThreadID:(e=t.DEFAULT_STATE.activeThreadID,a)=>{switch(a.type){case n.Action.ActivateThread:case n.Action.ActivateInitialThread:return Object.assign(Object.assign({},e),{[a.payload.fileViewerId]:a.payload.threadId});case n.Action.DeactivateAllThreads:return Object.assign(Object.assign({},e),{[a.payload.fileViewerId]:""});case c.Action.AddComment:if(a.meta&&a.meta.tempThreadId)return Object.assign(Object.assign({},e),{[a.meta.fileViewerId]:a.meta.tempThreadId});break;case c.Action.AddCommentResult:const{meta:t,payload:{result:r}}=a;if(r&&t&&t.tempThreadId===e[t.fileViewerId])return Object.assign(Object.assign({},e),{[t.fileViewerId]:r.id})}return e},focusedThreadID:(e=t.DEFAULT_STATE.hoverThreadID,{type:a,payload:r})=>{if(a===n.Action.FocusThread){const t=Object.assign({},e);return null==r.threadId?delete t[r.fileViewerId]:t[r.fileViewerId]=r.threadId,t}return e},hoverThreadID:(e=t.DEFAULT_STATE.hoverThreadID,{type:a,payload:r})=>{if(a===n.Action.HoverThread){const t=Object.assign({},e);return null==r.threadId?delete t[r.fileViewerId]:t[r.fileViewerId]=r.threadId,t}return e},mentionsSearchResult:(e=t.DEFAULT_STATE.mentionsSearchResult,n)=>{switch(n.type){case a.MentionsAction.SearchContacts:return Object.assign(Object.assign({},e),{currentQuery:n.payload});case a.MentionsAction.SearchContactsResult:if(n.payload.query===e.currentQuery)return Object.assign(Object.assign({},e),{result:n.payload.result})}return e},permissions:(e=t.DEFAULT_STATE.permissions,n)=>{if(n.type!==c.Action.ListCommentsResult&&n.type!==c.Action.LoggedOutListCommentsResult)return e;const{payload:{arg:a,result:r}}=n,o=f(a.stream);if(!o||!r)return e;const s=r.permissions;return Object.assign(Object.assign({},e),{[o]:s})},draftAnnotation:(e=t.DEFAULT_STATE.draftAnnotation,a)=>{switch(a.type){case n.Action.UpdateDraftAnnotation:{const{fileViewerId:t,annotation:n}=a.payload;return n===e[t]?e:Object.assign(Object.assign({},e),{[t]:n})}case n.Action.CancelAnnotating:case n.Action.ClearDraftAnnotation:{const{fileViewerId:t}=a.payload;if(!(t in e))return e;const n=Object.assign({},e);return delete n[t],n}case c.Action.AddComment:if(null!=a.meta){const{fileViewerId:t}=a.meta;if(!(t in e))return e;const n=Object.assign({},e);return delete n[t],n}}return e},annotationState:(e=t.DEFAULT_STATE.annotationState,a)=>{switch(a.type){case n.Action.CancelAnnotating:case c.Action.AddComment:return null;case n.Action.ActivateThread:case n.Action.ActivateInitialThread:return null===e?"viewing":"viewing"!==e?null:e;case n.Action.DeactivateAllThreads:return"viewing"===e?null:e;case n.Action.StartAnnotating:return a.payload.accessible?"annotating-ax":"annotating";case n.Action.ConfirmDraftAnnotation:return"commenting"}return e},editorFocusRequest:(e=t.DEFAULT_STATE.editorFocusRequest,{type:a,payload:r})=>{if(a===n.Action.ConfirmDraftAnnotation&&!e[r.fileViewerId])return Object.assign(Object.assign({},e),{[r.fileViewerId]:!0});if(a===n.Action.FocusEditor&&!e[r.fileViewerId])return Object.assign(Object.assign({},e),{[r.fileViewerId]:!0});if(a===n.Action.EditorDidFocus&&e[r.fileViewerId]){const t=Object.assign({},e);return delete t[r.fileViewerId],t}return e},pendingNavigationToActiveThreadAnnotation:(e=t.DEFAULT_STATE.pendingNavigationToActiveThreadAnnotation,{type:a,payload:r})=>{if(a===n.Action.ActivateThread||a===n.Action.ActivateInitialThread)return Object.assign({[r.fileViewerId]:!0},e);if(a===n.Action.ResolveNavigationToActiveThreadAnnotation){const t=Object.assign({},e);return delete t[r.fileViewerId],t}return e},status:(e=t.DEFAULT_STATE.status,n)=>{if(n.type===c.Action.ListCommentsResult){const{payload:{arg:a,result:r}}=n,o=f(a.stream);if(o&&r)switch(r.status[".tag"]){case"disabled":return Object.assign(Object.assign({},e),{[o]:t.Status.Disabled});case"enabled":return Object.assign(Object.assign({},e),{[o]:t.Status.FullyEnabled});case"readonly":return Object.assign(Object.assign({},e),{[o]:t.Status.ReadOnly})}}if(n.type===c.Action.LoggedOutListCommentsResult){const{payload:{arg:a}}=n,r=f(a.stream);if(r)return Object.assign(Object.assign({},e),{[r]:t.Status.FullyEnabled})}return e},thirdPartySource:(e=t.DEFAULT_STATE.thirdPartySource,n)=>{if(n.type!==c.Action.ListCommentsResult)return e;const{payload:{arg:a,result:o}}=n,s=f(a.stream);if(!s||!o)return e;const i=o.supported_enhancements&&o.supported_enhancements.third_party_source;return Object.assign(Object.assign({},e),{[s]:i?r.thirdPartySourceToIThirdPartySource(i):void 0})},mediaAddonFeatures:(e=null,t)=>{var n;return t.type===d.Action.GetFeaturesResult?null!==(n=t.payload.result)&&void 0!==n?n:null:e},subscriptionStatus:(e=t.DEFAULT_STATE.subscriptionStatus,n)=>{if(n.type!==c.Action.SubscribeResult&&n.type!==c.Action.UnsubscribeResult)return e;const a=p(n);if(void 0===a)return e;switch(n.type){case c.Action.SubscribeResult:return Object.assign(Object.assign({},e),{[a]:{isSubscribed:!0,canSubscribe:!0}});case c.Action.UnsubscribeResult:return Object.assign(Object.assign({},e),{[a]:{isSubscribed:!1,canSubscribe:!0}});default:return e}},enableCommentStatus:(e=t.DEFAULT_STATE.enableCommentStatus,n)=>{var a;if(n.type!==c.Action.EnableCommentingResult&&n.type!==c.Action.DisableCommentingResult&&n.type!==c.Action.ListCommentsResult&&n.type!==c.Action.LoggedOutListCommentsResult)return e;const r=p(n);if(void 0===r)return e;switch(n.type){case c.Action.EnableCommentingResult:return Object.assign(Object.assign({},e),{[r]:{commentsEnabled:!0,canEnableCommenting:!0}});case c.Action.DisableCommentingResult:return Object.assign(Object.assign({},e),{[r]:{commentsEnabled:!1,canEnableCommenting:!0}});case c.Action.ListCommentsResult:case c.Action.LoggedOutListCommentsResult:const t=n.payload.result;return t?Object.assign(Object.assign({},e),{[r]:{commentsEnabled:!("disabled"===t.status[".tag"]),canEnableCommenting:!!(null===(a=t.permissions)||void 0===a?void 0:a.can_enable_commenting)}}):e;default:return e}},showResolvedComments:(e=t.DEFAULT_STATE.showResolvedComments,a)=>{switch(a.type){case n.Action.UpdateShowResolvedComments:return a.payload.showResolvedComments;default:return e}},approvalFormStatus:l.approvalReducer,annotationMode:(e=t.DEFAULT_STATE.annotationMode,a)=>{switch(a.type){case n.Action.UpdateAnnotationMode:return a.payload.updatedAnnotationMode;default:return e}}};const h=(e,t)=>{const{payload:{arg:{thread_id:n,stream:a}}}=t,r=f(a);if(!r||!t.meta)return e;const s=e[r],{content:i,author:c,annotation:d}=t.meta;if(n){const a=s[n],{comments:l}=a,m=Object.assign(Object.assign({},a),{comments:[...l,o.newCommentFromICommentContent({content:i,threadId:n,author:c})],annotation:d||a.annotation});return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},s),{[n]:Object.assign(Object.assign({},m),{pending:{action:t.type,originalValue:a,newValue:m}})})})}const{tempThreadId:l}=t.meta;if(l){const n=o.newCommentFromICommentContent({threadId:l,author:c,content:i}),a={id:l,timestamp:new Date,read:!0,readonly:!0,resolved:!1,comments:[n],annotation:d,isThirdParty:!1},m=Object.assign(Object.assign({},a),{pending:{action:t.type,originalValue:void 0,pendingValue:a}});return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},s),{[l]:m})})}return e},y=(e,t,n)=>{const{payload:{arg:{thread_id:a,stream:r}}}=t,o=f(r);if(!o||!t.meta)return e;const s=e[o];if(a){const t=Object.assign({},s[a]),{originalValue:r}=t.pending;return t.pending=void 0,Object.assign(Object.assign({},e),{[o]:Object.assign(Object.assign({},s),{[a]:n?r:t})})}const{tempThreadId:i}=t.meta;let c=s;if(!n&&i in s&&t.payload.result){c=Object.assign({},s),delete c[i];const e=s[i],{id:n}=t.payload.result;e.readonly=!1,e.id=n,c[n]=Object.assign(Object.assign({},e),{pending:void 0})}return Object.assign(Object.assign({},e),{[o]:c})},C=(e,t)=>{const{fileIdOrUrl:n,threadId:a}=b(t);if(!n||!a)return e;const r=e[n];return Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},r),{[a]:v(r[a],"read",t.type===c.Action.MarkThreadRead,t.type)})})},O=(e,t,n)=>{const{fileIdOrUrl:a,threadId:r}=b(t);if(!a||!r)return e;const o=e[a];return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},o),{[r]:_(o[r],"read",n)})})},T=(e,t)=>{const{fileIdOrUrl:n,threadId:a}=b(t);if(!n||!a)return e;const r=e[n];return Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},r),{[a]:v(r[a],"resolved",t.type===c.Action.ResolveThread,t.type)})})},M=(e,t,n)=>{const{fileIdOrUrl:a,threadId:r}=b(t);if(!a||!r)return e;const o=e[a];return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},o),{[r]:_(o[r],"resolved",n)})})},I=(e,t)=>{const{fileIdOrUrl:n,threadId:a,commentId:r}=g(t);if(!(n&&a&&r&&t.meta))return e;const o=e[n],{content:s}=t.meta;return Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},o),{[a]:A(o[a],r,"content",s,t.type)})})},S=(e,t,n)=>{const{fileIdOrUrl:a,threadId:r,commentId:o}=g(t);if(!a||!r||!o)return e;const s=e[a];return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},s),{[r]:_(s[r],"comments",n)})})},E=(e,t)=>{const{fileIdOrUrl:n,threadId:a,commentId:r}=g(t);if(!n||!a||!r)return e;const o=e[n];return Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},o),{[a]:A(o[a],r,"deleted",!0,t.type)})})},j=(e,t,n)=>{const{fileIdOrUrl:a,threadId:r,commentId:o}=g(t);if(!a||!r||!o)return e;const s=e[a];return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},s),{[r]:_(s[r],"comments",n)})})},w=(e,t)=>{const{payload:{arg:n,result:a}}=t,o=f(n.stream);return o&&a?Object.assign(Object.assign({},e),{[o]:r.threadsToIThreadMap(a.threads,r.usersToIUserMap(a.users))}):e};function R(e,t,n){return Object.assign(Object.assign({},e),{[t]:n})}function D(e,t,n,a){const{comments:r}=e,o=r.findIndex(e=>e.id===t),s=r[o];if(!s)return e;const i=Object.assign(Object.assign({},s),{[n]:a}),c=[...r];return c.splice(o,1,i),R(e,"comments",c)}t.reducer=s.combineReducers(t.reducers);const U=(e,t)=>{const{payload:{content:n,threadId:a,fileIdentifier:r,commentId:o}}=t,s=e[r],i=s[a];return i?Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},s),{[a]:D(i,o,"content",n)})}):e},L=(e,t)=>{const{payload:{author:n,content:a,threadId:r,fileIdentifier:s}}=t,i=e[s];if(r){const t=i[r];if(!t)return e;const{comments:c}=t,d=Object.assign(Object.assign({},t),{comments:[...c,o.newCommentFromICommentContent({content:a,threadId:r,author:n})]});return Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},i),{[r]:Object.assign({},d)})})}{const t=m.v4(),r=o.newCommentFromICommentContent({threadId:t,author:n,content:a}),c={id:t,timestamp:new Date,read:!0,readonly:!0,resolved:!1,comments:[r],isThirdParty:!1};return Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},i),{[t]:c})})}},k=(e,t)=>{const{payload:{threadId:n,fileIdentifier:a,commentId:r}}=t;if(!a||!n||!r)return e;const o=e[a],s=o[n];return s?Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},o),{[n]:D(s,r,"deleted",!0)})}):e},F=(e,t)=>{const{payload:{threadId:n,fileIdentifier:a}}=t;if(!a||!n)return e;const r=e[a],o=r[n];return o?Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[n]:R(o,"comments",o.comments.map(e=>Object.assign(Object.assign({},e),{deleted:!0})))})}):e}})),define("typescript/component_libraries/files_components/src/blades/comments/data/selectors",["require","exports","typescript/component_libraries/files_components/src/blades/comments/data/types"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSingularlyAnnotating=t.getUnreadThreadCount=t.getAnnotationType=t.isUserSubscribed=t.areCommentsEnabled=void 0;t.areCommentsEnabled=(e,t)=>{var n;const a=e.permissions[t],r=e.enableCommentStatus[t];return Boolean(null!==(n=null==r?void 0:r.commentsEnabled)&&void 0!==n?n:null==a?void 0:a.can_see_comment_editor)};t.isUserSubscribed=(e,t)=>{var n;const a=e.permissions[t],r=e.subscriptionStatus[t];return Boolean(null!==(n=null==r?void 0:r.isSubscribed)&&void 0!==n?n:null==a?void 0:a.is_subscribed)};t.getAnnotationType=(e,t)=>{var n;const a=e.threads[t],r=a?Object.values(a).find(e=>void 0!==e.annotation):void 0;return null===(n=null==r?void 0:r.annotation)||void 0===n?void 0:n.type};t.getUnreadThreadCount=(e,t)=>{const n=e.threads[t];return n?Object.values(n).filter(e=>!e.read&&e.comments.some(e=>!e.deleted)).length:0};t.isSingularlyAnnotating=e=>e.annotationMode===n.SectionAnnotationMode.single})),define("typescript/component_libraries/files_components/src/blades/comments/component/comments_blade",["require","exports","tslib","react","react-intl","dig-components/icons","dig-components/icons/src","dig-components/badges","typescript/component_libraries/files_components/src/right-rail/index","typescript/component_libraries/files_components/src/blades/comments/component/meatball_menu","react-redux","typescript/component_libraries/files_components/src/blades/comments/data/selectors","typescript/component_libraries/files_components/src/blades/comments/data/types","dig-components/typography"],(function(e,t,n,a,r,o,s,i,c,d,l,m,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollapsedCommentsBladeButton=t.CommentsBlade=void 0,a=n.__importStar(a);const f=r.defineMessage({id:"5PJLxb",defaultMessage:"{unreadCount} unread"}),b=r.defineMessage({id:"ZKwnCD",defaultMessage:"An error occurred."}),g=e=>l.useSelector(t=>e?m.getUnreadThreadCount(t,e):0);class v extends a.PureComponent{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}render(){const{intl:e}=this.props;return this.state.hasError?a.createElement(p.Text,null,e.formatMessage(b)):this.props.children}}v.displayName="CommentsBladeErrorBoundary";const A=({fileId:e,sharedLinkURL:t,showOverflowMenu:n,approvalVariant:o,approvalCopyVariant:s,approvalsLogger:c,dragSectionAnnotationEnabled:l})=>{const m=g(u.createCommentFileIdentifier(e,t)),p=r.useIntl();return a.createElement("div",{className:"comments-blade-header-accessory-wrapper"},m>0?a.createElement("div",{className:"comments-blade-header-badge"},a.createElement(i.NotificationBadge,{status:"attention"},p.formatMessage(f,{unreadCount:m}))):null,n&&a.createElement("div",{className:"comments-blade-header-menu"},a.createElement(d.CommentsMeatball,{fileId:e,sharedLinkURL:t,size:"small",approvalVariant:o,approvalCopyVariant:s,approvalsLogger:c,dragSectionAnnotationEnabled:l})))};A.displayName="CommentsBladeRightAccessory";t.CommentsBlade=({id:e,intl:t,children:n,fileId:i,sharedLinkURL:d,comments2UsabilityRevamp:l,approvalVariant:m,approvalCopyVariant:u,approvalsLogger:p,dragSectionAnnotationEnabled:f})=>{const b=c.useIsExpanded(e);return a.createElement(r.RawIntlProvider,{value:t},a.createElement(c.RightRail.Blade,{withTitle:t.formatMessage({id:"TxGYML",defaultMessage:"Comments"}),withIcon:a.createElement(o.UIIcon,{src:s.CommentLine}),id:e,withTitleRightAccessory:a.createElement(A,{fileId:i,sharedLinkURL:d,showOverflowMenu:b,comments2UsabilityRevamp:l,approvalVariant:m,approvalCopyVariant:u,approvalsLogger:p,dragSectionAnnotationEnabled:f})},a.createElement(v,{intl:t},n)))},t.CommentsBlade.displayName="CommentsBlade";t.CollapsedCommentsBladeButton=({id:e,intl:t,fileId:n,sharedLinkURL:r})=>{const i=g(n?u.createCommentFileIdentifier(n,r):void 0);return a.createElement(c.RightRail.CollapsedBladeIcon,{id:e,withIcon:a.createElement(o.UIIcon,{src:s.CommentLine,"aria-label":t.formatMessage({id:"JrjHYo",defaultMessage:"Open comments panel"})}),tooltip:t.formatMessage({id:"GSZlCi",defaultMessage:"Comments"}),withNotificationBadge:i})},t.CollapsedCommentsBladeButton.displayName="CollapsedCommentsBladeButton"})),define("typescript/libraries/comments2/src/components/utils/thread_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findCommentThread=void 0,t.findCommentThread=function(e,t){for(const n of e){const e=n.comments;for(const a of e)if(a.id===t)return{comment:a,thread:n}}return null}})),define("typescript/libraries/file-viewer/src/comments2/plugin/comment_markers",["require","exports","tslib","typescript/component_libraries/files_components/src/blades/comments/index","react","react-dom","react-redux","lodash","typescript/libraries/file-viewer/src/hooks/useStabilizedCallback","typescript/libraries/file-viewer/src/toolbar/audio_video_markers","typescript/libraries/file-viewer/src/core/logging/video","typescript/component_libraries/files_components/src/blades/comments/data/types"],(function(e,t,n,a,r,o,s,i,c,d,l,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommentMarkers=void 0,r=n.__importStar(r);const u=({file:e,duration:t,fileViewerId:n,audioVideoMetadata:o,logVideoAction:u})=>{const p=m.createCommentFileIdentifier(e.file_id,e.url),f=s.useDispatch(),b=s.useSelector(e=>e.threads[p]||{}),g=c.useStabilizedCallback(t=>{f(a.activateThread({fileId:e.file_id,fileViewerId:n,isThirdParty:t.isThirdParty,threadId:t.id}))}),v="video"===(null==o?void 0:o[".tag"])?null==o?void 0:o.thumb_scrubber_vtt_url:void 0,A=r.useCallback(i.once(e=>{u(e?l.VideoPreviewEvent.ScrubberThumbnailsLoaded:l.VideoPreviewEvent.ScrubberThumbnailsFailed)}),[u]);return r.default.createElement(d.AudioVideoMarkersComponent,{threads:b,vttUrl:v,onScrubberThumbnailsLoaded:A,duration:t,openThreadInRightRail:g})};u.displayName="CommentMarkersComponent";t.CommentMarkers=e=>{var{container:t}=e,a=n.__rest(e,["container"]);return o.createPortal(r.default.createElement(u,Object.assign({},a)),t)},t.CommentMarkers.displayName="CommentMarkers",t.CommentMarkers.displayName="CommentMarkers"})),define("typescript/component_libraries/files_components/src/blades/comments/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SectionAnnotationMode=t.createCommentFileIdentifier=void 0;var n;t.createCommentFileIdentifier=(e,t)=>t||e,(n=t.SectionAnnotationMode||(t.SectionAnnotationMode={})).continuous="continuous",n.single="single"})),define("typescript/libraries/file-viewer/src/comments2/plugin/navigation_middleware",["require","exports","typescript/libraries/file-viewer/src/plugins/types","typescript/component_libraries/files_components/src/blades/comments/data/actions","typescript/component_libraries/files_components/src/blades/comments/data/types","typescript/libraries/api_v2/redux/comments2"],(function(e,t,n,a,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMiddleware=void 0;t.createMiddleware=e=>({getState:t,dispatch:s})=>i=>c=>{var d;switch(i(c),c.type){case a.Action.ResolveNavigationToActiveThreadAnnotation:return;case a.Action.ActivateInitialThread:case a.Action.ActivateThread:case o.Action.ListCommentsResult:{const o=t();for(const t of Object.getOwnPropertyNames(o.pendingNavigationToActiveThreadAnnotation)){if(t===e.fileViewerId){const{file:i,navigation:c}=e.getPluginData();if(null!=i){const e=r.createCommentFileIdentifier(i.fileId,i.url),l=o.activeThreadID[t],m=null===(d=o.threads[e])||void 0===d?void 0:d[l];if(m&&m.annotation){const e=m.annotation;"document"===e.type&&"navigateToPage"in c&&c.navigateToPage((e.regions[0].page||1)-1,n.UserActionContext.RightRail),("audio"===e.type||"video"===e.type)&&"seek"in c&&c.seek(e.time),s(a.resolveNavigationToActiveThreadAnnotation(t))}}}return}}}}})),define("typescript/libraries/file-viewer/src/comments2/logging_middleware",["require","exports","typescript/libraries/api_v2/redux/comments2","typescript/component_libraries/files_components/src/blades/comments/data/actions","typescript/component_libraries/files_components/src/blades/comments/data/transform"],(function(e,t,n,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.middleware=void 0;function o({event:e,stream:t,thread_id:a,comment_id:r,is_third_party:o,error:s}){return n.logEventAction({arg:{event:s?{".tag":"comment_error"}:e,stream:t,thread_id:a,comment_id:r,is_third_party:o,oref:"dfv",product_surface:{".tag":"file_preview"},product_surface_context:{".tag":"file_preview"},error_message:s?s.message:void 0}})}t.middleware=({dispatch:e})=>t=>s=>{const i=t(s);if(s.type===n.Action.AddCommentResult)e(o({event:s.payload.arg.thread_id?{".tag":"reply_to_comment"}:{".tag":"new_comment"},stream:s.payload.arg.stream,thread_id:s.payload.arg.thread_id,error:s.error}));else if(s.type===n.Action.MarkThreadReadResult)e(o({event:{".tag":"mark_thread_as_read"},stream:s.payload.arg.stream,thread_id:s.payload.arg.id,error:s.error}));else if(s.type===n.Action.MarkThreadUnreadResult)e(o({event:{".tag":"mark_thread_as_unread"},stream:s.payload.arg.stream,thread_id:s.payload.arg.id,error:s.error}));else if(s.type===n.Action.ResolveThreadResult)e(o({event:{".tag":"resolve_thread"},stream:s.payload.arg.stream,thread_id:s.payload.arg.id,error:s.error}));else if(s.type===n.Action.UnresolveThreadResult)e(o({event:{".tag":"unresolve_thread"},stream:s.payload.arg.stream,thread_id:s.payload.arg.id,error:s.error}));else if(s.type===n.Action.DeleteCommentResult)e(o({event:{".tag":"delete_comment"},stream:s.payload.arg.stream,thread_id:s.meta?s.meta.threadId:void 0,comment_id:s.payload.arg.id,error:s.error}));else if(s.type===n.Action.EditCommentResult)e(o({event:{".tag":"edit_comment"},stream:s.payload.arg.stream,thread_id:s.meta?s.meta.threadId:void 0,comment_id:s.payload.arg.id,error:s.error}));else if(s.type===a.Action.ActivateThread){const{fileId:t,isThirdParty:n,threadId:a}=s.payload,i=r.createStreamFromFileId(t);e(o({event:{".tag":"activate_thread"},stream:i,thread_id:a,is_third_party:n}))}return i}})),define("typescript/component_libraries/files_components/src/blades/comments/data/store",["require","exports","typescript/libraries/api_v2/redux/comments2","typescript/libraries/api_v2/redux/files","typescript/libraries/api_v2/redux/media_addon","typescript/component_libraries/files_components/src/blades/comments/data/bolt_middleware","typescript/libraries/comments2/src/mentions/index","redux","typescript/component_libraries/files_components/src/blades/comments/data/reducer","typescript/component_libraries/files_components/src/blades/comments/data/read_thread_middleware","typescript/component_libraries/files_components/src/blades/comments/data/logging_middleware"],(function(e,t,n,a,r,o,s,i,c,d,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeStore=void 0,t.makeStore=function({apiv2ClientBase:e,boltIOClient:t,mentionsIOClient:m,logger:u},p){const f=[a.middleware(e.ns("files")),n.middleware(e.ns("comments2")),r.middleware(e.ns("media_addon")),o.middleware(t),d.createMiddleware()];m&&f.push(s.middleware(m)),u&&f.push(l.createCommentsBladeLoggingMiddleware(u)),p&&f.push(...p);const b=i.applyMiddleware(...f),g=window.__REDUX_DEVTOOLS_EXTENSION__,v=null==g?b:i.compose(b,g({name:"FVSDK Comments2 Plugin"}));return i.createStore(c.reducer,v)}})),define("typescript/libraries/comments2/src/mentions/index",["require","exports","typescript/libraries/comments2/src/mentions/actions","typescript/libraries/comments2/src/mentions/middleware"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MentionsIOClient=t.middleware=t.SearchContactsResultAction=t.SearchContactsAction=t.searchContactsResult=t.searchContacts=t.MentionsAction=void 0,Object.defineProperty(t,"MentionsAction",{enumerable:!0,get:function(){return n.MentionsAction}}),Object.defineProperty(t,"searchContacts",{enumerable:!0,get:function(){return n.searchContacts}}),Object.defineProperty(t,"searchContactsResult",{enumerable:!0,get:function(){return n.searchContactsResult}}),Object.defineProperty(t,"SearchContactsAction",{enumerable:!0,get:function(){return n.SearchContactsAction}}),Object.defineProperty(t,"SearchContactsResultAction",{enumerable:!0,get:function(){return n.SearchContactsResultAction}}),Object.defineProperty(t,"middleware",{enumerable:!0,get:function(){return a.middleware}}),Object.defineProperty(t,"MentionsIOClient",{enumerable:!0,get:function(){return a.MentionsIOClient}})})),define("typescript/libraries/file-viewer/src/comments2/plugin/snackbar",["require","exports","tslib","react","react-redux","react-intl","dig-components/banner","typescript/component_libraries/files_components/src/blades/comments/data/actions","dig-components/buttons","typescript/libraries/file-viewer/src/css/header.module.css","typescript/libraries/file-viewer/src/core/data/models"],(function(e,t,n,a,r,o,s,i,c,d,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationSnackbar=void 0,a=n.__importStar(a);const m=o.defineMessage({id:"IKrBL8",defaultMessage:"Highlight a section to comment on"}),u=o.defineMessage({id:"+qSSeW",defaultMessage:"Highlight an area to comment on\n"}),p=o.defineMessage({id:"VYvI4T",defaultMessage:"Using the arrow keys, select an area to comment on, then hit enter."}),f=o.defineMessage({id:"pCmwyu",defaultMessage:"Now, add your comment in the comments pane"}),b=o.defineMessage({id:"8UKHBA",defaultMessage:"Using the arrow keys, select a timestamp to comment on, then hit enter"}),g=o.defineMessage({id:"DeTJfa",defaultMessage:"Add your comment in the comments pane"}),v=o.defineMessage({id:"55kTfU",defaultMessage:"Cancel"});t.AnnotationSnackbar=a.memo(({fileViewerId:e,previewType:t})=>{const n=r.useSelector(e=>e.annotationState),A=r.useDispatch(),_=o.useIntl();if(null==n||"viewing"==n)return null;let h;if(t===l.PreviewType.Audio||t===l.PreviewType.Video)if("commenting"===n)h=_.formatMessage(g);else{if("annotating-ax"!==n)return null;h=_.formatMessage(b)}else if("annotating"===n)h=t===l.PreviewType.Image?_.formatMessage(u):_.formatMessage(m);else if("annotating-ax"===n)h=_.formatMessage(p);else{if("commenting"!==n)return null;h=_.formatMessage(f)}return a.createElement("div",{className:d.floatingHeader},a.createElement(s.Banner,{type:"attention",withLeftIcon:!1},a.createElement(s.Banner.Message,null,h),a.createElement(s.Banner.Actions,null,a.createElement(c.Button,{variant:"transparent",onClick:()=>{A(i.cancelAnnotating(e))}},_.formatMessage(v)))))}),t.AnnotationSnackbar.displayName="AnnotationSnackbar",t.AnnotationSnackbar.displayName="AnnotationSnackbar"})),define("typescript/component_libraries/files_components/src/blades/comments/index",["require","exports","tslib","typescript/component_libraries/files_components/src/blades/comments/component/comments_blade","typescript/component_libraries/files_components/src/blades/comments/data/selectors","typescript/component_libraries/files_components/src/blades/comments/data/reducer","typescript/component_libraries/files_components/src/blades/comments/data/read_thread_middleware","typescript/component_libraries/files_components/src/blades/comments/data/store","typescript/component_libraries/files_components/src/blades/comments/data/actions"],(function(e,t,n,a,r,o,s,i,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(a,t),n.__exportStar(r,t),n.__exportStar(o,t),n.__exportStar(s,t),n.__exportStar(i,t),n.__exportStar(c,t)})),define("typescript/libraries/file-viewer/src/comments2/plugin/loader/eager",["require","exports","tslib","typescript/libraries/file-viewer/src/comments2/plugin/types","typescript/libraries/file-viewer/src/comments2/plugin/comment_plugin"],(function(e,t,n,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeLoader=void 0,t.makeLoader=function(e,t={}){return{pluginId:a.COMMENTS_PLUGIN_ID,load:(a,o)=>n.__awaiter(this,void 0,void 0,(function*(){return new r.Comments2Plugin(a,o,t,e)}))}}})),define("typescript/libraries/comments2/src/components/utils/approval_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getApprovers=t.canRespondToApproval=t.findActionableApprovalCommentId=t.getApprovalRequestsSubtext=t.getApprovalRequestCounts=t.isApprovalRequester=t.isApprovalThread=t.getApprovalMetadata=void 0;t.getApprovalMetadata=e=>{for(const t of e)if("approval"===t.type)return t};t.isApprovalThread=e=>!!t.getApprovalMetadata(e.comments[e.comments.length-1].content.metadata);t.isApprovalRequester=e=>{const n=t.getApprovalMetadata(e.comments[e.comments.length-1].content.metadata);return"requester"===(null==n?void 0:n.actor)};const n=e=>{const n=t.getApprovalMetadata(e.comments[e.comments.length-1].content.metadata),a=null==n?void 0:n.approvers,r=null==n?void 0:n.requires_all;let o=0;if(!a)return 0;for(const e of a)if("approved"!==e.overall_status)o++;else if(!r)return 0;return r?o:1};t.getApprovalRequestCounts=e=>{let a=0,r=0;for(const o of e){const e=n(o);0!==e&&(a+=e),t.isApprovalThread(o)&&r++}return[a,r]};t.getApprovalRequestsSubtext=(e,t)=>t.formatMessage({id:"sj45d1",defaultMessage:"{openRequestsCount} {openRequestsCount, plural, one {approval request} other {approval requests}} open"},{openRequestsCount:e});t.findActionableApprovalCommentId=e=>{const n=e.comments.filter(e=>!e.deleted),a=t.getApprovalMetadata(n[0].content.metadata),r=null==a?void 0:a.actor;if("requester"===r){const e=n[n.length-1],a=t.getApprovalMetadata(e.content.metadata);if("request"===(null==a?void 0:a.approval_type))return e.id;for(let e=n.length-1;e>=0;e--){const a=n[e],r=t.getApprovalMetadata(a.content.metadata);if("request"===(null==r?void 0:r.approval_type))return;if("response"===(null==r?void 0:r.approval_type)&&"rejected"===(null==r?void 0:r.status))return a.id}}if("approver"===r)for(let e=n.length-1;e>=0;e--){const a=n[e],r=t.getApprovalMetadata(a.content.metadata),o=n[e].userPermissions.canEdit;if("request"===(null==r?void 0:r.approval_type))return a.id;if("response"===(null==r?void 0:r.approval_type)&&o)return a.id}};t.canRespondToApproval=e=>{const n=t.getApprovalMetadata(e.content.metadata);return"request"===(null==n?void 0:n.approval_type)&&"approver"===(null==n?void 0:n.actor)&&!e.userPermissions.canEdit&&!e.userPermissions.canDelete};t.getApprovers=e=>{const n=t.getApprovalMetadata(e.comments[e.comments.length-1].content.metadata);return null==n?void 0:n.approvers}}));
//# sourceMappingURL=pkg-comments.min.js-vflfgCgBC.map