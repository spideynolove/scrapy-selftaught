define(["require","exports","tslib","react","typescript/libraries/file-viewer/src/preview_error/preview_error","typescript/libraries/file-viewer/src/renderer","typescript/libraries/file-viewer/src/core/data/preview_key","typescript/libraries/file-viewer/src/core/logging/constants","typescript/libraries/file-viewer/src/core/data/selectors","typescript/libraries/file-viewer/src/core/data/actions","lodash","typescript/libraries/file-viewer/src/toolbar/toolbar","typescript/libraries/file-viewer/src/core/utils/support","typescript/libraries/file-viewer/src/core/data/utils","typescript/libraries/file-viewer/src/core/logging/actions","typescript/libraries/file-viewer/src/core/utils/paths","typescript/libraries/file-viewer/src/plugins/types","typescript/libraries/file-viewer/src/core/extension_constants"],(function(e,i,r,l,t,n,s,a,o,c,v,p,w,f,u,d,_,y){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.FileEntryView=void 0,l=r.__importStar(l);i.FileEntryView=e=>{var i,r,g,P,S,F,b,E,m,I,h,T;const{intl:D,rootArchiveFileInformation:A,isArchiveFilePasswordProtected:V,rootFileId:R,entry:x,archiveFiles:C,fullFilePreviewUi:N,fullRivieraData:j,dispatch:M,fileViewerId:U,currentPath:z,config:O,loggingSession:k,rivieraData:K,fileViewerUiData:q,fileMetadata:B,filePreviewUiData:G,toolbarPlugins:H,snackbarManagerPluginInstance:J}=e,L=s.getPreviewKeyForNestedArchiveFile(R,s.getSubpath(z)),Q=o.getArchiveFilesPreviewMetadata(C,L),W=w.resolvePreviewType(Q),X=l.useRef(null),Y=l.useRef(null),Z=l.useRef(null),$=l.useRef(null),ee=l.useRef(null),ie=l.useRef(null),re=l.useRef(null),le=l.useRef(null);if(X.current!==x&&(X.current=x,M(c.initializeFilePreviewSession({fileViewerId:k.file_viewer_session_id,fileId:k.file_id,sjId:k.sj_id,nsId:k.ns_id,deviceType:k.device_type,fileExtension:d.getFileExtension(x.name),sourceSession:{source_action:a.SourceAction.Click,source_context:a.SourceContext.ArchiveFile,page_start_ts:Date.now(),preview_type:W,was_flipped:!1}})),Z.current=v.once(e=>M(u.logSessionEvent({event:a.SessionEventType.FilePreviewAttemptStarted,fileViewerId:U,previewSessionId:e}))),$.current=v.once(e=>M(u.logSessionEvent({event:a.SessionEventType.FilePreviewSupportConfirmed,fileViewerId:U,previewSessionId:e}))),ee.current=v.once(e=>M(u.logSessionEvent({event:a.SessionEventType.FilePreviewSupportDenied,fileViewerId:U,previewSessionId:e}))),ie.current=v.once(e=>M(u.logSessionEvent({event:a.SessionEventType.FilePreviewDownloadAttempted,fileViewerId:U,previewSessionId:e}))),re.current=v.once(e=>M(u.logSessionEvent({event:a.SessionEventType.FilePreviewDownloadSucceeded,fileViewerId:U,previewSessionId:e}))),le.current=v.once(e=>M(u.logSessionEvent({event:a.SessionEventType.FilePreviewDownloadFailed,fileViewerId:U,previewSessionId:e}))),Y.current=k.file_preview_session_id),null!==Y.current&&Y.current===k.file_preview_session_id)return null;if(Y.current=null,null===(i=Z.current)||void 0===i||i.call(Z,k.file_preview_session_id),V)return null===(r=ee.current)||void 0===r||r.call(ee,k.file_preview_session_id),l.createElement(t.ArchiveFilePasswordProtected,{intl:D,fileName:A.fileName});switch(W){case _.PreviewType.Audio:case _.PreviewType.Video:case _.PreviewType.Archive:case _.PreviewType.Error:null===(g=ee.current)||void 0===g||g.call(ee,k.file_preview_session_id);let e,i=W;if(W==_.PreviewType.Error){const e=d.getFileExtension(x.name);e&&(i=y.resolvePreviewTypeFromExtension(e))}switch(i){case _.PreviewType.Audio:case _.PreviewType.Video:case _.PreviewType.Archive:e=l.createElement(t.ArchiveNestedFiletypeNotSupported,{fileName:x.name,fileSize:null!==(P=x.size)&&void 0!==P?P:0,intl:D});break;default:e=l.createElement(t.ArchiveFileUnavailable,{fileName:x.name,fileSize:null!==(S=x.size)&&void 0!==S?S:0,intl:D})}return l.createElement(l.Fragment,null,e,l.createElement(p.ConfigurableToolbar,{rootArchiveFileInformation:A,fileRivieraData:K,fileViewerUi:q,filePreviewUi:G,previewType:_.PreviewType.Archive,plugins:H,snackbarManagerPluginInstance:J}))}const te=o.getFilePreviewUiData(N,L);if(!te)return M(c.initializeNestedArchiveFilePreview({fileViewerId:U,currentPath:z,previewKey:L,previewType:w.resolvePreviewType(o.getArchiveFilesPreviewMetadata(C,L))})),null===(F=$.current)||void 0===F||F.call($,k.file_preview_session_id),null===(b=ie.current)||void 0===b||b.call(ie,k.file_preview_session_id),M(c.fetchRivieraData({fileViewerId:U,previewKey:L,config:O})),null;null===(E=$.current)||void 0===E||E.call($,k.file_preview_session_id),null===(m=ie.current)||void 0===m||m.call(ie,k.file_preview_session_id);const ne=Object.assign(Object.assign({},e),{extractConfig:{canExtract:!1},fileConfig:e.fileConfig?Object.assign(Object.assign({},e.fileConfig),{enable_print:!1}):e.fileConfig,fileInfo:void 0,previewKey:L,fileMetadata:{file_name:x.name,file_collection_context:null==B?void 0:B.file_collection_context},previewMetadata:Q,filePreviewUiData:te,rivieraData:o.getRivieraDataFromSlice(j,L)});if(W===_.PreviewType.SsrDoc){if(!ne.rivieraData)return null;f.isDocPreviewRivieraData(ne.rivieraData)&&ne.rivieraData.error?null===(I=le.current)||void 0===I||I.call(le,k.file_preview_session_id):null===(h=re.current)||void 0===h||h.call(re,k.file_preview_session_id)}else null===(T=re.current)||void 0===T||T.call(re,k.file_preview_session_id);return l.createElement(n.PreviewRenderer,Object.assign({},ne))},i.FileEntryView.displayName="FileEntryView"}));
//# sourceMappingURL=file_entry_view.amd.min.js-vflDgfo32.map